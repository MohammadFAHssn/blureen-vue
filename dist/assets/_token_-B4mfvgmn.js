import{r as ce}from"./validators-9V7Nl4tn.js";import{an as he,a2 as Se,aw as Pe,Y as F,r as f,a3 as ke,aV as Ie,G as Ce,w as z,aS as Re,a7 as Te,b6 as Fe,b as t,q as ee,b2 as te,a5 as Ae,a4 as Ue,F as D,J as fe,as as $e,c2 as Me,c3 as De,bK as me,bL as Ee,c as G,o as x,f as M,l as oe,m as s,bM as Ne,h as ne,e as o,z as ze,bN as ve,bO as pe,x as He,i as Oe,j as qe,bY as Ge,ax as Le,t as p,v as y,bk as H,d as O,c4 as Qe,bp as je,ah as Ye,$ as Je}from"./index-DHvfk8Qw.js";import{u as Ke,V as re}from"./form-CCbqdeLV.js";import{a as We}from"./VTextField-BLntkCtX.js";import{f as Xe,m as Ze,V as Be}from"./VField-Gm6U6sEP.js";import{V as Ve,m as et}from"./VInput-2_T2CZRA.js";import{f as tt}from"./VOverlay-qeJmpfp7.js";import{I as at}from"./VImg-v_sfFR3-.js";import{_ as lt}from"./AppTextField-A1J8N2YK.js";import{$ as ot}from"./api-BKPcjbrb.js";import{u as nt}from"./useApi-D8yfLzv_.js";import{c as rt}from"./createUrl-Blwz7bf-.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as xe}from"./VSnackbar-DPTFz17t.js";import{V as R}from"./VCol-CbWXyGCU.js";import{V as q}from"./VRow-BZjOIFGb.js";import{V as ut,a as it,b as dt,d as ct}from"./VList-BtpBJDfh.js";import{V as ae}from"./VChip-kRLZpqYA.js";import{V as ft}from"./VAvatar-C05Dpb7g.js";import{V as le,a as mt,b as vt}from"./VCard-BwN0U5Pn.js";import{V as T}from"./VCardText-DEhGWxj1.js";import{a as be,V as J}from"./VRadioGroup-B7lMefM7.js";import{V as pt}from"./VDivider-VsEDe1YQ.js";import{V as Vt}from"./VForm-C5lIXsLO.js";import"./transition-B7ZuqBcj.js";import"./index-9rIf2CJL.js";/* empty css              */import"./createSimpleFunctional-B_VJZ68H.js";import"./VSelectionControl-Cv1dmLoC.js";const xt=Se({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...et(),...Ze()},"VTextarea"),bt=he()({name:"VTextarea",directives:{Intersect:at},inheritAttrs:!1,props:xt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,_){let{attrs:w,emit:b,slots:c}=_;const d=Pe(e,"modelValue"),{isFocused:m,focus:P,blur:A}=Ke(e),U=F(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value||"").toString().length),L=F(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function E(n,i){var a,u;!e.autofocus||!n||(u=(a=i[0].target)==null?void 0:a.focus)==null||u.call(a)}const N=f(),V=f(),k=ke(""),h=f(),Q=F(()=>e.persistentPlaceholder||m.value||e.active);function I(){var n;h.value!==document.activeElement&&((n=h.value)==null||n.focus()),m.value||P()}function j(n){I(),b("click:control",n)}function K(n){b("mousedown:control",n)}function W(n){n.stopPropagation(),I(),te(()=>{d.value="",De(e["onClick:clear"],n)})}function X(n){var a;const i=n.target;if(d.value=i.value,(a=e.modelModifiers)!=null&&a.trim){const u=[i.selectionStart,i.selectionEnd];te(()=>{i.selectionStart=u[0],i.selectionEnd=u[1]})}}const v=f(),C=f(+e.rows),g=F(()=>["plain","underlined"].includes(e.variant));Ie(()=>{e.autoGrow||(C.value=+e.rows)});function r(){e.autoGrow&&te(()=>{if(!v.value||!V.value)return;const n=getComputedStyle(v.value),i=getComputedStyle(V.value.$el),a=parseFloat(n.getPropertyValue("--v-field-padding-top"))+parseFloat(n.getPropertyValue("--v-input-padding-top"))+parseFloat(n.getPropertyValue("--v-field-padding-bottom")),u=v.value.scrollHeight,$=parseFloat(n.lineHeight),Z=Math.max(parseFloat(e.rows)*$+a,parseFloat(i.getPropertyValue("--v-input-control-height"))),B=parseFloat(e.maxRows)*$+a||1/0,S=Ue(u??0,Z,B);C.value=Math.floor((S-a)/$),k.value=Ae(S)})}Ce(r),z(d,r),z(()=>e.rows,r),z(()=>e.maxRows,r),z(()=>e.density,r);let l;return z(v,n=>{n?(l=new ResizeObserver(r),l.observe(v.value)):l==null||l.disconnect()}),Re(()=>{l==null||l.disconnect()}),Te(()=>{const n=!!(c.counter||e.counter||e.counterValue),i=!!(n||c.details),[a,u]=Fe(w),{modelValue:$,...Z}=Ve.filterProps(e),B=Xe(e);return t(Ve,ee({ref:N,modelValue:d.value,"onUpdate:modelValue":S=>d.value=S,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":g.value},e.class],style:e.style},a,Z,{centerAffix:C.value===1&&!g.value,focused:m.value}),{...c,default:S=>{let{id:Y,isDisabled:se,isDirty:ue,isReadonly:ge,isValid:ye}=S;return t(Be,ee({ref:V,style:{"--v-textarea-control-height":k.value},onClick:j,onMousedown:K,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},B,{id:Y.value,active:Q.value||ue.value,centerAffix:C.value===1&&!g.value,dirty:ue.value||e.dirty,disabled:se.value,focused:m.value,error:ye.value===!1}),{...c,default:_e=>{let{props:{class:ie,...de}}=_e;return t(D,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),fe(t("textarea",ee({ref:h,class:ie,value:d.value,onInput:X,autofocus:e.autofocus,readonly:ge.value,disabled:se.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:I,onBlur:A},de,u),null),[[$e("intersect"),{handler:E},null,{once:!0}]]),e.autoGrow&&fe(t("textarea",{class:[ie,"v-textarea__sizer"],id:`${de.id}-sizer`,"onUpdate:modelValue":we=>d.value=we,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Me,d.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:i?S=>{var Y;return t(D,null,[(Y=c.details)==null?void 0:Y.call(c,S),n&&t(D,null,[t("span",null,null),t(We,{active:e.persistentCounter||m.value,value:U.value,max:L.value,disabled:e.disabled},c.counter)])])}:void 0})}),tt({},N,V,h)}}),gt=Object.assign({name:"AppTextarea",inheritAttrs:!1},{__name:"AppTextarea",setup(e){const _=F(()=>{const c=me().id,d=Ee();return c?`app-textarea-${c}`:d}),w=F(()=>me().label);return(b,c)=>(x(),G("div",{class:He(["app-textarea flex-grow-1",b.$attrs.class])},[s(w)?(x(),M(re,{key:0,for:s(_),class:"mb-1 text-body-2",text:s(w)},null,8,["for","text"])):oe("",!0),t(bt,ve(pe({...b.$attrs,class:null,label:void 0,variant:"outlined",id:s(_)})),Ne({_:2},[ne(b.$slots,(d,m)=>({name:m,fn:o(P=>[ze(b.$slots,m,ve(pe(P||{})))])}))]),1040)],2))}}),yt={key:0,class:"layout-page-content"},_t={class:"text-wrap mb-2"},wt={class:"text-h6"},ht={__name:"[token]",async setup(e){let _,w;const b=Oe(),c=qe(),d="/proxy",m=f(!1),P=f(""),A=f(!1),U=f(0);let L,E;const N=f([]),V=f("cash"),k=f(""),h=f("taxInvoice"),Q=f([]),I=f([]);let j=null;const K=()=>{U.value=Math.max(0,L.tenderExpiresAt-Math.floor(Date.now()/1e3)),j=setInterval(()=>{U.value-=1,U.value===0&&c.replace({name:"login-supplier"})},1e3)},W=(r,l)=>{if(l<=1)return"success";const n=r/(l-1),i=Math.round(255*n),a=Math.round(255*(1-n));return`#${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}00`},X=async r=>{if(!(!r.bidPrice&&!r.bidQuantity)){I.value[r.id]=!0;try{await ot(`${d}/tenderDetail/store-supplier-bids`,{baseURL:"",method:"POST",body:{id:r.id,bid_price:r.bidPrice,bid_quantity:r.bidQuantity,bid_description:r.bidDescription||"",payment_terms:V.value,payment_terms_description:V.value==="credit"?k.value:"",invoice_type:h.value},onResponseError({response:l}){m.value=!0,P.value=l._data.message||"خطا در ارسال پیشنهاد."}}),Q.value[r.id]=!0,A.value=!0}catch(l){console.error(l)}finally{I.value[r.id]=!1}}},{data:v,error:C}=([_,w]=Ge(()=>nt(rt(`${d}/tenderDetail/get-by-token?token=${b.params.token}`))),_=await _,w(),_);C.value&&(m.value=!0,P.value=C.value.message||"خطا در دریافت اطلاعات مناقصه.",setTimeout(()=>{c.replace({name:"login-supplier"})},2e3)),v.value&&(L=v.value.data,E={id:v.value.data.supplier.id,name:v.value.data.supplier.name},N.value=v.value.data.tenderBids||[],K());const g=F(()=>{const r=U.value,l=Math.floor(r/86400),n=Math.floor(r%86400/3600),i=Math.floor(r%3600/60),a=r%60;return{days:l,hours:n.toString().padStart(2,"0"),minutes:i.toString().padStart(2,"0"),seconds:a.toString().padStart(2,"0")}});return Le(()=>{clearInterval(j)}),(r,l)=>{const n=lt,i=gt;return x(),G(D,null,[t(xe,{modelValue:s(m),"onUpdate:modelValue":l[0]||(l[0]=a=>H(m)?m.value=a:null),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:o(()=>[p(y(s(P))+" ، در حال انتقال به پنل تأمین‌کننده ... ",1)]),_:1},8,["modelValue"]),t(xe,{modelValue:s(A),"onUpdate:modelValue":l[1]||(l[1]=a=>H(A)?A.value=a:null),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:o(()=>l[5]||(l[5]=[p(" ارسال شد ")])),_:1},8,["modelValue"]),s(v)?(x(),G("main",yt,[O("div",null,[t(q,null,{default:o(()=>[t(R,null,{default:o(()=>[O("div",_t,[l[6]||(l[6]=p(" مدیریت محترم شرکت/فروشگاه ")),O("span",wt,y(s(E).name),1)]),l[7]||(l[7]=O("div",{class:"text-wrap text-body-1"}," لیست کالاهای مورد نیاز مجموعه کارخانجات شیشه اردکان به شرح زیر می‌باشد. ",-1)),l[8]||(l[8]=O("div",{class:"text-wrap text-body-1"}," لطفاً قیمت‌های پیشنهادی خود را ارائه دهید. ",-1))]),_:1})]),_:1}),t(q,null,{default:o(()=>[t(ut,{style:{"background-color":"rgb(var(--v-theme-background))"}},{default:o(()=>[t(it,null,{prepend:o(()=>[t(ft,{color:"warning",variant:"tonal",rounded:"",icon:"tabler-stopwatch"})]),default:o(()=>[t(dt,{class:"font-weight-medium"},{default:o(()=>l[9]||(l[9]=[p(" مدت زمان باقی‌مانده تا پایان مناقصه: ")])),_:1}),t(ct,{class:"text-wrap text-body-1"},{default:o(()=>[s(g).days>0?(x(),M(ae,{key:0},{default:o(()=>[p(y(s(g).days)+" روز و "+y(s(g).hours)+" ساعت ",1)]),_:1})):(x(),M(ae,{key:1},{default:o(()=>[p(y(s(g).hours)+":"+y(s(g).minutes)+":"+y(s(g).seconds),1)]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(q,null,{default:o(()=>[t(R,{cols:"12",md:"6",lg:"4"},{default:o(()=>[t(le,null,{default:o(()=>[t(T,{class:"custom-v-card-text"},{default:o(()=>[t(re,{class:"mb-2"},{default:o(()=>l[10]||(l[10]=[p(" شرایط پرداخت ")])),_:1}),t(be,{modelValue:s(V),"onUpdate:modelValue":l[2]||(l[2]=a=>H(V)?V.value=a:null),inline:""},{default:o(()=>[t(J,{label:"نقدی",value:"cash"}),t(J,{label:"شرایطی",value:"credit"})]),_:1},8,["modelValue"]),s(V)==="credit"?(x(),M(n,{key:0,modelValue:s(k),"onUpdate:modelValue":l[3]||(l[3]=a=>H(k)?k.value=a:null),type:"text",placeholder:"توضیحات"},null,8,["modelValue"])):oe("",!0)]),_:1}),t(pt),t(T,{class:"custom-v-card-text"},{default:o(()=>[t(re,{class:"mb-2"},{default:o(()=>l[11]||(l[11]=[p(" نوع فاکتور ")])),_:1}),t(be,{modelValue:s(h),"onUpdate:modelValue":l[4]||(l[4]=a=>H(h)?h.value=a:null),inline:""},{default:o(()=>[t(J,{label:"فاکتور رسمی",value:"taxInvoice"}),t(J,{label:"فاکتور فروشگاهی",value:"commercialInvoice"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(q,null,{default:o(()=>[t(Qe,{group:""},{default:o(()=>[(x(!0),G(D,null,ne(s(N).filter(a=>!s(Q)[a.id]),a=>(x(),M(R,{key:a.id,cols:"12",md:"6",lg:"4"},{default:o(()=>[t(le,null,{default:o(()=>[t(mt,null,{default:o(()=>[t(vt,{class:"custom-v-card-title"},{default:o(()=>[p(y(a.tenderProduct.product.name+(a.tenderProduct.brand?` (${a.tenderProduct.brand.name})`:"")),1)]),_:2},1024)]),_:2},1024),t(T,null,{default:o(()=>[p(y(a.tenderProduct.purchaseExpertDescription),1)]),_:2},1024),t(T,null,{default:o(()=>[t(le,{variant:"outlined"},{default:o(()=>[t(T,null,{default:o(()=>l[12]||(l[12]=[p(" قیمت‌های پیشنهادی از سایر تأمین‌کنندگان (تومان): ")])),_:1}),t(T,{class:"d-flex flex-wrap gap-x-4 gap-y-2"},{default:o(()=>[(x(!0),G(D,null,ne(a.bidOfOtherSuppliers,(u,$)=>(x(),M(ae,{key:u.supplierId,variant:u.supplierId===s(E).id?"flat":"outlined",color:W($,a.bidOfOtherSuppliers.length)},{default:o(()=>[p(y(u.bidPrice),1)]),_:2},1032,["variant","color"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(T,null,{default:o(()=>[t(Vt,{"validate-on":"submit lazy",onSubmit:je(u=>X(a),["prevent"])},{default:o(()=>[t(q,null,{default:o(()=>[t(R,{cols:"12"},{default:o(()=>[t(n,{modelValue:a.bidPrice,"onUpdate:modelValue":u=>a.bidPrice=u,label:"قیمت",type:"number","prepend-inner-icon":"tabler-coin",suffix:"تومان",rules:["requiredValidator"in r?r.requiredValidator:s(ce)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),t(R,{cols:"12"},{default:o(()=>[t(n,{modelValue:a.bidQuantity,"onUpdate:modelValue":u=>a.bidQuantity=u,label:"تعداد",type:"number","prepend-inner-icon":"tabler-scale",suffix:a.tenderProduct.product.counting_unit.UntName,placeholder:`مقدار مورد نیاز: ${a.tenderProduct.quantityRequired}`,rules:["requiredValidator"in r?r.requiredValidator:s(ce)]},null,8,["modelValue","onUpdate:modelValue","suffix","placeholder","rules"])]),_:2},1024),t(R,{cols:"12"},{default:o(()=>[t(i,{modelValue:a.bidDescription,"onUpdate:modelValue":u=>a.bidDescription=u,label:"توضیحات",rows:"3"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(R,{cols:"12"},{default:o(()=>[t(Ye,{type:"submit",loading:s(I)[a.id]},{default:o(()=>[t(Je,{icon:"tabler-send"}),l[13]||(l[13]=p(" ارسال "))]),_:2},1032,["loading"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):oe("",!0)],64)}}},Bt=st(ht,[["__scopeId","data-v-6b234f25"]]);export{Bt as default};
