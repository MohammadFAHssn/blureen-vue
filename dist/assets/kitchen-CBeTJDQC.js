import{r as fe}from"./validators-BQd4MaJQ.js";import{_ as Re}from"./DialogCloseBtn-DWVvVePX.js";import{j as Ge}from"./index-CANmiW_M.js";import{$ as ne}from"./api-br9UOZ_z.js";import{r as T,bJ as pe,Y as oe,H as Le,a as Ke,c as R,o as c,d as t,b as e,f as j,m as Q,e as l,v as u,x as r,n as a,am as J,bv as le,F as Z,i as re,a2 as M,a1 as me,as as We,ax as tl,a6 as al,aq as nl,a7 as Ye,al as rl,aF as ol,a8 as qe,w as $e,Z as Ie,ab as sl,s as Je,b3 as Xe,aJ as ul,bg as il,aw as Ae,bS as dl,bT as cl,bU as fl,bN as Qe,bC as Te,aH as De,bO as ml,bB as vl,h as pl}from"./index-BYLMWElv.js";import{V as ge}from"./VSnackbar-D3f03dnp.js";import{V as K}from"./VRow-CvGbW_v8.js";import{V as $}from"./VCol-Dnw2og7w.js";import{V as de,b as He,c as yl}from"./VCard-BUwd7LS7.js";import{V as ye,m as gl}from"./VTextField-xIR_kpAq.js";import{V as bl}from"./VAutocomplete-K9Bw_9xF.js";import{V as ke}from"./VTable-eBwi12qL.js";import{V as Me}from"./VSkeletonLoader-JKJGd79f.js";import{V as Ee,a as Ce,b as xe,c as Fe}from"./VExpansionPanels-tgPxYPJ4.js";import{V as ze}from"./VContainer-CooBmoLI.js";import{V as we}from"./VCardText-D9XC_px9.js";import{V as te}from"./VDivider-BuOM0BhX.js";import{V as he}from"./VDialog-BQLNLaz5.js";import{V as el}from"./VTooltip-CFhqu2cI.js";import{V as _l}from"./VCheckbox-DcnDFiw3.js";import{V as je}from"./VSelect-CQZVqBuz.js";import{V as Be}from"./VForm-C7KzPoZ4.js";import"./helpers-CcX6MmOA.js";import"./index-CvOPxmL5.js";import"./useLogout-D4mPTOMv.js";import"./VOverlay-a3-HvDvP.js";/* empty css              */import"./createSimpleFunctional-BWXtzOnH.js";import"./autofocus-T5ynHuTa.js";import"./VCounter-CDQ8_4Qi.js";import"./VField-BP4ob-iM.js";import"./filter-5n8IBV6k.js";import"./VList-D3WHtMzK.js";import"./VMenu-ZNOcCJ4_.js";import"./dialog-transition-DgN6wUzd.js";import"./VCheckboxBtn-BkiS8zL8.js";const Vl={class:"ma-3 overflow-auto d-none d-md-block"},kl={class:"font-weight-medium mb-4 d-block text-center"},wl={key:2,class:"text-center"},hl={class:"d-md-none pa-3"},Ml={class:"font-weight-medium mb-4 d-block text-center"},$l={class:"d-flex justify-space-between w-100 align-center"},Dl={class:"pa-2"},El={class:"mt-2 text-center"},Cl={key:2,class:"text-center"},xl={__name:"ContractorInvoice",emits:["back"],setup(D,{emit:ae}){const I=ae,L=T("root");function Y(){L.value!=="root"?L.value="root":I("back")}const b=pe({success:!1,successMessage:"",hasError:!1,errorMessage:"",isDetailsDialogVisible:!1}),f=pe({fetchingReservedMeals:!1,fetchingContractors:!1}),h=T([]),g=T([]),C=T([]),x=T(null),N=T(null),z=oe(()=>!h.value||h.value.length===0?"":Array.isArray(h.value)?h.value.join(" - "):h.value);function B(w){b.hasError=!0,b.errorMessage=w}function A(w){b.isDetailsDialogVisible=w,w||(x.value=null)}function H(w){x.value=w,b.isDetailsDialogVisible=!0}async function G(){if(!h.value[1]){B("تاریخ باید به صورت بازه‌ای باشد.");return}if(!N.value){B("یک پیمانکار انتخاب کنید.");return}C.value=[],f.fetchingReservedMeals=!0;try{const w=await ne("/food/meal-reservation/get-for-specific-contractor-on-date",{method:"GET",params:{contractor:N.value,"date[]":h.value}});C.value=(w.data||[]).flat()}catch(w){console.error("Error fetching reserved meals:",w),B("خطا در دریافت رزروها")}finally{f.fetchingReservedMeals=!1}}async function S(){f.fetchingContractors=!0;try{const w=await ne("/contractor/get-actives",{method:"GET"});g.value=(w==null?void 0:w.data.contractors)||[]}catch(w){console.error("Error fetching contractors:",w),B(w.message||"خطا در دریافت پیمانکاران")}finally{f.fetchingContractors=!1}}const p=oe(()=>[...C.value].sort((w,d)=>String(w.date).localeCompare(String(d.date))));return Le(async()=>{await Promise.all([S()]);const w=new Date,[d]=[w].map(V=>Ge.toJalaali(V.getFullYear(),V.getMonth()+1,V.getDate())),o=V=>`${V.jy}/${String(V.jm).padStart(2,"0")}/${String(V.jd).padStart(2,"0")}`;h.value=[o(d)]}),(w,d)=>{const o=Ke("PersianDatetimePicker"),V=Re;return c(),R(Z,null,[t("div",null,[e(J,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:Y},{default:l(()=>[u(r(a(L)==="root"?"آشپزخانه":"صفحه قبل"),1)]),_:1})]),e(ze,null,{default:l(()=>[e(ge,{modelValue:a(b).hasError,"onUpdate:modelValue":d[0]||(d[0]=n=>a(b).hasError=n),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:l(()=>[u(r(a(b).errorMessage),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:a(b).success,"onUpdate:modelValue":d[1]||(d[1]=n=>a(b).success=n),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:l(()=>[u(r(a(b).successMessage),1)]),_:1},8,["modelValue"]),e(K,{dense:""},{default:l(()=>[e($,{cols:"12",md:"4",class:"d-flex justify-center mb-4 mb-md-0"},{default:l(()=>[d[5]||(d[5]=t("input",{id:"custom-input",style:{display:"none"}},null,-1)),e(o,{modelValue:a(h),"onUpdate:modelValue":d[2]||(d[2]=n=>le(h)?h.value=n:null),format:"jYYYY/jMM/jDD",inline:"",range:"","custom-input":"#custom-input"},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"8"},{default:l(()=>[e(de,{class:"mb-4"},{default:l(()=>[d[7]||(d[7]=t("label",{class:"font-weight-medium mb-2 mt-2 d-block text-center"}," جزئیات ",-1)),e(K,{class:"mb-4 px-4"},{default:l(()=>[e($,{cols:"12",sm:"12",md:"12"},{default:l(()=>[e(ye,{"model-value":a(z),label:"بازه زمانی",variant:"outlined",readonly:"",rules:["requiredValidator"in w?w.requiredValidator:a(fe)]},null,8,["model-value","rules"])]),_:1}),e($,{cols:"12",sm:"12",md:"12"},{default:l(()=>[e(bl,{modelValue:a(N),"onUpdate:modelValue":d[3]||(d[3]=n=>le(N)?N.value=n:null),items:a(g),"item-title":"fullName","item-value":"id",label:"پیمانکار",chips:"",clearable:"",variant:"outlined",rules:["requiredValidator"in w?w.requiredValidator:a(fe)]},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(K,{justify:"center",class:"mb-4"},{default:l(()=>[e($,{cols:"auto"},{default:l(()=>[e(J,{color:"primary",loading:a(f).fetchingReservedMeals,disabled:a(f).fetchingReservedMeals,onClick:G},{default:l(()=>[...d[6]||(d[6]=[u(" جستجو ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),t("div",Vl,[!a(f).fetchingReservedMeals&&a(p).length>0?(c(),j(de,{key:0,class:"pa-4"},{default:l(()=>{var n,E,_,y;return[d[9]||(d[9]=t("label",{class:"font-weight-medium mb-4 d-block text-center"}," رزروهای تحویل شده ",-1)),t("label",kl," پیمانکار: "+r((y=(_=(E=(n=a(p))==null?void 0:n[0])==null?void 0:E.details)==null?void 0:_.find(m=>m.contractor))!=null&&y.contractor?`${a(p)[0].details.find(m=>m.contractor).contractor.first_name}
                  ${a(p)[0].details.find(m=>m.contractor).contractor.last_name}`:"—"),1),e(ke,null,{default:l(()=>[d[8]||(d[8]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"وعده"),t("th",null,"تاریخ"),t("th",null,"تعداد"),t("th",null,"مبلغ"),t("th",null,"جزئیات")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(p),(m,U)=>{var ee,P;return c(),R("tr",{key:m.id},[t("td",null,r(U+1),1),t("td",null,r((ee=m.meal)==null?void 0:ee.name),1),t("td",null,[e(M,null,{default:l(()=>[u(r(m.date),1)]),_:2},1024)]),t("td",null,r((P=m.details)==null?void 0:P.reduce((W,se)=>W+(se.quantity||0),0)),1),t("td",null,[e(M,{color:"primary"},{default:l(()=>{var W;return[u(r(Number((W=m.details)==null?void 0:W.reduce((se,k)=>se+(k.quantity||0)*(k.food_price||0),0)).toLocaleString("fa-IR"))+" ریال ",1)]}),_:2},1024)]),t("td",null,[e(J,{color:"primary",variant:"text",size:"small",onClick:W=>H(m)},{default:l(()=>[e(me,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])}),128))])]),_:1})]}),_:1})):a(f).fetchingReservedMeals?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",wl,[e(M,{color:"error"},{default:l(()=>[...d[10]||(d[10]=[u(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))]),t("div",hl,[!a(f).fetchingReservedMeals&&a(p).length>0?(c(),j(Ee,{key:0,variant:"accordion"},{default:l(()=>[e(Ce,null,{default:l(()=>[e(xe,{class:"font-weight-bold"},{default:l(()=>{var n,E,_,y;return[t("label",Ml," رزروهای تحویل شده پیمانکار: "+r((y=(_=(E=(n=a(p))==null?void 0:n[0])==null?void 0:E.details)==null?void 0:_.find(m=>m.contractor))!=null&&y.contractor?`${a(p)[0].details.find(m=>m.contractor).contractor.first_name}
                  ${a(p)[0].details.find(m=>m.contractor).contractor.last_name}`:"—"),1)]}),_:1}),e(Fe,null,{default:l(()=>[e(Ee,{variant:"accordion"},{default:l(()=>[(c(!0),R(Z,null,re(a(p),n=>(c(),j(Ce,{key:n.id,class:"mb-2"},{default:l(()=>[e(xe,null,{default:l(()=>{var E;return[t("div",$l,[t("span",null,r((E=n.meal)==null?void 0:E.name),1),t("span",null,[e(M,null,{default:l(()=>[u(r(n.date),1)]),_:2},1024)])])]}),_:2},1024),e(Fe,null,{default:l(()=>{var E;return[t("div",Dl,[t("div",null,[d[11]||(d[11]=t("strong",null,"تعداد:",-1)),u(" "+r((E=n.details)==null?void 0:E.reduce((_,y)=>_+(y.quantity||0),0)),1)]),t("div",null,[d[12]||(d[12]=t("strong",null,"مبلغ:",-1)),e(M,{color:"primary"},{default:l(()=>{var _;return[u(r(Number((_=n.details)==null?void 0:_.reduce((y,m)=>y+(m.quantity||0)*(m.food_price||0),0)).toLocaleString("fa-IR"))+" ریال ",1)]}),_:2},1024)]),t("div",El,[e(J,{color:"primary",variant:"text",size:"small",onClick:_=>H(n)},{default:l(()=>[e(me,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):a(f).fetchingReservedMeals?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",Cl,[e(M,{color:"error"},{default:l(()=>[...d[13]||(d[13]=[u(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))])]),_:1})]),_:1})]),_:1}),a(x)?(c(),j(he,{key:0,width:w.$vuetify.display.smAndDown?"auto":900,"model-value":a(b).isDetailsDialogVisible,"onUpdate:modelValue":A},{default:l(()=>[e(V,{onClick:d[4]||(d[4]=n=>A(!1))}),e(de,null,{default:l(()=>[e(He,{class:"text-h6"},{default:l(()=>[...d[14]||(d[14]=[u(" جزئیات ",-1)])]),_:1}),e(we,null,{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[15]||(d[15]=t("strong",null,"رزرو کننده:",-1)),e(M,{color:"orange",size:"small"},{default:l(()=>[u(r(a(x).created_by?`${a(x).created_by.first_name} ${a(x).created_by.last_name}`:"—"),1)]),_:1})])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[16]||(d[16]=t("strong",null,"کد پرسنلی:",-1)),e(M,{color:"orange",size:"small"},{default:l(()=>[u(r(a(x).created_by?`${a(x).created_by.personnel_code}`:"—"),1)]),_:1})])]),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[d[17]||(d[17]=t("strong",null,"کد تحویل:",-1)),e(M,{color:"primary",size:"small"},{default:l(()=>[u(r(a(x).delivery_code),1)]),_:1})]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[18]||(d[18]=t("strong",null,"وعده:",-1)),e(M,{color:"primary",size:"small"},{default:l(()=>{var n;return[u(r((n=a(x).meal)==null?void 0:n.name),1)]}),_:1})])]),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[19]||(d[19]=t("strong",null,"وضعیت:",-1)),e(M,{color:a(x).status?"success":"error",size:"small"},{default:l(()=>[u(r(a(x).status?"تحویل شده":"تحویل نشده"),1)]),_:1},8,["color"])])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[20]||(d[20]=t("strong",null,"تاریخ:",-1)),e(M,{size:"small"},{default:l(()=>[u(r(a(x).date),1)]),_:1})])]),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[21]||(d[21]=t("strong",null,"تعداد:",-1)),e(M,{size:"small"},{default:l(()=>{var n;return[u(r((n=a(x).details)==null?void 0:n.reduce((E,_)=>E+(_.quantity||0),0)),1)]}),_:1})])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[d[22]||(d[22]=t("strong",null,"مبلغ:",-1)),e(M,{color:"success"},{default:l(()=>{var n;return[u(r(Number((n=a(x).details)==null?void 0:n.reduce((E,_)=>E+(_.quantity||0)*(_.food_price||0),0)).toLocaleString("fa-IR"))+" ریال ",1)]}),_:1})])]),_:1})]),_:1}),e(te,{class:"my-3"}),t("div",null,[e(ke,{density:"comfortable"},{default:l(()=>[d[23]||(d[23]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"غذا"),t("th",null,"قیمت"),t("th",null,"تعداد"),t("th",null,"مبلغ کل")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(x).details,(n,E)=>(c(),R("tr",{key:n.id},[t("td",null,r(E+1),1),t("td",null,[e(M,null,{default:l(()=>{var _;return[u(r((_=n.food)==null?void 0:_.name),1)]}),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(Number(n.food_price||0).toLocaleString("fa-IR"))+" ریال ",1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(n.quantity),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(Number((n.quantity||0)*(n.food_price||0)).toLocaleString("fa-IR"))+" ریال ",1)]),_:2},1024)])]))),128))])]),_:1})]),e(te,{class:"my-3"})]),_:1})]),_:1})]),_:1},8,["width","model-value"])):Q("",!0)],64)}}},Fl=50,Rl=500;function Sl(D){let{toggleUpDown:ae}=D,I=-1,L=-1;We(b);function Y(h){b(),f(h),window.addEventListener("pointerup",b),document.addEventListener("blur",b),I=window.setTimeout(()=>{L=window.setInterval(()=>f(h),Fl)},Rl)}function b(){window.clearTimeout(I),window.clearInterval(L),window.removeEventListener("pointerup",b),document.removeEventListener("blur",b)}We(b);function f(h){ae(h==="up")}return{holdStart:Y,holdStop:b}}const Pl=al({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:D=>!D||D.length===1},...il(gl(),["modelValue","validationValue"])},"VNumberInput"),Oe=tl()({name:"VNumberInput",props:{...Pl()},emits:{"update:focused":D=>!0,"update:modelValue":D=>!0},setup(D,ae){let{slots:I}=ae;const L=T(),{holdStart:Y,holdStop:b}=Sl({toggleUpDown:m}),f=nl(D),h=oe(()=>f.isDisabled.value||f.isReadonly.value),g=Ye(D.focused),{decimalSeparator:C}=rl(),x=oe(()=>{var v;return((v=D.decimalSeparator)==null?void 0:v[0])||C.value});function N(v){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:D.precision,ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const ce=F==null?String(v):v.toFixed(F);if(g.value&&ue)return Number(ce).toString().replace(".",x.value);if(D.minFractionDigits===null||F!==null&&F<D.minFractionDigits)return ce.replace(".",x.value);let[ve,ie]=ce.split(".");return ie=(ie??"").padEnd(D.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${D.minFractionDigits}})0+$`,"g"),""),[ve,ie].filter(Boolean).join(x.value)}const z=ol(D,"modelValue",null,v=>v??null,v=>v==null?v??null:qe(Number(v),D.min,D.max)),B=Ye(null),A=Ye(null);$e(z,v=>{var F;g.value&&!h.value&&Number((F=B.value)==null?void 0:F.replace(x.value,"."))===v||(v==null?(B.value=null,A.value=null):isNaN(v)||(B.value=N(v),A.value=Number(B.value.replace(x.value,"."))))},{immediate:!0});const H=oe({get:()=>B.value,set(v){if(v===null||v===""){z.value=null,B.value=null,A.value=null;return}const F=Number(v.replace(x.value,"."));isNaN(F)||(B.value=v,A.value=F,F<=D.max&&F>=D.min&&(z.value=F))}}),G=oe(()=>{var F;if(A.value===null)return!1;const v=Number((F=B.value)==null?void 0:F.replace(x.value,"."));return v!==qe(v,D.min,D.max)}),S=oe(()=>h.value?!1:(z.value??0)+D.step<=D.max),p=oe(()=>h.value?!1:(z.value??0)-D.step>=D.min),w=oe(()=>D.hideInput?"stacked":D.controlVariant),d=Ie(()=>w.value==="split"?"$plus":"$collapse"),o=Ie(()=>w.value==="split"?"$minus":"$expand"),V=Ie(()=>w.value==="split"?"default":"small"),n=Ie(()=>w.value==="stacked"?"auto":"100%"),E={props:{onClick:P,onPointerup:W,onPointerdown:se,onPointercancel:W}},_={props:{onClick:P,onPointerup:W,onPointerdown:k,onPointercancel:W}};$e(()=>D.precision,()=>X()),$e(()=>D.minFractionDigits,()=>X()),Le(()=>{i()});function y(v){if(v==null)return 0;const F=v.toString(),ue=F.indexOf(".");return~ue?F.length-ue:0}function m(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(h.value)return;if(z.value==null){H.value=N(qe(0,D.min,D.max));return}let F=Math.max(y(z.value),y(D.step));D.precision!=null&&(F=Math.max(F,D.precision)),v?S.value&&(H.value=N(z.value+D.step,F)):p.value&&(H.value=N(z.value-D.step,F))}function U(v){var Se;if(!v.data)return;const F=v.target,{value:ue,selectionStart:ce,selectionEnd:ve}=F??{},ie=ue?ue.slice(0,ce)+v.data+ue.slice(ve):v.data,be=dl(ie,D.precision,x.value);if(new RegExp(`^-?\\d*${cl(x.value)}?\\d*$`).test(ie)||(v.preventDefault(),F.value=be,Ae(()=>H.value=be)),D.precision!=null){if(((Se=ie.split(x.value)[1])==null?void 0:Se.length)>D.precision){v.preventDefault(),F.value=be,Ae(()=>H.value=be);const Ue=(ce??0)+v.data.length;F.setSelectionRange(Ue,Ue)}D.precision===0&&ie.endsWith(x.value)&&(v.preventDefault(),F.value=be,Ae(()=>H.value=be))}}async function ee(v){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(v.key)||v.ctrlKey||["ArrowDown","ArrowUp"].includes(v.key)&&(v.preventDefault(),v.stopPropagation(),i(),await Ae(),v.key==="ArrowDown"?m(!1):m())}function P(v){v.stopPropagation()}function W(v){const F=v.currentTarget;F==null||F.releasePointerCapture(v.pointerId),v.preventDefault(),b()}function se(v){const F=v.currentTarget;F==null||F.setPointerCapture(v.pointerId),v.preventDefault(),v.stopPropagation(),Y("up")}function k(v){const F=v.currentTarget;F==null||F.setPointerCapture(v.pointerId),v.preventDefault(),v.stopPropagation(),Y("down")}function i(){if(h.value||!L.value)return;const v=L.value.value,F=Number(v.replace(x.value,"."));v&&!isNaN(F)?H.value=N(qe(F,D.min,D.max)):H.value=null}function X(){h.value||(H.value=z.value!==null&&!isNaN(z.value)?N(z.value,D.precision,!1):null)}function s(){if(!h.value){if(z.value===null||isNaN(z.value)){H.value=null;return}H.value=z.value.toString().replace(".",x.value)}}function q(){s()}function O(){i()}return sl(()=>{const{modelValue:v,type:F,...ue}=ye.filterProps(D);function ce(){return I.increment?e(Xe,{key:"increment-defaults",defaults:{VBtn:{disabled:!S.value,height:n.value,size:V.value,icon:d.value,variant:"text"}}},{default:()=>[I.increment(E)]}):e(J,{"aria-hidden":"true","data-testid":"increment",disabled:!S.value,height:n.value,icon:d.value,key:"increment-btn",onClick:P,onPointerdown:se,onPointerup:W,onPointercancel:W,size:V.value,variant:"text",tabindex:"-1"},null)}function ve(){return I.decrement?e(Xe,{key:"decrement-defaults",defaults:{VBtn:{disabled:!p.value,height:n.value,size:V.value,icon:o.value,variant:"text"}}},{default:()=>[I.decrement(_)]}):e(J,{"aria-hidden":"true","data-testid":"decrement",disabled:!p.value,height:n.value,icon:o.value,key:"decrement-btn",onClick:P,onPointerdown:k,onPointerup:W,onPointercancel:W,size:V.value,variant:"text",tabindex:"-1"},null)}function ie(){return t("div",{class:"v-number-input__control"},[ve(),e(te,{vertical:w.value!=="stacked"},null),ce()])}function be(){return!D.hideInput&&!D.inset?e(te,{vertical:!0},null):void 0}const Se=w.value==="split"?t("div",{class:"v-number-input__control"},[e(te,{vertical:!0},null),ce()]):D.reverse||w.value==="hidden"?void 0:t(Z,null,[be(),ie()]),Ue=I["append-inner"]||Se,Ze=w.value==="split"?t("div",{class:"v-number-input__control"},[ve(),e(te,{vertical:!0},null)]):D.reverse&&w.value!=="hidden"?t(Z,null,[ie(),be()]):void 0,ll=I["prepend-inner"]||Ze;return e(ye,Je({ref:L},ue,{modelValue:H.value,"onUpdate:modelValue":_e=>H.value=_e,focused:g.value,"onUpdate:focused":_e=>g.value=_e,validationValue:z.value,error:G.value||void 0,onBeforeinput:U,onFocus:q,onBlur:O,onKeydown:ee,class:["v-number-input",{"v-number-input--default":w.value==="default","v-number-input--hide-input":D.hideInput,"v-number-input--inset":D.inset,"v-number-input--reverse":D.reverse,"v-number-input--split":w.value==="split","v-number-input--stacked":w.value==="stacked"},D.class],style:D.style,inputmode:"decimal"}),{...I,"append-inner":Ue?function(){var Ne;for(var _e=arguments.length,Pe=new Array(_e),Ve=0;Ve<_e;Ve++)Pe[Ve]=arguments[Ve];return t(Z,null,[(Ne=I["append-inner"])==null?void 0:Ne.call(I,...Pe),Se])}:void 0,"prepend-inner":ll?function(){var Ne;for(var _e=arguments.length,Pe=new Array(_e),Ve=0;Ve<_e;Ve++)Pe[Ve]=arguments[Ve];return t(Z,null,[Ze,(Ne=I["prepend-inner"])==null?void 0:Ne.call(I,...Pe)])}:void 0})}),ul({},L)}}),Nl={class:"ma-3 overflow-auto d-none d-md-block"},jl={key:0,class:"text-center mb-4"},Tl={key:1},zl={class:"py-2"},Bl={style:{"max-width":"420px","white-space":"normal","overflow-wrap":"anywhere"}},Ul={key:2,class:"text-center"},ql={class:"d-md-none pa-3"},Il={key:0,class:"text-center mb-4"},Al={class:"d-flex flex-column w-100"},Ol={class:"d-flex justify-space-between align-center mb-1"},Ll={class:"d-flex justify-space-between align-center"},Yl={class:"pa-2"},Gl={class:"mb-2 d-flex justify-space-between"},Kl={class:"mb-2 d-flex justify-space-between"},Jl={class:"mb-2 d-flex justify-space-between"},Hl={class:"mb-2 d-flex justify-space-between align-start"},Zl={style:{"max-width":"100%","white-space":"normal","overflow-wrap":"anywhere","word-break":"break-word","text-align":"right",flex:"1"}},Wl={class:"mt-2 text-center"},Xl={key:2,class:"text-center"},Ql={style:{"white-space":"normal","overflow-wrap":"anywhere"}},et={key:0},lt={key:1},tt={__name:"Delivery",emits:["back"],setup(D,{emit:ae}){const I=ae,L=T("root");function Y(){L.value!=="root"?L.value="root":I("back")}const b=pe({success:!1,successMessage:"",hasError:!1,errorMessage:"",isDeliveryDialogVisible:!1}),f=pe({fetchingReservedMeals:!0,searchReservedMeal:!1,deliverReservedMeal:!1,fetchingFoods:!1}),h=T([]),g=T(null),C=T(null),x=T(null),N=T([]),z=oe(()=>{var k,i;return((i=(k=g.value)==null?void 0:k.details)==null?void 0:i.reduce((X,s)=>X+(s.quantity||0),0))||0}),B=T(0);$e(z,k=>{B.value=k},{immediate:!0});const A=T(0);$e(B,k=>{A.value=k},{immediate:!0});const H=T([]),G=T(null),S=T(0),p=T(null),w=T(0),d=oe(()=>Math.max(B.value-A.value,0)),o=oe(()=>Math.max(B.value-A.value-S.value,0));$e([B,A,S,w],()=>{A.value>B.value&&(A.value=B.value),S.value>d.value&&(S.value=d.value),d.value===0&&(G.value=null,S.value=0),w.value>o.value&&(w.value=o.value),o.value===0&&(p.value=null,w.value=0)});const V=[k=>k==null||k===""||/^\d+$/.test(String(k))?!0:"فقط باید عدد باشد!"];function n(k){b.hasError=!0,b.errorMessage=k}async function E(){if(!x.value){n("لطفاً ابتدا، کد تحویل را وارد کنید کنید.");return}f.searchReservedMeal=!0;try{const k=await ne("/food/delivery/find",{method:"GET",params:{date:C.value,delivery_code:x.value},onResponseError({response:X}){var s;(s=X._data)!=null&&s.errors?n("رزروی با این کد تحویل یافت نشد."):b.errorMessage="خطا در جستجو"}}),i=(k==null?void 0:k.data)??null;if(g.value=Array.isArray(i)?i[0]??null:i,!g.value){n("این رزرو، تحویل داده شده است یا در بازه تحویل قرار ندارد.");return}b.isDeliveryDialogVisible=!0}catch(k){console.error("Error fetching reserved meal:",k)}finally{f.searchReservedMeal=!1}}async function _(){h.value=[],f.fetchingReservedMeals=!0;try{const k=await ne("/food/delivery",{method:"GET",params:{date:C.value}});h.value=((k==null?void 0:k.data)||[]).flat()}catch(k){console.error("Error fetching reserved meals:",k),n("خطا در دریافت رزروها")}finally{f.fetchingReservedMeals=!1}}async function y(){f.fetchingFoods=!0;try{const k=await ne("/food/food/get-actives",{method:"GET"});H.value=(k==null?void 0:k.data.foods)||[]}catch(k){console.error("Error fetching foods:",k),n("خطا در دریافت غذاها")}finally{f.fetchingFoods=!1}}function m(k){b.isDeliveryDialogVisible=k,k||U()}function U(){g.value=null,x.value=null,N.value=[],G.value=null,S.value=0,p.value=null,w.value=0}async function ee(){var k,i,X;if(!g.value){n("رزروی انتخاب نشده است.");return}if(g.value.reserve_type==="personnel"){const q=(g.value.details||[]).filter(O=>O.personnel).map(O=>O.id);if(q.length>0&&N.value.length===q.length){n("نمیتوان گزینه تحویل نگرفت را برای تمام کاربران درخواست، انتخاب کرد");return}}if(g.value.reserve_type==="contractor"){const s=Number(B.value)||0,q=Number(A.value)||0,O=Number(S.value)||0,v=Number(w.value)||0;if(G.value&&O<=0){n("برای غذای دوم، تعداد دریافتی را وارد کنید");return}if(p.value&&v<=0){n("برای غذای سوم، تعداد دریافتی را وارد کنید");return}if(q+O+v!==s){n("مجموع دریافتی‌ها باید دقیقاً برابر تعداد دریافتی کل باشد");return}}f.deliverReservedMeal=!0;try{let s;g.value.reserve_type==="personnel"?s={type:"personnel",reserved_meal_id:g.value.id,...N.value.length>0?{noDeliveryFor:N.value}:{}}:g.value.reserve_type==="contractor"?s={type:"contractor",contractor:(X=(i=(k=g.value.details)==null?void 0:k[0])==null?void 0:i.contractor)==null?void 0:X.id,reserved_meal_id:g.value.id,received_count:B.value,today_food_count:A.value,...G.value?{second_food:G.value}:{},...G.value?{second_food_received_count:S.value}:{},...p.value?{third_food:p.value}:{},...p.value?{third_food_received_count:w.value}:{}}:g.value.reserve_type==="guest"&&(s={type:"guest",reserved_meal_id:g.value.id});const q=await ne("/food/delivery",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),onResponseError({response:O}){var ue;b.hasError=!0;const v=(O==null?void 0:O._data)||{},F=(ue=v==null?void 0:v.errors)==null?void 0:ue.personnel;if((v==null?void 0:v.code)==="VALIDATION_ERROR"&&Array.isArray(F)&&F.length){const ce=F.map(ve=>{var ie;return(ie=String(ve).match(/(\d+)/g))==null?void 0:ie.join(" - ")}).filter(Boolean);b.errorMessage=`برای پرسنل با کد/های پرسنلی زیر، ترددی ثبت نشده است. لطفا گزینه 'تحویل نگرفت' آن‌ها را علامت زده سپس، اقدام به ارسال نمایید:
${ce}`;return}if(v!=null&&v.errors){b.errorMessage=Object.values(v.errors).flat().join(" | ");return}b.errorMessage=(v==null?void 0:v.message)||"خطا در ارسال"}});return await _(),b.isDeliveryDialogVisible=!1,U(),q}catch(s){if(console.error("Error deliver:",s),b.hasError&&b.errorMessage)return;n("خطا در ارسال اطلاعات")}finally{f.deliverReservedMeal=!1}}const P=oe(()=>[...h.value].sort((k,i)=>{var X,s;return String(((X=k==null?void 0:k.meal)==null?void 0:X.name)||"").localeCompare(String(((s=i==null?void 0:i.meal)==null?void 0:s.name)||""))})),W=oe(()=>{var i,X;const k={};for(const s of h.value){const q=((i=s.meal)==null?void 0:i.name)||"نامشخص",O=((X=s.details)==null?void 0:X.reduce((v,F)=>v+(F.quantity||0),0))||0;k[q]||(k[q]=0),k[q]+=O}return Object.entries(k).map(([s,q])=>({name:s,total:q}))}),se=oe(()=>{var i,X;const k={};for(const s of h.value){const q=`${((i=s.meal)==null?void 0:i.name)||"نامشخص"} تحویل نشده`,O=((X=s.details)==null?void 0:X.reduce((v,F)=>v+(F.delivery_status?0:F.quantity||0),0))??0;k[q]||(k[q]=0),k[q]+=O}return Object.entries(k).map(([s,q])=>({name:s,total:q}))});return Le(async()=>{const k=new Date,i=Ge.toJalaali(k.getFullYear(),k.getMonth()+1,k.getDate()),X=s=>`${s.jy}/${String(s.jm).padStart(2,"0")}/${String(s.jd).padStart(2,"0")}`;C.value=X(i),await _(),await y()}),(k,i)=>{const X=Re;return c(),R(Z,null,[t("div",null,[e(J,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:Y},{default:l(()=>[u(r(a(L)==="root"?"آشپزخانه":"صفحه قبل"),1)]),_:1})]),e(ze,null,{default:l(()=>[e(ge,{modelValue:a(b).hasError,"onUpdate:modelValue":i[0]||(i[0]=s=>a(b).hasError=s),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:l(()=>[u(r(a(b).errorMessage),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:a(b).success,"onUpdate:modelValue":i[1]||(i[1]=s=>a(b).success=s),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:l(()=>[u(r(a(b).successMessage),1)]),_:1},8,["modelValue"]),e(K,{dense:""},{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(de,{class:"mb-4"},{default:l(()=>[i[12]||(i[12]=t("label",{class:"font-weight-medium mb-2 mt-2 d-block text-center"}," تحویل غذا ",-1)),e(K,{class:"mb-4 px-4"},{default:l(()=>[e($,{cols:"12",sm:"12",md:"12"},{default:l(()=>[e(ye,{modelValue:a(x),"onUpdate:modelValue":i[2]||(i[2]=s=>le(x)?x.value=s:null),label:"کد تحویل",variant:"outlined",rules:["requiredValidator"in k?k.requiredValidator:a(fe),...V],onKeydown:fl(E,["enter"])},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(K,{justify:"center",class:"mb-4"},{default:l(()=>[e($,{cols:"auto"},{default:l(()=>[e(J,{color:"primary",loading:a(f).searchReservedMeal,disabled:a(f).searchReservedMeal,onClick:E},{default:l(()=>[...i[11]||(i[11]=[u(" جستجو ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),t("div",Nl,[!a(f).fetchingReservedMeals&&a(P).length>0?(c(),j(de,{key:0,class:"pa-4"},{default:l(()=>[i[15]||(i[15]=t("label",{class:"font-weight-medium mb-4 d-block text-center"}," رزروهای امروز ",-1)),a(P).length?(c(),R("div",jl,[(c(!0),R(Z,null,re(a(W),s=>(c(),j(M,{key:s.name,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:l(()=>[u(r(s.name)+": "+r(s.total),1)]),_:2},1024))),128)),(c(!0),R(Z,null,re(a(se),s=>(c(),j(M,{key:s.name,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:l(()=>[u(r(s.name)+": "+r(s.total),1)]),_:2},1024))),128))])):Q("",!0),e(ke,null,{default:l(()=>[i[14]||(i[14]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"وعده"),t("th",null,"رزرو کننده"),t("th",null,"کد پرسنلی"),t("th",null,"کد تحویل"),t("th",null,"نوع رزرو"),t("th",null,"وضعیت"),t("th",null,"پیمانکار"),t("th",null,"تعداد"),t("th",null,"توضیحات"),t("th",null,"عملیات")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(P),(s,q)=>{var O,v,F,ue,ce;return c(),R("tr",{key:s.id},[t("td",null,r(q+1),1),t("td",null,r((O=s.meal)==null?void 0:O.name),1),t("td",null,[e(M,null,{default:l(()=>[u(r(s.created_by?`${s.created_by.first_name} ${s.created_by.last_name}`:"—"),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(s.created_by?`${s.created_by.personnel_code}`:"—"),1)]),_:2},1024)]),t("td",null,[e(M,{color:"success"},{default:l(()=>[u(r(s.delivery_code),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r({personnel:"پرسنل",contractor:"پیمانکار",guest:"مهمان"}[s.reserve_type]||""),1)]),_:2},1024)]),t("td",null,[e(M,{color:s.status?"success":"error",size:"small"},{default:l(()=>[u(r(s.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])]),t("td",null,[(F=(v=s.details)==null?void 0:v[0])!=null&&F.contractor?(c(),j(M,{key:0},{default:l(()=>[u(r(`${s.details[0].contractor.first_name} ${s.details[0].contractor.last_name}`),1)]),_:2},1024)):(c(),R("span",Tl,"—"))]),t("td",null,r((ue=s.details)==null?void 0:ue.reduce((ve,ie)=>ve+(ie.quantity||0),0)),1),t("td",zl,[e(el,{location:"top",disabled:!(((ce=s.description)==null?void 0:ce.length)>6)},{activator:l(({props:ve})=>[t("div",Je({ref_for:!0},ve,{class:"text-truncate",style:{"max-width":"120px"}}),r(s.description||"—"),17)]),default:l(()=>[t("div",Bl,r(s.description),1)]),_:2},1032,["disabled"])]),t("td",null,[e(J,{color:"orange-darken-2",variant:"plain",onClick:ve=>{g.value=s,a(b).isDeliveryDialogVisible=!0}},{default:l(()=>[e(me,{icon:"tabler-circle-dashed-check",size:"20",start:""}),i[13]||(i[13]=u(" تحویل ",-1))]),_:1},8,["onClick"])])])}),128))])]),_:1})]),_:1})):a(f).fetchingReservedMeals?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",Ul,[e(M,{color:"error"},{default:l(()=>[...i[16]||(i[16]=[u(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))]),t("div",ql,[!a(f).fetchingReservedMeals&&a(P).length>0?(c(),j(Ee,{key:0,variant:"accordion"},{default:l(()=>[e(Ce,null,{default:l(()=>[e(xe,{class:"font-weight-bold"},{default:l(()=>[i[17]||(i[17]=u(" رزروهای امروز ",-1)),a(P).length?(c(),R("div",Il,[(c(!0),R(Z,null,re(a(W),s=>(c(),j(M,{key:s.name,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:l(()=>[u(r(s.name)+": "+r(s.total),1)]),_:2},1024))),128)),(c(!0),R(Z,null,re(a(se),s=>(c(),j(M,{key:s.name,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:l(()=>[u(r(s.name)+": "+r(s.total),1)]),_:2},1024))),128))])):Q("",!0)]),_:1}),e(Fe,null,{default:l(()=>[e(Ee,{variant:"accordion"},{default:l(()=>[(c(!0),R(Z,null,re(a(P),s=>(c(),j(Ce,{key:s.id,class:"mb-2"},{default:l(()=>[e(xe,null,{default:l(()=>{var q;return[t("div",Al,[t("div",Ol,[t("span",null,r((q=s.meal)==null?void 0:q.name),1),e(M,null,{default:l(()=>[u(r(s.created_by?`${s.created_by.first_name} ${s.created_by.last_name}`:"—"),1)]),_:2},1024)]),t("div",Ll,[e(M,null,{default:l(()=>[u(r(s.created_by?`${s.created_by.personnel_code}`:"—"),1)]),_:2},1024),e(M,{color:"success"},{default:l(()=>[u(r(s.delivery_code),1)]),_:2},1024)])])]}),_:2},1024),e(Fe,null,{default:l(()=>{var q;return[t("div",Yl,[t("div",Gl,[i[18]||(i[18]=t("strong",null,"نوع رزرو:",-1)),e(M,null,{default:l(()=>[u(r({personnel:"پرسنل",contractor:"پیمانکار",guest:"مهمان"}[s.reserve_type]||""),1)]),_:2},1024)]),t("div",Kl,[i[19]||(i[19]=t("strong",null,"پیمانکار:",-1)),e(M,null,{default:l(()=>{var O,v;return[u(r((v=(O=s.details)==null?void 0:O[0])!=null&&v.contractor?`${s.details[0].contractor.first_name} ${s.details[0].contractor.last_name}`:"—"),1)]}),_:2},1024)]),t("div",Jl,[e(M,{color:s.status?"success":"error",size:"small"},{default:l(()=>[u(r(s.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"]),u(" "+r((q=s.details)==null?void 0:q.reduce((O,v)=>O+(v.quantity||0),0))+" عدد ",1)]),t("div",Hl,[i[20]||(i[20]=t("strong",{class:"me-2"},"توضیحات:",-1)),t("div",Zl,r(s.description||"—"),1)]),t("div",Wl,[e(J,{color:"orange-darken-2",variant:"plain",onClick:O=>{g.value=s,a(b).isDeliveryDialogVisible=!0}},{default:l(()=>[e(me,{icon:"tabler-circle-dashed-check",size:"20",start:""}),i[21]||(i[21]=u(" تحویل ",-1))]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):a(f).fetchingReservedMeals?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",Xl,[e(M,{color:"error"},{default:l(()=>[...i[22]||(i[22]=[u(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))])]),_:1})]),_:1})]),_:1}),a(g)?(c(),j(he,{key:0,width:k.$vuetify.display.smAndDown?"auto":900,"model-value":a(b).isDeliveryDialogVisible,"onUpdate:modelValue":m},{default:l(()=>[e(X,{onClick:i[3]||(i[3]=s=>m(!1))}),e(de,null,{default:l(()=>[e(He,{class:"text-h6"},{default:l(()=>[...i[23]||(i[23]=[u(" تحویل ",-1)])]),_:1}),e(yl,{class:"justify-end"},{default:l(()=>[e(J,{color:"primary",variant:"tonal",loading:a(f).deliverReservedMeal,disabled:a(f).deliverReservedMeal||a(g).status,onClick:ee},{default:l(()=>[...i[24]||(i[24]=[u(" ارسال ",-1)])]),_:1},8,["loading","disabled"])]),_:1}),e(we,null,{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[25]||(i[25]=t("strong",null,"رزرو کننده:",-1)),u(" "+r(a(g).created_by?`${a(g).created_by.first_name} ${a(g).created_by.last_name}`:"—"),1)])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[26]||(i[26]=t("strong",null,"کد پرسنلی:",-1)),u(" "+r(a(g).created_by?`${a(g).created_by.personnel_code}`:"—"),1)])]),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>{var s,q;return[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[27]||(i[27]=t("strong",null,"کد تحویل:",-1)),u(" "+r(a(g).delivery_code),1)])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>{var O;return[t("p",null,[i[28]||(i[28]=t("strong",null,"وعده:",-1)),u(" "+r((O=a(g).meal)==null?void 0:O.name),1)])]}),_:1}),e(te,{class:"my-3"}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[29]||(i[29]=t("strong",null,"نوع رزرو:",-1)),u(" "+r({personnel:"پرسنل",contractor:"پیمانکار",guest:"مهمان"}[a(g).reserve_type]||""),1)])]),_:1}),(q=(s=a(g).details)==null?void 0:s[0])!=null&&q.contractor?(c(),j($,{key:0,cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[30]||(i[30]=t("strong",null,"پیمانکار:",-1)),u(" "+r(`${a(g).details[0].contractor.first_name} ${a(g).details[0].contractor.last_name}`),1)])]),_:1})):Q("",!0),a(g).reserve_type==="guest"?(c(),j($,{key:1,cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[31]||(i[31]=t("strong",null,"نوع سرو:",-1)),u(" "+r({serve_in_kitchen:"سرو در آشپزخانه",deliver:"تحویل"}[a(g).serve_place]||""),1)])]),_:1})):Q("",!0)]}),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[i[32]||(i[32]=t("strong",null,"وضعیت:",-1)),u(" "+r(a(g).status?"تحویل شده":"تحویل نشده"),1)])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>{var s;return[t("p",null,[i[33]||(i[33]=t("strong",null,"تعداد:",-1)),u(" "+r((s=a(g).details)==null?void 0:s.reduce((q,O)=>q+(O.quantity||0),0)),1)])]}),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[a(g).description?(c(),j($,{key:0,cols:"12",sm:"12"},{default:l(()=>[t("p",Ql,[i[34]||(i[34]=t("strong",null,"توضیحات:",-1)),u(" "+r(a(g).description),1)])]),_:1})):Q("",!0)]),_:1}),e(te,{class:"my-3"}),a(g).reserve_type==="personnel"?(c(),R("div",et,[e(ke,{density:"comfortable"},{default:l(()=>[i[35]||(i[35]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"نام"),t("th",null,"کد پرسنلی"),t("th",null,"تحویل نگرفت")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re((a(g).details||[]).filter(s=>s.personnel),(s,q)=>(c(),R("tr",{key:s.id},[t("td",null,r(q+1),1),t("td",null,r(`${s.personnel.first_name} ${s.personnel.last_name}`),1),t("td",null,r(s.personnel.personnel_code),1),t("td",null,[a(g).status?s.delivery_status?Q("",!0):(c(),j(me,{key:1,icon:"tabler-square-check"})):(c(),j(_l,{key:0,modelValue:a(N),"onUpdate:modelValue":i[4]||(i[4]=O=>le(N)?N.value=O:null),value:s.id,"hide-details":"",color:"red"},null,8,["modelValue","value"]))])]))),128))])]),_:1})])):Q("",!0),a(g).reserve_type==="contractor"?(c(),R("div",lt,[a(g).status?Q("",!0):(c(),j(ze,{key:0},{default:l(()=>[e(K,null,{default:l(()=>[e($,null,{default:l(()=>[i[36]||(i[36]=t("h5",null,"تعداد دریافتی کل",-1)),e(Oe,{modelValue:a(B),"onUpdate:modelValue":i[5]||(i[5]=s=>le(B)?B.value=s:null),min:1,max:a(z)},null,8,["modelValue","max"])]),_:1}),e($,null,{default:l(()=>[i[37]||(i[37]=t("h5",null,"غذای روز",-1)),e(Oe,{modelValue:a(A),"onUpdate:modelValue":i[6]||(i[6]=s=>le(A)?A.value=s:null),min:1,max:a(B)},null,8,["modelValue","max"])]),_:1})]),_:1}),a(d)>0?(c(),j(K,{key:0},{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(je,{modelValue:a(G),"onUpdate:modelValue":i[7]||(i[7]=s=>le(G)?G.value=s:null),items:a(H),"item-title":"name","item-value":"id",label:"غذای دوم",variant:"outlined",clearable:"",rules:["requiredValidator"in k?k.requiredValidator:a(fe)]},null,8,["modelValue","items","rules"])]),_:1}),a(G)?(c(),j($,{key:0},{default:l(()=>[i[38]||(i[38]=t("h5",null,"تعداد دریافتی",-1)),e(Oe,{modelValue:a(S),"onUpdate:modelValue":i[8]||(i[8]=s=>le(S)?S.value=s:null),min:1,max:a(d)},null,8,["modelValue","max"])]),_:1})):Q("",!0)]),_:1})):Q("",!0),a(G)&&a(o)>0?(c(),j(K,{key:1},{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(je,{modelValue:a(p),"onUpdate:modelValue":i[9]||(i[9]=s=>le(p)?p.value=s:null),items:a(H).filter(s=>s.id!==a(G)),"item-title":"name","item-value":"id",label:"غذای سوم",variant:"outlined",clearable:"",rules:["requiredValidator"in k?k.requiredValidator:a(fe)]},null,8,["modelValue","items","rules"])]),_:1}),a(p)?(c(),j($,{key:0},{default:l(()=>[i[39]||(i[39]=t("h5",null,"تعداد دریافتی",-1)),e(Oe,{modelValue:a(w),"onUpdate:modelValue":i[10]||(i[10]=s=>le(w)?w.value=s:null),min:1,max:a(o)},null,8,["modelValue","max"])]),_:1})):Q("",!0)]),_:1})):Q("",!0)]),_:1}))])):Q("",!0),a(g).reserve_type!=="guest"&&a(g).reserve_type==="contractor"&&!a(g).status?(c(),j(te,{key:2,class:"my-3"})):Q("",!0)]),_:1})]),_:1})]),_:1},8,["width","model-value"])):Q("",!0)],64)}}},at={class:"d-flex justify-end gap-3 mb-3"},nt={key:0},rt={key:1},ot={key:2,class:"text-center"},st={class:"text-h5 text-center mb-2"},ut={__name:"Foods",emits:["back"],async setup(D,{emit:ae}){let I,L;const Y=ae,b=T("root"),f=pe({hasError:!1,errorMessage:"",isCreateFoodDialogVisible:!1,isEditFoodDialogVisible:!1}),h=pe({fetchingFoods:!0,createFood:!1,editFood:!1}),g=T([]),C=T(null),x=T(),N=T(null),z=T(null),B=[V=>/^\d+$/.test(String(V))?!0:"فقط باید عدد باشد!"];function A(){b.value!=="root"?b.value="root":Y("back")}async function H(){var _;const V=await((_=x.value)==null?void 0:_.validate());if(!(V==null?void 0:V.valid))return;h.createFood=!0;const E=new FormData;E.append("name",N.value),E.append("price",Number(z.value||0));try{await ne("/food/food/",{method:"POST",body:E,onResponseError({response:y}){var m,U;if(f.hasError=!0,(m=y._data)!=null&&m.errors){const ee=Object.values(y._data.errors).flat().join(" | ");f.errorMessage=ee}else f.errorMessage=((U=y._data)==null?void 0:U.message)||"خطا در ایجاد"}}),f.hasError||(f.isCreateFoodDialogVisible=!1,d(),w())}catch(y){console.error(y)}finally{h.createFood=!1}}async function G(V){try{const E=(await ne(`/food/food/status/${V.id}`,{method:"POST",onResponseError({response:_}){f.hasError=!0,f.errorMessage=_._data.message||"خطا در تغییر وضعیت"}})).data;!f.hasError&&E&&(g.value=g.value.map(_=>_.id===E.id?E:_),f.isEditFoodDialogVisible=!1,d())}catch(n){console.error(n)}}function S(V){C.value=V,N.value=V.name,z.value=V.price,f.isEditFoodDialogVisible=!0}async function p(){var _;const V=await((_=x.value)==null?void 0:_.validate());if(!(V==null?void 0:V.valid))return;h.editFood=!0;const E=new FormData;E.append("name",N.value),E.append("price",Number(z.value||0));try{const m=(await ne(`/food/food/${C.value.id}`,{method:"POST",body:E,onResponseError({response:U}){var ee,P;if(f.hasError=!0,(ee=U._data)!=null&&ee.errors){const W=Object.values(U._data.errors).flat().join(" | ");f.errorMessage=W}else f.errorMessage=((P=U._data)==null?void 0:P.message)||"خطا در ویرایش"}})).data;!f.hasError&&m&&(g.value=g.value.map(U=>U.id===m.id?m:U),f.isEditFoodDialogVisible=!1,d())}catch(y){console.error(y)}finally{h.editFood=!1}}async function w(){h.fetchingFoods=!0;try{const V=await ne("/food/food/",{method:"GET"});g.value=(V==null?void 0:V.data.foods)||[]}catch(V){console.error("Error fetching foods:",V),f.hasError=!0,f.errorMessage=V.message||"خطا در دریافت غذاها"}finally{h.fetchingFoods=!1}}[I,L]=Qe(()=>w()),await I,L();function d(){N.value=null,z.value=null}function o(V){V||(f.isCreateFoodDialogVisible=!1,f.isEditFoodDialogVisible=!1,d())}return(V,n)=>{const E=Re;return c(),R(Z,null,[e(ge,{modelValue:a(f).hasError,"onUpdate:modelValue":n[0]||(n[0]=_=>a(f).hasError=_),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:l(()=>[u(r(a(f).errorMessage),1)]),_:1},8,["modelValue"]),t("div",null,[e(J,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:A},{default:l(()=>[u(r(a(b)==="root"?"آشپزخانه":"صفحه قبل"),1)]),_:1})]),t("div",null,[t("div",at,[e(J,{color:"primary",onClick:n[1]||(n[1]=_=>{a(f).isCreateFoodDialogVisible=!0})},{default:l(()=>[e(me,{icon:"tabler-plus",size:"24",style:{cursor:"pointer"}})]),_:1})]),t("div",null,[!a(h).fetchingFoods&&a(g).length>0?(c(),j(ke,{key:0},{default:l(()=>[n[10]||(n[10]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"نام"),t("th",null,"وضعیت"),t("th",null,"قیمت"),t("th",null,"ایجاد شده توسط"),t("th",null,"آخرین ویرایش توسط"),t("th",null,"عملیات")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(g),(_,y)=>(c(),R("tr",{key:_.id},[t("td",null,r(y+1),1),t("td",null,r(_.name),1),_.id!==1?(c(),R("td",nt,[e(M,{color:_.status?"success":"error",size:"small"},{default:l(()=>[u(r(_.status?"فعال":"غیرفعال"),1)]),_:2},1032,["color"])])):Q("",!0),_.id===1?(c(),R("td",rt,[e(M,{color:"success",size:"small"},{default:l(()=>[...n[9]||(n[9]=[u(" فعال ",-1)])]),_:1})])):Q("",!0),t("td",null,[e(M,{color:"primary"},{default:l(()=>[u(r(Number(_.price).toLocaleString("fa-IR")),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(_.createdBy?`${_.createdBy.fullName} - ${_.createdBy.username}`:"—"),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(_.editedBy?`${_.editedBy.fullName} - ${_.editedBy.username}`:"—"),1)]),_:2},1024)]),t("td",null,[e(me,{disabled:_.id===1,icon:"tabler-power",color:_.status?"red":"green",size:"24",onClick:m=>G(_)},null,8,["disabled","color","onClick"]),e(me,{disabled:_.id===1,icon:"tabler-edit",color:"primary",size:"24",onClick:m=>S(_)},null,8,["disabled","onClick"])])]))),128))])]),_:1})):a(h).fetchingFoods?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",ot,[e(M,{color:"error"},{default:l(()=>[...n[11]||(n[11]=[u(" غذایی برای نمایش وجود ندارد ",-1)])]),_:1})]))])]),e(he,{width:V.$vuetify.display.smAndDown?"auto":900,"model-value":a(f).isCreateFoodDialogVisible,"onUpdate:modelValue":o},{default:l(()=>[e(E,{onClick:n[2]||(n[2]=_=>o(!1))}),e(de,null,{default:l(()=>[e(we,null,{default:l(()=>[n[14]||(n[14]=t("h4",{class:"text-h5 text-center mb-2"}," افزودن غذا ",-1)),e(Be,{ref_key:"refVForm",ref:x,class:"mt-6","validate-on":"submit lazy",onSubmit:Te(H,["prevent"])},{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",md:"6"},{default:l(()=>[e(De,{disabled:a(h).createFood},{default:l(()=>[e(ye,{modelValue:a(N),"onUpdate:modelValue":n[3]||(n[3]=_=>le(N)?N.value=_:null),rules:["requiredValidator"in V?V.requiredValidator:a(fe)],disabled:a(h).createFood,simple:"",label:"نام"},null,8,["modelValue","rules","disabled"])]),_:1},8,["disabled"])]),_:1}),e($,{cols:"12",md:"6"},{default:l(()=>[e(De,null,{default:l(()=>[e(ye,{modelValue:a(z),"onUpdate:modelValue":n[4]||(n[4]=_=>le(z)?z.value=_:null),rules:["requiredValidator"in V?V.requiredValidator:a(fe),...B],disabled:a(h).createFood,simple:"",label:"قیمت"},null,8,["modelValue","rules","disabled"])]),_:1})]),_:1}),e($,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(J,{type:"submit",disabled:a(h).createFood,loading:a(h).createFood},{default:l(()=>[...n[12]||(n[12]=[u(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),e(J,{color:"secondary",variant:"tonal",onClick:n[5]||(n[5]=_=>o(!1))},{default:l(()=>[...n[13]||(n[13]=[u(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(he,{width:V.$vuetify.display.smAndDown?"auto":450,"model-value":a(f).isEditFoodDialogVisible,"onUpdate:modelValue":o},{default:l(()=>[e(E,{onClick:n[6]||(n[6]=_=>o(!1))}),e(de,null,{default:l(()=>[e(we,null,{default:l(()=>{var _;return[t("h4",st," ویرایش قیمت: "+r((_=a(C))==null?void 0:_.name),1),e(Be,{ref_key:"refVForm",ref:x,class:"mt-6","validate-on":"submit lazy",onSubmit:Te(p,["prevent"])},{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(De,null,{default:l(()=>[e(ye,{modelValue:a(z),"onUpdate:modelValue":n[7]||(n[7]=y=>le(z)?z.value=y:null),rules:["requiredValidator"in V?V.requiredValidator:a(fe),...B],disabled:a(h).editFood,simple:"",label:"قیمت"},null,8,["modelValue","rules","disabled"])]),_:1})]),_:1}),e($,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(J,{type:"submit",disabled:a(h).editFood,loading:a(h).editFood},{default:l(()=>[...n[15]||(n[15]=[u(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),e(J,{color:"secondary",variant:"tonal",onClick:n[8]||(n[8]=y=>o(!1))},{default:l(()=>[...n[16]||(n[16]=[u(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1})]),_:1},8,["width","model-value"])],64)}}},it={class:"pa-3"},dt={class:"d-flex justify-space-between w-100 align-center"},ct={class:"pa-2"},ft={class:"mt-2 text-center"},mt={key:2,class:"text-center"},vt={__name:"MealPlan",emits:["back"],setup(D,{emit:ae}){const I=ae,L=T("root"),Y=pe({success:!1,successMessage:"",hasError:!1,errorMessage:"",isEditDialogVisible:!1}),b=pe({fetchingPlans:!0,fetchingMeals:!1,fetchingFoods:!1,createPlan:!1,editPlan:!1}),f=T([]),h=T([]),g=T([]),C=T(""),x=T({jy:null,jm:null,jd:null}),N=T(null),z=T(null),B=T(null),A=T(null),H=T();function G(y){Y.hasError=!0,Y.errorMessage=y}function S(){L.value!=="root"?L.value="root":I("back")}function p(y){Y.isEditDialogVisible=y,w()}function w(){A.value=null,z.value=null,B.value=null}async function d(){b.createPlan=!0;try{const[y,m,U]=String(C.value).split("/").map(Number),ee=y*1e4+m*100+U,P=x.value.jy*1e4+x.value.jm*100+x.value.jd;if(ee<P){G("نمیتوان برای گذشته برنامه غذایی ثبت کرد.");return}const W={date:C.value,meal_id:N.value,food_id:z.value},se=await ne("/food/meal-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W),onResponseError({response:k}){var i,X;if((i=k._data)!=null&&i.errors){const s=Object.values(k._data.errors).flat().join(" | ");G(s||"خطا در ایجاد.")}else G(((X=k._data)==null?void 0:X.message)||"خطا در ایجاد")}});return await n(),se}catch(y){console.error("Error create plan:",y)}finally{b.createPlan=!1,z.value=null,N.value=null}}function o(y){const[m,U,ee]=String(C.value).split("/").map(Number),P=m*1e4+U*100+ee,W=x.value.jy*1e4+x.value.jm*100+x.value.jd;if(P<W){G("نمیتوان برنامه غذایی گذشته را ویرایش کرد."),Y.isEditDialogVisible=!1;return}A.value=y,B.value=y.food.id,Y.isEditDialogVisible=!0}async function V(){var ee;const y=await((ee=H.value)==null?void 0:ee.validate());if(!(y==null?void 0:y.valid))return;b.editPlan=!0;const U=new FormData;U.append("food_id",B.value),U.append("date",C.value);try{const W=(await ne(`/food/meal-plan/${A.value.id}`,{method:"POST",body:U,onResponseError({response:se}){var k,i;if((k=se._data)!=null&&k.errors){const X=Object.values(se._data.errors).flat().join(" | ");G(X||"خطا در ویرایش")}else G(((i=se._data)==null?void 0:i.message)||"خطا در ویرایش")}})).data;!Y.hasError&&W&&(Y.isEditDialogVisible=!1,w(),n())}catch(P){console.error(P)}finally{b.editPlan=!1}}async function n(){var m;f.value=[],b.fetchingPlans=!0;const y=C.value;try{const U=await ne("/food/meal-plan/get-for-date",{method:"GET",params:{date:y}});f.value=((m=U==null?void 0:U.data)==null?void 0:m.mealPlans)||[]}catch(U){console.error("Error fetching meal plans:",U)}finally{b.fetchingPlans=!1}}async function E(){b.fetchingMeals=!0;try{const y=await ne("/food/meal/get-actives",{method:"GET"});h.value=(y==null?void 0:y.data.meals)||[]}catch(y){console.error("Error fetching meals:",y),G(y.message||"خطا در دریافت وعده‌ها")}finally{b.fetchingMeals=!1}}async function _(){b.fetchingFoods=!0;try{const y=await ne("/food/food/get-actives",{method:"GET"});g.value=(y==null?void 0:y.data.foods)||[]}catch(y){console.error("Error fetching foods:",y),G(y.message||"خطا در دریافت غذاها")}finally{b.fetchingFoods=!1}}return Le(async()=>{await E(),await _();const y=new Date,m=Ge.toJalaali(y.getFullYear(),y.getMonth()+1,y.getDate());x.value=m,C.value=`${m.jy}/${m.jm}/${m.jd}`,await n()}),(y,m)=>{const U=Ke("PersianDatetimePicker"),ee=Re;return c(),R(Z,null,[t("div",null,[e(J,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:S},{default:l(()=>[u(r(a(L)==="root"?"آشپزخانه":"صفحه قبل"),1)]),_:1})]),e(ze,null,{default:l(()=>[e(ge,{modelValue:a(Y).hasError,"onUpdate:modelValue":m[0]||(m[0]=P=>a(Y).hasError=P),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:l(()=>[u(r(a(Y).errorMessage),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:a(Y).success,"onUpdate:modelValue":m[1]||(m[1]=P=>a(Y).success=P),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:l(()=>[u(r(a(Y).successMessage),1)]),_:1},8,["modelValue"]),e(K,{dense:""},{default:l(()=>[e($,{cols:"12",md:"4",class:"d-flex justify-center mb-4 mb-md-0"},{default:l(()=>[m[9]||(m[9]=t("input",{id:"custom-input",style:{display:"none"}},null,-1)),e(U,{modelValue:a(C),"onUpdate:modelValue":m[2]||(m[2]=P=>le(C)?C.value=P:null),format:"jYYYY/jMM/jDD",inline:"","custom-input":"#custom-input",onChange:n},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"8"},{default:l(()=>[e(de,{class:"mb-4"},{default:l(()=>[m[11]||(m[11]=t("label",{class:"font-weight-medium mb-2 mt-2 d-block text-center"}," برنامه غذایی ",-1)),e(K,{class:"mb-4 px-4"},{default:l(()=>[e($,{cols:"12",sm:"12",md:"12"},{default:l(()=>[e(ye,{modelValue:a(C),"onUpdate:modelValue":m[3]||(m[3]=P=>le(C)?C.value=P:null),label:"تاریخ",variant:"outlined",readonly:"",rules:["requiredValidator"in y?y.requiredValidator:a(fe)]},null,8,["modelValue","rules"])]),_:1}),e($,{cols:"12",md:"12"},{default:l(()=>[e(je,{modelValue:a(N),"onUpdate:modelValue":m[4]||(m[4]=P=>le(N)?N.value=P:null),items:a(h),"item-title":"name","item-value":"id",label:"وعده",variant:"outlined",clearable:"",rules:["requiredValidator"in y?y.requiredValidator:a(fe)]},null,8,["modelValue","items","rules"])]),_:1}),e($,{cols:"12",md:"12"},{default:l(()=>[e(je,{modelValue:a(z),"onUpdate:modelValue":m[5]||(m[5]=P=>le(z)?z.value=P:null),items:a(g),"item-title":"name","item-value":"id",label:"غذا",variant:"outlined",clearable:"",rules:["requiredValidator"in y?y.requiredValidator:a(fe)]},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(K,{justify:"center",class:"mb-4"},{default:l(()=>[e($,{cols:"auto"},{default:l(()=>[e(J,{color:"primary",onClick:d},{default:l(()=>[...m[10]||(m[10]=[u(" ثبت ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",it,[!a(b).fetchingPlans&&a(f).length>0?(c(),j(Ee,{key:0,variant:"accordion"},{default:l(()=>[e(Ce,null,{default:l(()=>[e(xe,{class:"font-weight-bold"},{default:l(()=>[...m[12]||(m[12]=[u(" برنامه غذایی تاریخ انتخاب شده ",-1)])]),_:1}),e(Fe,null,{default:l(()=>[e(Ee,{variant:"accordion"},{default:l(()=>[(c(!0),R(Z,null,re(a(f),(P,W)=>(c(),j(Ce,{key:W,class:"mb-2"},{default:l(()=>[e(xe,null,{default:l(()=>[t("div",dt,[t("span",null,r(P.meal.name),1),e(M,null,{default:l(()=>[u(r(P.food.name),1)]),_:2},1024)])]),_:2},1024),e(Fe,null,{default:l(()=>[t("div",ct,[t("div",null,[m[13]||(m[13]=t("strong",null,"ایجاد شده توسط:",-1)),u(" "+r(P.createdBy?`${P.createdBy.fullName} - ${P.createdBy.username}`:"—"),1)]),t("div",null,[m[14]||(m[14]=t("strong",null,"آخرین ویرایش توسط:",-1)),u(" "+r(P.editedBy?`${P.editedBy.fullName} - ${P.editedBy.username}`:"—"),1)]),t("div",ft,[e(J,{color:"orange",variant:"text",size:"small",onClick:se=>o(P)},{default:l(()=>[e(me,{icon:"tabler-edit",size:"20"})]),_:1},8,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):a(b).fetchingPlans?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",mt,[e(M,{color:"error"},{default:l(()=>[...m[15]||(m[15]=[u(" برنامه غذایی برای نمایش وجود ندارد ",-1)])]),_:1})]))])]),_:1})]),_:1})]),_:1}),e(he,{width:y.$vuetify.display.smAndDown?"auto":450,"model-value":a(Y).isEditDialogVisible,"onUpdate:modelValue":p},{default:l(()=>[e(ee,{onClick:m[6]||(m[6]=P=>p(!1))}),e(de,null,{default:l(()=>[e(we,null,{default:l(()=>[m[18]||(m[18]=t("h4",{class:"text-h5 text-center mb-2"}," ویرایش برنامه غذایی: ",-1)),e(Be,{ref_key:"refVForm",ref:H,class:"mt-6","validate-on":"submit lazy",onSubmit:Te(V,["prevent"])},{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(De,{disabled:a(b).editPlan},{default:l(()=>[e(je,{modelValue:a(B),"onUpdate:modelValue":m[7]||(m[7]=P=>le(B)?B.value=P:null),items:a(g),"item-title":"name","item-value":"id",label:"غذا",variant:"outlined",clearable:"",rules:["requiredValidator"in y?y.requiredValidator:a(fe)]},null,8,["modelValue","items","rules"])]),_:1},8,["disabled"])]),_:1}),e($,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(J,{type:"submit",disabled:a(b).editPlan,loading:a(b).editPlan},{default:l(()=>[...m[16]||(m[16]=[u(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),e(J,{color:"secondary",variant:"tonal",onClick:m[8]||(m[8]=P=>p(!1))},{default:l(()=>[...m[17]||(m[17]=[u(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])],64)}}},pt={class:"d-flex justify-end gap-3 mb-3"},yt={key:1},gt={key:1,class:"text-center"},bt={class:"text-h5 text-center mb-2"},_t={__name:"Meals",emits:["back"],async setup(D,{emit:ae}){let I,L;const Y=ae,b=T("root"),f=pe({hasError:!1,errorMessage:"",isCreateMealDialogVisible:!1,isEditMealDialogVisible:!1}),h=pe({fetchingMeals:!0,createMeal:!1,editMeal:!1}),g=T([]),C=T(null),x=T(),N=T(null);function z(){b.value!=="root"?b.value="root":Y("back")}async function B(){var n;const d=await((n=x.value)==null?void 0:n.validate());if(!(d==null?void 0:d.valid))return;h.createMeal=!0;const V=new FormData;V.append("name",N.value);try{await ne("/food/meal/",{method:"POST",body:V,onResponseError({response:E}){var _,y;if(f.hasError=!0,(_=E._data)!=null&&_.errors){const m=Object.values(E._data.errors).flat().join(" | ");f.errorMessage=m}else f.errorMessage=((y=E._data)==null?void 0:y.message)||"خطا در ایجاد"}}),f.hasError||(f.isCreateMealDialogVisible=!1,p(),S())}catch(E){console.error(E)}finally{h.createMeal=!1}}async function A(d){try{const V=(await ne(`/food/meal/status/${d.id}`,{method:"POST",onResponseError({response:n}){f.hasError=!0,f.errorMessage=n._data.message||"خطا در تغییر وضعیت"}})).data;!f.hasError&&V&&(g.value=g.value.map(n=>n.id===V.id?V:n),f.isEditMealDialogVisible=!1,p())}catch(o){console.error(o)}}function H(d){C.value=d,N.value=d.name,f.isEditMealDialogVisible=!0}async function G(){var n;const d=await((n=x.value)==null?void 0:n.validate());if(!(d==null?void 0:d.valid))return;h.editMeal=!0;const V=new FormData;V.append("name",N.value);try{const _=(await ne(`/food/meal/${C.value.id}`,{method:"POST",body:V,onResponseError({response:y}){var m,U;if(f.hasError=!0,(m=y._data)!=null&&m.errors){const ee=Object.values(y._data.errors).flat().join(" | ");f.errorMessage=ee}else f.errorMessage=((U=y._data)==null?void 0:U.message)||"خطا در ویرایش"}})).data;!f.hasError&&_&&(g.value=g.value.map(y=>y.id===_.id?_:y),f.isEditMealDialogVisible=!1,p())}catch(E){console.error(E)}finally{h.editMeal=!1}}async function S(){h.fetchingMeals=!0;try{const d=await ne("/food/meal/",{method:"GET"});g.value=(d==null?void 0:d.data.meals)||[]}catch(d){console.error("Error fetching meals:",d),f.hasError=!0,f.errorMessage=d.message||"خطا در دریافت وعده‌ها"}finally{h.fetchingMeals=!1}}[I,L]=Qe(()=>S()),await I,L();function p(){N.value=null}function w(d){d||(f.isCreateMealDialogVisible=!1,f.isEditMealDialogVisible=!1,p())}return(d,o)=>{const V=Re;return c(),R(Z,null,[e(ge,{modelValue:a(f).hasError,"onUpdate:modelValue":o[0]||(o[0]=n=>a(f).hasError=n),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:l(()=>[u(r(a(f).errorMessage),1)]),_:1},8,["modelValue"]),t("div",null,[e(J,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:z},{default:l(()=>[u(r(a(b)==="root"?"آشپزخانه":"صفحه قبل"),1)]),_:1})]),t("div",null,[t("div",pt,[e(J,{color:"primary",onClick:o[1]||(o[1]=n=>{a(f).isCreateMealDialogVisible=!0})},{default:l(()=>[e(me,{icon:"tabler-plus",size:"24",style:{cursor:"pointer"}})]),_:1})]),a(h).fetchingMeals?(c(),j(de,{key:0,class:"text-center"},{default:l(()=>[e(we,null,{default:l(()=>[e(ml,{indeterminate:"",color:"primary"})]),_:1})]),_:1})):(c(),R("div",yt,[a(g).length>0?(c(),j(ke,{key:0},{default:l(()=>[o[8]||(o[8]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"نام"),t("th",null,"وضعیت"),t("th",null,"ایجاد شده توسط"),t("th",null,"آخرین ویرایش توسط"),t("th",null,"عملیات")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(g),(n,E)=>(c(),R("tr",{key:n.id},[t("td",null,r(E+1),1),t("td",null,r(n.name),1),t("td",null,[e(M,{color:n.status?"success":"error",size:"small"},{default:l(()=>[u(r(n.status?"فعال":"غیرفعال"),1)]),_:2},1032,["color"])]),t("td",null,[e(M,null,{default:l(()=>[u(r(n.createdBy?`${n.createdBy.fullName} - ${n.createdBy.username}`:"—"),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(n.editedBy?`${n.editedBy.fullName} - ${n.editedBy.username}`:"—"),1)]),_:2},1024)]),t("td",null,[e(me,{icon:"tabler-power",color:n.status?"red":"green",size:"24",onClick:_=>A(n)},null,8,["color","onClick"]),e(me,{icon:"tabler-edit",color:"primary",size:"24",onClick:_=>H(n)},null,8,["onClick"])])]))),128))])]),_:1})):(c(),R("div",gt," وعده‌ای برای نمایش وجود ندارد "))]))]),e(he,{width:d.$vuetify.display.smAndDown?"auto":450,"model-value":a(f).isCreateMealDialogVisible,"onUpdate:modelValue":w},{default:l(()=>[e(V,{onClick:o[2]||(o[2]=n=>w(!1))}),e(de,null,{default:l(()=>[e(we,null,{default:l(()=>[o[11]||(o[11]=t("h4",{class:"text-h5 text-center mb-2"}," افزودن وعده ",-1)),e(Be,{ref_key:"refVForm",ref:x,class:"mt-6","validate-on":"submit lazy",onSubmit:Te(B,["prevent"])},{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(De,{disabled:a(h).createMeal},{default:l(()=>[e(ye,{modelValue:a(N),"onUpdate:modelValue":o[3]||(o[3]=n=>le(N)?N.value=n:null),rules:["requiredValidator"in d?d.requiredValidator:a(fe)],disabled:a(h).createMeal,simple:"",label:"نام"},null,8,["modelValue","rules","disabled"])]),_:1},8,["disabled"])]),_:1}),e($,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(J,{type:"submit",disabled:a(h).createMeal,loading:a(h).createMeal},{default:l(()=>[...o[9]||(o[9]=[u(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),e(J,{color:"secondary",variant:"tonal",onClick:o[4]||(o[4]=n=>w(!1))},{default:l(()=>[...o[10]||(o[10]=[u(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(he,{width:d.$vuetify.display.smAndDown?"auto":450,"model-value":a(f).isEditMealDialogVisible,"onUpdate:modelValue":w},{default:l(()=>[e(V,{onClick:o[5]||(o[5]=n=>w(!1))}),e(de,null,{default:l(()=>[e(we,null,{default:l(()=>{var n;return[t("h4",bt," ویرایش وعده: "+r((n=a(C))==null?void 0:n.name),1),e(Be,{ref_key:"refVForm",ref:x,class:"mt-6","validate-on":"submit lazy",onSubmit:Te(G,["prevent"])},{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",md:"12"},{default:l(()=>[e(De,{disabled:a(h).editMeal},{default:l(()=>[e(ye,{modelValue:a(N),"onUpdate:modelValue":o[6]||(o[6]=E=>le(N)?N.value=E:null),rules:["requiredValidator"in d?d.requiredValidator:a(fe)],disabled:a(h).editMeal,simple:"",label:"نام"},null,8,["modelValue","rules","disabled"])]),_:1},8,["disabled"])]),_:1}),e($,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(J,{type:"submit",disabled:a(h).editMeal,loading:a(h).editMeal},{default:l(()=>[...o[12]||(o[12]=[u(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),e(J,{color:"secondary",variant:"tonal",onClick:o[7]||(o[7]=E=>w(!1))},{default:l(()=>[...o[13]||(o[13]=[u(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1})]),_:1},8,["width","model-value"])],64)}}},Vt={class:"overflow-auto d-md-block"},kt={key:0,class:"text-center mb-4"},wt={key:1},ht={class:"py-2"},Mt={style:{"max-width":"420px","white-space":"normal","overflow-wrap":"anywhere"}},$t={key:2,class:"text-center"},Dt={style:{"white-space":"normal","overflow-wrap":"anywhere"}},Et={key:0},Ct={key:1},xt={__name:"Statistics",emits:["back"],setup(D,{emit:ae}){const I=ae,L=T("root");function Y(){L.value!=="root"?L.value="root":I("back")}const b=pe({success:!1,successMessage:"",hasError:!1,errorMessage:"",isDetailsDialogVisible:!1}),f=pe({fetchingReservedMeals:!1}),h=T([]),g=T(null),C=T(null);function x(S){b.hasError=!0,b.errorMessage=S}function N(S){b.isDetailsDialogVisible=S,S||(C.value=null)}function z(S){C.value=S,b.isDetailsDialogVisible=!0}async function B(){if(!g.value){x("تاریخ را انتخاب کنید.");return}if(!g.value[1]){x("تاریخ باید به صورت بازه‌ای باشد.");return}h.value=[],f.fetchingReservedMeals=!0;try{const S=await ne("/food/meal-reservation/get-in-date-range",{method:"GET",params:{"date[]":g.value}});h.value=((S==null?void 0:S.data)||[]).flat()}catch(S){console.error("Error fetching reserved meals:",S),x("خطا در دریافت رزروهای بازه")}finally{f.fetchingReservedMeals=!1}}const A=oe(()=>[...h.value].sort((S,p)=>{var w,d;return String(((w=S==null?void 0:S.meal)==null?void 0:w.name)||"").localeCompare(String(((d=p==null?void 0:p.meal)==null?void 0:d.name)||""))})),H=oe(()=>{var p,w;const S={};for(const d of h.value){const o=((p=d.meal)==null?void 0:p.name)||"نامشخص",V=((w=d.details)==null?void 0:w.reduce((n,E)=>n+(E.quantity||0),0))||0;S[o]||(S[o]=0),S[o]+=V}return Object.entries(S).map(([d,o])=>({name:d,total:o}))}),G=oe(()=>{var p,w;const S={};for(const d of h.value){const o=`${((p=d.meal)==null?void 0:p.name)||"نامشخص"} تحویل نشده`,V=((w=d.details)==null?void 0:w.reduce((n,E)=>n+(E.delivery_status?0:E.quantity||0),0))??0;S[o]||(S[o]=0),S[o]+=V}return Object.entries(S).map(([d,o])=>({name:d,total:o}))});return(S,p)=>{const w=Ke("PersianDatetimePicker"),d=Re;return c(),R(Z,null,[t("div",null,[e(J,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:Y},{default:l(()=>[u(r(a(L)==="root"?"آشپزخانه":"صفحه قبل"),1)]),_:1})]),e(ge,{modelValue:a(b).hasError,"onUpdate:modelValue":p[0]||(p[0]=o=>a(b).hasError=o),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:l(()=>[u(r(a(b).errorMessage),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:a(b).success,"onUpdate:modelValue":p[1]||(p[1]=o=>a(b).success=o),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:l(()=>[u(r(a(b).successMessage),1)]),_:1},8,["modelValue"]),e(K,{dense:""},{default:l(()=>[e($,null,{default:l(()=>[e($,{class:"d-flex justify-center"},{default:l(()=>[e(w,{modelValue:a(g),"onUpdate:modelValue":p[2]||(p[2]=o=>le(g)?g.value=o:null),format:"jYYYY/jMM/jDD",range:""},null,8,["modelValue"])]),_:1}),e($,{class:"d-flex justify-center"},{default:l(()=>[e(J,{color:"primary",loading:a(f).fetchingReservedMeals,disabled:a(f).fetchingReservedMeals,onClick:B},{default:l(()=>[...p[4]||(p[4]=[u(" جستجو ",-1)])]),_:1},8,["loading","disabled"])]),_:1}),t("div",Vt,[!a(f).fetchingReservedMeals&&a(A).length>0?(c(),j($,{key:0,cols:"12",md:"12"},{default:l(()=>[p[6]||(p[6]=t("label",{class:"font-weight-medium mb-4 d-block text-center"}," رزروهای بازه ",-1)),a(A).length?(c(),R("div",kt,[(c(!0),R(Z,null,re(a(H),o=>(c(),j(M,{key:o.name,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:l(()=>[u(r(o.name)+": "+r(o.total),1)]),_:2},1024))),128)),(c(!0),R(Z,null,re(a(G),o=>(c(),j(M,{key:o.name,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:l(()=>[u(r(o.name)+": "+r(o.total),1)]),_:2},1024))),128))])):Q("",!0),e(ke,null,{default:l(()=>[p[5]||(p[5]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"وعده"),t("th",null,"رزرو کننده"),t("th",null,"کد پرسنلی"),t("th",null,"تاریخ"),t("th",null,"کد تحویل"),t("th",null,"نوع رزرو"),t("th",null,"وضعیت"),t("th",null,"پیمانکار"),t("th",null,"تعداد"),t("th",null,"توضیحات"),t("th",null,"جزئیات")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(A),(o,V)=>{var n,E,_,y,m;return c(),R("tr",{key:o.id},[t("td",null,r(V+1),1),t("td",null,r((n=o.meal)==null?void 0:n.name),1),t("td",null,[e(M,{color:"primary"},{default:l(()=>[u(r(o.created_by?`${o.created_by.first_name} ${o.created_by.last_name}`:"—"),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(o.created_by?`${o.created_by.personnel_code}`:"—"),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(o.date),1)]),_:2},1024)]),t("td",null,[e(M,{color:"success"},{default:l(()=>[u(r(o.delivery_code),1)]),_:2},1024)]),t("td",null,[e(M,{color:"orange"},{default:l(()=>[u(r({personnel:"پرسنل",contractor:"پیمانکار",guest:"مهمان"}[o.reserve_type]||""),1)]),_:2},1024)]),t("td",null,[e(M,{color:o.status?"success":"error",size:"small"},{default:l(()=>[u(r(o.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])]),t("td",null,[(_=(E=o.details)==null?void 0:E[0])!=null&&_.contractor?(c(),j(M,{key:0},{default:l(()=>[u(r(`${o.details[0].contractor.first_name} ${o.details[0].contractor.last_name}`),1)]),_:2},1024)):(c(),R("span",wt,"—"))]),t("td",null,r((y=o.details)==null?void 0:y.reduce((U,ee)=>U+(ee.quantity||0),0)),1),t("td",ht,[e(el,{location:"top",disabled:!(((m=o.description)==null?void 0:m.length)>6)},{activator:l(({props:U})=>[t("div",Je({ref_for:!0},U,{class:"text-truncate",style:{"max-width":"120px"}}),r(o.description||"—"),17)]),default:l(()=>[t("div",Mt,r(o.description),1)]),_:2},1032,["disabled"])]),t("td",null,[e(J,{color:"primary",variant:"text",size:"small",onClick:U=>z(o)},{default:l(()=>[e(me,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])}),128))])]),_:1})]),_:1})):a(f).fetchingReservedMeals?(c(),j(Me,{key:1,type:"card"})):(c(),R("div",$t,[e(M,{color:"error"},{default:l(()=>[...p[7]||(p[7]=[u(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))])]),_:1})]),_:1}),a(C)?(c(),j(he,{key:0,width:S.$vuetify.display.smAndDown?"auto":900,"model-value":a(b).isDetailsDialogVisible,"onUpdate:modelValue":N},{default:l(()=>[e(d,{onClick:p[3]||(p[3]=o=>N(!1))}),e(de,null,{default:l(()=>[e(He,{class:"text-h6"},{default:l(()=>[...p[8]||(p[8]=[u(" جزئیات ",-1)])]),_:1}),e(we,null,{default:l(()=>[e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[9]||(p[9]=t("strong",null,"رزرو کننده:",-1)),e(M,{color:"orange",size:"small"},{default:l(()=>[u(r(a(C).created_by?`${a(C).created_by.first_name} ${a(C).created_by.last_name}`:"—"),1)]),_:1})])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[10]||(p[10]=t("strong",null,"کد پرسنلی:",-1)),e(M,{color:"orange",size:"small"},{default:l(()=>[u(r(a(C).created_by?`${a(C).created_by.personnel_code}`:"—"),1)]),_:1})])]),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>{var o,V;return[e($,{cols:"12",sm:"6"},{default:l(()=>[p[11]||(p[11]=t("strong",null,"کد تحویل:",-1)),e(M,{color:"primary",size:"small"},{default:l(()=>[u(r(a(C).delivery_code),1)]),_:1})]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[12]||(p[12]=t("strong",null,"وعده:",-1)),e(M,{color:"primary",size:"small"},{default:l(()=>{var n;return[u(r((n=a(C).meal)==null?void 0:n.name),1)]}),_:1})])]),_:1}),e(te,{class:"my-3"}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[13]||(p[13]=t("strong",null,"نوع رزرو:",-1)),e(M,null,{default:l(()=>[u(r({personnel:"پرسنل",contractor:"پیمانکار",guest:"مهمان"}[a(C).reserve_type]||""),1)]),_:1})])]),_:1}),(V=(o=a(C).details)==null?void 0:o[0])!=null&&V.contractor?(c(),j($,{key:0,cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[14]||(p[14]=t("strong",null,"پیمانکار:",-1)),e(M,null,{default:l(()=>[u(r(`${a(C).details[0].contractor.first_name} ${a(C).details[0].contractor.last_name}`),1)]),_:1})])]),_:1})):Q("",!0),a(C).reserve_type==="guest"?(c(),j($,{key:1,cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[15]||(p[15]=t("strong",null,"نوع سرو:",-1)),e(M,null,{default:l(()=>[u(r({serve_in_kitchen:"سرو در آشپزخانه",deliver:"تحویل"}[a(C).serve_place]||""),1)]),_:1})])]),_:1})):Q("",!0)]}),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[16]||(p[16]=t("strong",null,"وضعیت:",-1)),e(M,{color:a(C).status?"success":"error",size:"small"},{default:l(()=>[u(r(a(C).status?"تحویل شده":"تحویل نشده"),1)]),_:1},8,["color"])])]),_:1}),e($,{cols:"12",sm:"6"},{default:l(()=>[t("p",null,[p[17]||(p[17]=t("strong",null,"تعداد:",-1)),e(M,{size:"small"},{default:l(()=>{var o;return[u(r((o=a(C).details)==null?void 0:o.reduce((V,n)=>V+(n.quantity||0),0)),1)]}),_:1})])]),_:1})]),_:1}),e(te,{class:"my-3"}),e(K,null,{default:l(()=>[a(C).description?(c(),j($,{key:0,cols:"12",sm:"12"},{default:l(()=>[t("p",Dt,[p[18]||(p[18]=t("strong",null,"توضیحات:",-1)),u(" "+r(a(C).description),1)])]),_:1})):Q("",!0)]),_:1}),e(te,{class:"my-3"}),a(C).reserve_type==="personnel"?(c(),R("div",Et,[e(ke,{density:"comfortable"},{default:l(()=>[p[19]||(p[19]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"نام"),t("th",null,"کد پرسنلی"),t("th",null,"وضعیت")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re((a(C).details||[]).filter(o=>o.personnel),(o,V)=>(c(),R("tr",{key:o.id},[t("td",null,r(V+1),1),t("td",null,r(`${o.personnel.first_name} ${o.personnel.last_name}`),1),t("td",null,r(o.personnel.personnel_code),1),t("td",null,[e(M,{color:o.delivery_status?"success":"error",size:"small"},{default:l(()=>[u(r(o.delivery_status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])])]))),128))])]),_:1})])):Q("",!0),a(C).reserve_type==="contractor"?(c(),R("div",Ct,[e(ke,{density:"comfortable"},{default:l(()=>[p[20]||(p[20]=t("thead",null,[t("tr",null,[t("th",null,"ردیف"),t("th",null,"غذا"),t("th",null,"قیمت"),t("th",null,"تعداد"),t("th",null,"مبلغ کل")])],-1)),t("tbody",null,[(c(!0),R(Z,null,re(a(C).details,(o,V)=>(c(),R("tr",{key:o.id},[t("td",null,r(V+1),1),t("td",null,[e(M,null,{default:l(()=>{var n;return[u(r((n=o.food)==null?void 0:n.name),1)]}),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(Number(o.food_price||0).toLocaleString("fa-IR"))+" ریال ",1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(o.quantity),1)]),_:2},1024)]),t("td",null,[e(M,null,{default:l(()=>[u(r(Number((o.quantity||0)*(o.food_price||0)).toLocaleString("fa-IR"))+" ریال ",1)]),_:2},1024)])]))),128))])]),_:1})])):Q("",!0),a(C).reserve_type!=="guest"&&a(C).reserve_type==="contractor"&&!a(C).status?(c(),j(te,{key:2,class:"my-3"})):Q("",!0)]),_:1})]),_:1})]),_:1},8,["width","model-value"])):Q("",!0)],64)}}},Ft={key:0},Rt={class:"font-weight-medium"},va={__name:"kitchen",setup(D){const ae=T("root"),I=[{key:"foods",label:"غذاها",icon:"tabler-meat"},{key:"meals",label:"وعده‌های غذایی",icon:"tabler-bowl-chopsticks"},{key:"mealPlan",label:"برنامه غذایی",icon:"tabler-calendar-time"},{key:"statistics",label:"آمار",icon:"tabler-report-analytics"},{key:"contractorInvoice",label:"حساب پیمانکار",icon:"tabler-cash-register"},{key:"delivery",label:"تحویل غذا",icon:"tabler-checklist"}],L={foods:ut,mealPlan:vt,meals:_t,statistics:xt,contractorInvoice:xl,delivery:tt};function Y(){ae.value="root"}function b(f){ae.value=f}return(f,h)=>(c(),j(ze,null,{default:l(()=>[a(ae)==="root"?(c(),R("div",Ft,[e(K,null,{default:l(()=>[(c(),R(Z,null,re(I,g=>e($,{key:g.key,cols:"6",sm:"4",md:"3",class:"text-center"},{default:l(()=>[e(de,{class:"pa-4 d-flex flex-column align-center justify-center",variant:"outlined",rounded:"xl",onClick:C=>b(g.key)},{default:l(()=>[e(vl,{variant:"tonal",color:"primary",size:"56",class:"mb-2"},{default:l(()=>[e(me,{icon:g.icon,size:"32"},null,8,["icon"])]),_:2},1024),t("span",Rt,r(g.label),1)]),_:2},1032,["onClick"])]),_:2},1024)),64))]),_:1})])):Q("",!0),(c(),j(pl(L[a(ae)]),{onBack:Y},null,32))]),_:1}))}};export{va as default};
