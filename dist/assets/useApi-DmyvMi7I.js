import{bs as t,cI as o,cJ as u,cK as c}from"./index-a9pqUyha.js";const n=async()=>{t("accessToken").value=null;const e=t("userData");e.value.role.includes("supplier")?await o.replace({path:"/login-supplier",query:{isRedirectedFromUnauthorizedStatus:!0}}):await o.replace({path:"/login",query:{isRedirectedFromUnauthorizedStatus:!0}}),e.value=null,t("userAbilityRules").value=null},p=u({baseUrl:"http://172.16.20.20:8000/api",fetchOptions:{headers:{Accept:"application/json"}},options:{refetch:!0,async beforeFetch({url:e,options:r}){r.skipBaseUrl&&(console.log(e),e=e.replace("/api",""),console.log(e));const a=t("accessToken").value;return a&&(r.headers={...r.headers,Authorization:`Bearer ${a}`}),{url:e,options:r}},afterFetch(e){const{data:r,response:a}=e;let s=null;try{s=c(r)}catch(l){console.error(l)}return{data:s,response:a}},onFetchError(e){e.response.status===401&&n();let r=null;try{r=c(e.data)}catch(a){console.error(a)}return{error:r}}}});export{p as u};
