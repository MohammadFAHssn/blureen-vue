import{r as ce}from"./validators-Di2wQwF6.js";import{an as he,a2 as Pe,aw as Se,Y as F,r as f,a3 as Ie,bu as ke,G as Ce,w as z,br as Te,a7 as Re,aV as Fe,b as t,q as ee,bd as te,a5 as Ae,a4 as $e,F as D,J as fe,as as Me,c2 as Ue,c3 as De,bL as me,bM as Ee,c as G,o as x,f as U,l as oe,m as u,bN as Ne,h as ne,e as o,z as ze,bO as ve,bP as pe,x as qe,i as He,j as Oe,bq as Ge,ax as Le,t as p,v as y,b8 as q,d as H,c4 as Qe,be as je,ah as Je,$ as Ye}from"./index-Bwo3LNbU.js";import{u as Ke,V as re}from"./form-DoP2fANy.js";import{a as We}from"./VTextField-_E_SjZFX.js";import{f as Xe,m as Ze,V as Be}from"./VField-t8sjx1wT.js";import{V as Ve,m as et}from"./VInput-SiJlULSE.js";import{f as tt}from"./VOverlay-CX91BE1x.js";import{I as at}from"./VImg-BKkTILP-.js";import{_ as lt}from"./AppTextField-CvRPhb52.js";import{$ as ot}from"./api-XbpOCLGR.js";import{u as nt}from"./useApi-BNOERmIl.js";import{c as rt}from"./createUrl-B8e5hmkY.js";import{_ as ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as xe}from"./VSnackbar-CGPlVRl0.js";import{V as T}from"./VCol-CaAMatF7.js";import{V as O}from"./VRow-CqdgLvAy.js";import{V as st,a as it,b as dt,d as ct}from"./VList-DjjrImmv.js";import{V as ae}from"./VChip-KS_aLV_i.js";import{V as ft}from"./VAvatar-BbGo5mhe.js";import{V as le,a as mt,b as vt}from"./VCard-DK-Gg7a8.js";import{V as R}from"./VCardText-lIFuymEc.js";import{a as be,V as Y}from"./VRadioGroup-C0GQnwee.js";import{V as pt}from"./VDivider-DzLyHNgd.js";import{V as Vt}from"./VForm-ByMJRwDj.js";import"./transition-CvZPFvR4.js";import"./index-9rIf2CJL.js";/* empty css              */import"./createSimpleFunctional-Cv6ugRl0.js";import"./VSelectionControl-BXI-YssQ.js";const xt=Pe({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...et(),...Ze()},"VTextarea"),bt=he()({name:"VTextarea",directives:{Intersect:at},inheritAttrs:!1,props:xt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,_){let{attrs:w,emit:b,slots:c}=_;const d=Se(e,"modelValue"),{isFocused:m,focus:S,blur:A}=Ke(e),$=F(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value||"").toString().length),L=F(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function E(n,i){var a,s;!e.autofocus||!n||(s=(a=i[0].target)==null?void 0:a.focus)==null||s.call(a)}const N=f(),V=f(),I=Ie(""),h=f(),Q=F(()=>e.persistentPlaceholder||m.value||e.active);function k(){var n;h.value!==document.activeElement&&((n=h.value)==null||n.focus()),m.value||S()}function j(n){k(),b("click:control",n)}function K(n){b("mousedown:control",n)}function W(n){n.stopPropagation(),k(),te(()=>{d.value="",De(e["onClick:clear"],n)})}function X(n){var a;const i=n.target;if(d.value=i.value,(a=e.modelModifiers)!=null&&a.trim){const s=[i.selectionStart,i.selectionEnd];te(()=>{i.selectionStart=s[0],i.selectionEnd=s[1]})}}const v=f(),C=f(+e.rows),g=F(()=>["plain","underlined"].includes(e.variant));ke(()=>{e.autoGrow||(C.value=+e.rows)});function r(){e.autoGrow&&te(()=>{if(!v.value||!V.value)return;const n=getComputedStyle(v.value),i=getComputedStyle(V.value.$el),a=parseFloat(n.getPropertyValue("--v-field-padding-top"))+parseFloat(n.getPropertyValue("--v-input-padding-top"))+parseFloat(n.getPropertyValue("--v-field-padding-bottom")),s=v.value.scrollHeight,M=parseFloat(n.lineHeight),Z=Math.max(parseFloat(e.rows)*M+a,parseFloat(i.getPropertyValue("--v-input-control-height"))),B=parseFloat(e.maxRows)*M+a||1/0,P=$e(s??0,Z,B);C.value=Math.floor((P-a)/M),I.value=Ae(P)})}Ce(r),z(d,r),z(()=>e.rows,r),z(()=>e.maxRows,r),z(()=>e.density,r);let l;return z(v,n=>{n?(l=new ResizeObserver(r),l.observe(v.value)):l==null||l.disconnect()}),Te(()=>{l==null||l.disconnect()}),Re(()=>{const n=!!(c.counter||e.counter||e.counterValue),i=!!(n||c.details),[a,s]=Fe(w),{modelValue:M,...Z}=Ve.filterProps(e),B=Xe(e);return t(Ve,ee({ref:N,modelValue:d.value,"onUpdate:modelValue":P=>d.value=P,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":g.value},e.class],style:e.style},a,Z,{centerAffix:C.value===1&&!g.value,focused:m.value}),{...c,default:P=>{let{id:J,isDisabled:ue,isDirty:se,isReadonly:ge,isValid:ye}=P;return t(Be,ee({ref:V,style:{"--v-textarea-control-height":I.value},onClick:j,onMousedown:K,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},B,{id:J.value,active:Q.value||se.value,centerAffix:C.value===1&&!g.value,dirty:se.value||e.dirty,disabled:ue.value,focused:m.value,error:ye.value===!1}),{...c,default:_e=>{let{props:{class:ie,...de}}=_e;return t(D,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),fe(t("textarea",ee({ref:h,class:ie,value:d.value,onInput:X,autofocus:e.autofocus,readonly:ge.value,disabled:ue.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:k,onBlur:A},de,s),null),[[Me("intersect"),{handler:E},null,{once:!0}]]),e.autoGrow&&fe(t("textarea",{class:[ie,"v-textarea__sizer"],id:`${de.id}-sizer`,"onUpdate:modelValue":we=>d.value=we,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Ue,d.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:i?P=>{var J;return t(D,null,[(J=c.details)==null?void 0:J.call(c,P),n&&t(D,null,[t("span",null,null),t(We,{active:e.persistentCounter||m.value,value:$.value,max:L.value,disabled:e.disabled},c.counter)])])}:void 0})}),tt({},N,V,h)}}),gt=Object.assign({name:"AppTextarea",inheritAttrs:!1},{__name:"AppTextarea",setup(e){const _=F(()=>{const c=me().id,d=Ee();return c?`app-textarea-${c}`:d}),w=F(()=>me().label);return(b,c)=>(x(),G("div",{class:qe(["app-textarea flex-grow-1",b.$attrs.class])},[u(w)?(x(),U(re,{key:0,for:u(_),class:"mb-1 text-body-2",text:u(w)},null,8,["for","text"])):oe("",!0),t(bt,ve(pe({...b.$attrs,class:null,label:void 0,variant:"outlined",id:u(_)})),Ne({_:2},[ne(b.$slots,(d,m)=>({name:m,fn:o(S=>[ze(b.$slots,m,ve(pe(S||{})))])}))]),1040)],2))}}),yt={key:0,class:"layout-page-content"},_t={class:"text-wrap mb-2"},wt={class:"text-h6"},ht={__name:"[token]",async setup(e){let _,w;const b=He(),c=Oe(),d="http://172.16.15.70:8000/api",m=f(!1),S=f(""),A=f(!1),$=f(0);let L,E;const N=f([]),V=f("cash"),I=f(""),h=f("taxInvoice"),Q=f([]),k=f([]);let j=null;const K=()=>{$.value=Math.max(0,L.tenderExpiresAt-Math.floor(Date.now()/1e3)),j=setInterval(()=>{$.value-=1,$.value===0&&c.replace({name:"login-supplier"})},1e3)},W=(r,l)=>{if(l<=1)return"success";const n=r/(l-1),i=Math.round(255*n),a=Math.round(255*(1-n));return`#${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}00`},X=async r=>{if(!(!r.bidPrice&&!r.bidQuantity)){k.value[r.id]=!0;try{await ot(`${d}/tenderDetail/store-supplier-bids`,{method:"POST",body:{id:r.id,bid_price:r.bidPrice,bid_quantity:r.bidQuantity,bid_description:r.bidDescription||"",payment_terms:V.value,payment_terms_description:V.value==="credit"?I.value:"",invoice_type:h.value},onResponseError({response:l}){m.value=!0,S.value=l._data.message||"خطا در ارسال پیشنهاد."}}),Q.value[r.id]=!0,A.value=!0}catch(l){console.error(l)}finally{k.value[r.id]=!1}}},{data:v,error:C}=([_,w]=Ge(()=>nt(rt(`${d}/tenderDetail/get-by-token?token=${b.params.token}`))),_=await _,w(),_);C.value&&(m.value=!0,S.value=C.value.message||"خطا در دریافت اطلاعات مناقصه.",setTimeout(()=>{c.replace({name:"login-supplier"})},2e3)),v.value&&(L=v.value.data,E={id:v.value.data.supplier.id,name:v.value.data.supplier.name},N.value=v.value.data.tenderBids||[],K());const g=F(()=>{const r=$.value,l=Math.floor(r/86400),n=Math.floor(r%86400/3600),i=Math.floor(r%3600/60),a=r%60;return{days:l,hours:n.toString().padStart(2,"0"),minutes:i.toString().padStart(2,"0"),seconds:a.toString().padStart(2,"0")}});return Le(()=>{clearInterval(j)}),(r,l)=>{const n=lt,i=gt;return x(),G(D,null,[t(xe,{modelValue:u(m),"onUpdate:modelValue":l[0]||(l[0]=a=>q(m)?m.value=a:null),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:o(()=>[p(y(u(S))+" ، در حال انتقال به پنل تأمین‌کننده ... ",1)]),_:1},8,["modelValue"]),t(xe,{modelValue:u(A),"onUpdate:modelValue":l[1]||(l[1]=a=>q(A)?A.value=a:null),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:o(()=>l[5]||(l[5]=[p(" ارسال شد ")])),_:1},8,["modelValue"]),u(v)?(x(),G("main",yt,[H("div",null,[t(O,null,{default:o(()=>[t(T,null,{default:o(()=>[H("div",_t,[l[6]||(l[6]=p(" مدیریت محترم شرکت/فروشگاه ")),H("span",wt,y(u(E).name),1)]),l[7]||(l[7]=H("div",{class:"text-wrap text-body-1"}," لیست کالاهای مورد نیاز مجموعه کارخانجات شیشه اردکان به شرح زیر می‌باشد. ",-1)),l[8]||(l[8]=H("div",{class:"text-wrap text-body-1"}," لطفاً قیمت‌های پیشنهادی خود را ارائه دهید. ",-1))]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(st,{style:{"background-color":"rgb(var(--v-theme-background))"}},{default:o(()=>[t(it,null,{prepend:o(()=>[t(ft,{color:"warning",variant:"tonal",rounded:"",icon:"tabler-stopwatch"})]),default:o(()=>[t(dt,{class:"font-weight-medium"},{default:o(()=>l[9]||(l[9]=[p(" مدت زمان باقی‌مانده تا پایان مناقصه: ")])),_:1}),t(ct,{class:"text-wrap text-body-1"},{default:o(()=>[u(g).days>0?(x(),U(ae,{key:0},{default:o(()=>[p(y(u(g).days)+" روز و "+y(u(g).hours)+" ساعت ",1)]),_:1})):(x(),U(ae,{key:1},{default:o(()=>[p(y(u(g).hours)+":"+y(u(g).minutes)+":"+y(u(g).seconds),1)]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(T,{cols:"12",md:"6",lg:"4"},{default:o(()=>[t(le,null,{default:o(()=>[t(R,{class:"custom-v-card-text"},{default:o(()=>[t(re,{class:"mb-2"},{default:o(()=>l[10]||(l[10]=[p(" شرایط پرداخت ")])),_:1}),t(be,{modelValue:u(V),"onUpdate:modelValue":l[2]||(l[2]=a=>q(V)?V.value=a:null),inline:""},{default:o(()=>[t(Y,{label:"نقدی",value:"cash"}),t(Y,{label:"شرایطی",value:"credit"})]),_:1},8,["modelValue"]),u(V)==="credit"?(x(),U(n,{key:0,modelValue:u(I),"onUpdate:modelValue":l[3]||(l[3]=a=>q(I)?I.value=a:null),type:"text",placeholder:"توضیحات"},null,8,["modelValue"])):oe("",!0)]),_:1}),t(pt),t(R,{class:"custom-v-card-text"},{default:o(()=>[t(re,{class:"mb-2"},{default:o(()=>l[11]||(l[11]=[p(" نوع فاکتور ")])),_:1}),t(be,{modelValue:u(h),"onUpdate:modelValue":l[4]||(l[4]=a=>q(h)?h.value=a:null),inline:""},{default:o(()=>[t(Y,{label:"فاکتور رسمی",value:"taxInvoice"}),t(Y,{label:"فاکتور فروشگاهی",value:"commercialInvoice"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(Qe,{group:""},{default:o(()=>[(x(!0),G(D,null,ne(u(N).filter(a=>!u(Q)[a.id]),a=>(x(),U(T,{key:a.id,cols:"12",md:"6",lg:"4"},{default:o(()=>[t(le,null,{default:o(()=>[t(mt,null,{default:o(()=>[t(vt,{class:"custom-v-card-title"},{default:o(()=>[p(y(a.tenderProduct.product.name+(a.tenderProduct.brand?` (${a.tenderProduct.brand.name})`:"")),1)]),_:2},1024)]),_:2},1024),t(R,null,{default:o(()=>[p(y(a.tenderProduct.purchaseExpertDescription),1)]),_:2},1024),t(R,null,{default:o(()=>[t(le,{variant:"outlined"},{default:o(()=>[t(R,null,{default:o(()=>l[12]||(l[12]=[p(" قیمت‌های پیشنهادی از سایر تأمین‌کنندگان (ریال): ")])),_:1}),t(R,{class:"d-flex flex-wrap gap-x-4 gap-y-2"},{default:o(()=>[(x(!0),G(D,null,ne(a.bidOfOtherSuppliers,(s,M)=>(x(),U(ae,{key:s.supplierId,variant:s.supplierId===u(E).id?"flat":"outlined",color:W(M,a.bidOfOtherSuppliers.length)},{default:o(()=>[p(y(s.bidPrice),1)]),_:2},1032,["variant","color"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(R,null,{default:o(()=>[t(Vt,{"validate-on":"submit lazy",onSubmit:je(s=>X(a),["prevent"])},{default:o(()=>[t(O,null,{default:o(()=>[t(T,{cols:"12"},{default:o(()=>[t(n,{modelValue:a.bidPrice,"onUpdate:modelValue":s=>a.bidPrice=s,label:"قیمت",type:"number","prepend-inner-icon":"tabler-coin",suffix:"ریال",rules:["requiredValidator"in r?r.requiredValidator:u(ce)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),t(T,{cols:"12"},{default:o(()=>[t(n,{modelValue:a.bidQuantity,"onUpdate:modelValue":s=>a.bidQuantity=s,label:"تعداد",type:"number","prepend-inner-icon":"tabler-scale",suffix:a.tenderProduct.product.counting_unit.UntName,placeholder:`مقدار مورد نیاز: ${a.tenderProduct.quantityRequired}`,rules:["requiredValidator"in r?r.requiredValidator:u(ce)]},null,8,["modelValue","onUpdate:modelValue","suffix","placeholder","rules"])]),_:2},1024),t(T,{cols:"12"},{default:o(()=>[t(i,{modelValue:a.bidDescription,"onUpdate:modelValue":s=>a.bidDescription=s,label:"توضیحات",rows:"3"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(T,{cols:"12"},{default:o(()=>[t(Je,{type:"submit",loading:u(k)[a.id]},{default:o(()=>[t(Ye,{icon:"tabler-send"}),l[13]||(l[13]=p(" ارسال "))]),_:2},1032,["loading"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):oe("",!0)],64)}}},Bt=ut(ht,[["__scopeId","data-v-4f6cdd4d"]]);export{Bt as default};
