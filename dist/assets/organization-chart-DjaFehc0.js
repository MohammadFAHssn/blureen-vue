import{_ as vi}from"./AreYouSureDialog-BaBmVS21.js";import{r as Jt}from"./validators-BQd4MaJQ.js";import{ax as yi,a6 as xi,al as _i,r as W,a7 as Lt,aA as wi,da as bi,aF as Yn,bX as Ci,aq as Ei,Z as ki,Y as ct,aw as Pt,w as Bt,aS as Hn,cK as $i,ab as Si,b as D,d as vt,a1 as Yt,dg as Ai,F as It,s as gt,bB as bn,a2 as De,df as Mi,J as Bi,y as Di,b3 as Ni,v as yt,aJ as zi,bg as Fi,bT as Ti,dd as qn,dm as Ri,a as xr,f as ue,o as kt,e as O,n as V,am as Nt,bJ as Ne,c as ce,bC as _r,bv as Rt,i as wr,x as he,M as Ii,bl as Vi,bN as Li,H as Oi}from"./index-BjDbercT.js";import{_ as Cn}from"./DialogCloseBtn-BX6Q5C0A.js";import{u as Pi}from"./useAGGridTheme-xF0dHTm9.js";import{V as Ht}from"./VRow-LLRdI7I1.js";import{V as _t}from"./VCol-qg2p72EP.js";import{V as En,b as Xi,c as Ui}from"./VCard-DLNXAE8v.js";import{V as kn}from"./VCardText-DJrV3pWu.js";import{V as $n}from"./VDialog-TeVeCvfX.js";import{V as br}from"./VForm-myuYE_Xh.js";import{V as ze}from"./VAutocomplete-BX7wHsRn.js";import{u as Yi,a as Hi,b as qi,m as Wi}from"./VSelect-CCgusMfv.js";import{V as rn,m as Gi}from"./VTextField-DDgrD6FV.js";import{u as Ki,h as Ji,m as ji}from"./filter-BTJ1fk7S.js";import{e as Zi,t as re,V as Qi,a as Fe,c as ta}from"./VList-CrR_CGaz.js";import{V as ea}from"./VMenu-BFNRgxw0.js";import{V as na}from"./VDivider-CY0uTSDO.js";import{V as ra}from"./VCheckboxBtn-CNmYAWcl.js";import{O as ia}from"./constants-CqCubtRl.js";import{a as ie}from"./axios-_S5Q2dDc.js";import{V as aa}from"./VSnackbar-CHSK6Bj4.js";import"./helpers-CcX6MmOA.js";/* empty css              */import"./createSimpleFunctional-BP7hpzsR.js";import"./VOverlay-BlrRlgQ7.js";import"./dialog-transition-BfqVmbQh.js";import"./autofocus-CNqWoOyb.js";import"./VCounter-fhqYYHf9.js";import"./VField-Bu2nJgTa.js";import"./useLogout-kPLI9xuP.js";const oa=xi({alwaysFilter:Boolean,autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...ji({filterKeys:["title"]}),...Wi({hideNoData:!0,returnObject:!0}),...Fi(Gi({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VCombobox"),Cr=yi()({name:"VCombobox",props:oa(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:search":t=>!0,"update:menu":t=>!0},setup(t,n){var Ln;let{emit:e,slots:r}=n;const{t:i}=_i(),a=W(),s=Lt(!1),o=Lt(!0),c=Lt(!1),l=W(),u=W(),h=Lt(-1);let d=!1;const{items:g,transformIn:v,transformOut:y}=Zi(t),{textColorClasses:S,textColorStyles:C}=wi(()=>{var $;return($=a.value)==null?void 0:$.color}),{InputIcon:z}=bi(t),A=Yn(t,"modelValue",[],$=>v(Ci($)),$=>{const X=y($);return t.multiple?X:X[0]??null}),w=Ei(t),I=ki(()=>t.closableChips&&!w.isReadonly.value&&!w.isDisabled.value),L=ct(()=>!!(t.chips||r.chip)),x=ct(()=>L.value||!!r.selection),_=Lt(!t.multiple&&!x.value?((Ln=A.value[0])==null?void 0:Ln.title)??"":""),F=Lt(null),E=ct({get:()=>_.value,set:async $=>{var X;if(_.value=$??"",$===null||$===""&&!t.multiple&&!x.value?A.value=[]:!t.multiple&&!x.value&&(A.value=[re(t,$)],Pt(()=>{var Z;return(Z=u.value)==null?void 0:Z.scrollToIndex(0)})),$&&t.multiple&&((X=t.delimiters)!=null&&X.length)){const Z=In($);Z.length>1&&(Vn(Z),_.value="")}$||(h.value=-1),o.value=!$}}),M=ct(()=>typeof t.counterValue=="function"?t.counterValue(A.value):typeof t.counterValue=="number"?t.counterValue:t.multiple?A.value.length:E.value.length),{filteredItems:G,getMatches:tt}=Ki(t,g,()=>F.value??(t.alwaysFilter||!o.value?E.value:"")),p=ct(()=>t.hideSelected&&F.value===null?G.value.filter($=>!A.value.some(X=>X.value===$.value)):G.value),f=ct(()=>t.hideNoData&&!p.value.length||w.isReadonly.value||w.isDisabled.value),m=Yn(t,"menu"),b=ct({get:()=>m.value,set:$=>{var X;m.value&&!$&&((X=l.value)!=null&&X.Î¨openChildren.size)||$&&f.value||(m.value=$)}}),{menuId:N,ariaExpanded:T,ariaControls:R}=Yi(t,b);Bt(_,$=>{d?Pt(()=>d=!1):s.value&&!b.value&&(b.value=!0),e("update:search",$)}),Bt(A,$=>{var X;!t.multiple&&!x.value&&(_.value=((X=$[0])==null?void 0:X.title)??"")});const Y=ct(()=>A.value.map($=>$.value)),q=ct(()=>p.value.find($=>$.type==="item"&&!$.props.disabled)),et=ct(()=>{var X;return(t.autoSelectFirst===!0||t.autoSelectFirst==="exact"&&E.value===((X=q.value)==null?void 0:X.title))&&p.value.length>0&&!o.value&&!c.value}),K=W(),k=Hi(K,a);function B($){d=!0,Pt(()=>d=!1),t.openOnClear&&(b.value=!0)}function H(){f.value||(b.value=!0)}function U($){f.value||(s.value&&($.preventDefault(),$.stopPropagation()),b.value=!b.value)}function nt($){var X;(qn($)||$.key==="Backspace")&&((X=a.value)==null||X.focus())}function lt($){var Q,xt,J,ut;if(Ri($)||w.isReadonly.value)return;const X=(Q=a.value)==null?void 0:Q.selectionStart,Z=A.value.length;if(["Enter","ArrowDown","ArrowUp"].includes($.key)&&$.preventDefault(),["Enter","ArrowDown"].includes($.key)&&(b.value=!0),["Escape"].includes($.key)&&(b.value=!1),et.value&&["Enter","Tab"].includes($.key)&&q.value&&!A.value.some(at=>{let{value:Kt}=at;return Kt===q.value.value})&&st(q.value),$.key==="ArrowDown"&&et.value&&((xt=K.value)==null||xt.focus("next")),$.key==="Enter"&&E.value&&(st(re(t,E.value),!0,!0),x.value&&(_.value="")),["Backspace","Delete"].includes($.key)){if(!t.multiple&&x.value&&A.value.length>0&&!E.value)return st(A.value[0],!1);if(~h.value){$.preventDefault();const at=h.value;st(A.value[h.value],!1),h.value=at>=Z-1?Z-2:at}else $.key==="Backspace"&&!E.value&&(h.value=Z-1);return}if(t.multiple)if($.key==="ArrowLeft"){if(h.value<0&&X&&X>0)return;const at=h.value>-1?h.value-1:Z-1;A.value[at]?h.value=at:(h.value=-1,(J=a.value)==null||J.setSelectionRange(E.value.length,E.value.length))}else if($.key==="ArrowRight"){if(h.value<0)return;const at=h.value+1;A.value[at]?h.value=at:(h.value=-1,(ut=a.value)==null||ut.setSelectionRange(0,0))}else~h.value&&qn($)&&(h.value=-1)}function ot($){var Q;const X=((Q=$==null?void 0:$.clipboardData)==null?void 0:Q.getData("Text"))??"",Z=In(X);Z.length>1&&t.multiple&&($.preventDefault(),Vn(Z))}function mt(){var $;t.eager&&(($=u.value)==null||$.calculateVisibleItems())}function ye(){var $;s.value&&(($=a.value)==null||$.focus()),o.value=!0,F.value=null}function st($){let X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!(!$||$.props.disabled))if(t.multiple){const Q=A.value.findIndex(J=>(t.valueComparator||Hn)(J.value,$.value)),xt=X??!~Q;if(~Q){const J=xt?[...A.value,$]:[...A.value];J.splice(Q,1),A.value=J}else xt&&(A.value=[...A.value,$]);t.clearOnSelect&&(E.value="")}else{const Q=X!==!1;A.value=Q?[$]:[],(!o.value||t.alwaysFilter)&&_.value&&(F.value=_.value),_.value=Q&&!x.value?$.title:"",Pt(()=>{b.value=Z,o.value=!0})}}function In($){const Z=[`
`,...t.delimiters??[]].map(Ti).join("|");return $.split(new RegExp(`(?:${Z})+`))}async function Vn($){for(let X of $)X=X.trim(),X&&(st(re(t,X)),await Pt())}function fi($){s.value=!0,setTimeout(()=>{c.value=!0})}function gi($){c.value=!1}return Bt(s,($,X)=>{if(!($||$===X)&&(h.value=-1,b.value=!1,E.value)){if(t.multiple){st(re(t,E.value));return}if(!x.value)return;A.value.some(Z=>{let{title:Q}=Z;return Q===E.value})?_.value="":st(re(t,E.value))}}),Bt(b,$=>{if(!t.hideSelected&&$&&A.value.length&&o.value){const X=p.value.findIndex(Z=>A.value.some(Q=>(t.valueComparator||Hn)(Q.value,Z.value)));$i&&window.requestAnimationFrame(()=>{var Z;X>=0&&((Z=u.value)==null||Z.scrollToIndex(X))})}$&&(F.value=null)}),Bt(g,($,X)=>{b.value||s.value&&!X.length&&$.length&&(b.value=!0)}),Si(()=>{const $=!!(!t.hideNoData||p.value.length||r["prepend-item"]||r["append-item"]||r["no-data"]),X=A.value.length>0,Z=rn.filterProps(t);return D(rn,gt({ref:a},Z,{modelValue:E.value,"onUpdate:modelValue":Q=>E.value=Q,focused:s.value,"onUpdate:focused":Q=>s.value=Q,validationValue:A.externalValue,counterValue:M.value,dirty:X,class:["v-combobox",{"v-combobox--active-menu":b.value,"v-combobox--chips":!!t.chips,"v-combobox--selection-slot":!!x.value,"v-combobox--selecting-index":h.value>-1,[`v-combobox--${t.multiple?"multiple":"single"}`]:!0},t.class],style:t.style,readonly:w.isReadonly.value,placeholder:X?void 0:t.placeholder,"onClick:clear":B,"onMousedown:control":H,onKeydown:lt,onPaste:ot,"aria-expanded":T.value,"aria-controls":R.value}),{...r,default:Q=>{let{id:xt}=Q;return vt(It,null,[D(ea,gt({id:N.value,ref:l,modelValue:b.value,"onUpdate:modelValue":J=>b.value=J,activator:"parent",contentClass:"v-combobox__content",disabled:f.value,eager:t.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:mt,onAfterLeave:ye},t.menuProps),{default:()=>[$&&D(Qi,gt({ref:K,filterable:!0,selected:Y.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:J=>J.preventDefault(),selectable:!0,onKeydown:nt,onFocusin:fi,onFocusout:gi,tabindex:"-1","aria-live":"polite","aria-labelledby":`${xt.value}-label`,"aria-multiselectable":t.multiple,color:t.itemColor??t.color},k,t.listProps),{default:()=>{var J,ut,at;return[(J=r["prepend-item"])==null?void 0:J.call(r),!p.value.length&&!t.hideNoData&&(((ut=r["no-data"])==null?void 0:ut.call(r))??D(Fe,{key:"no-data",title:i(t.noDataText)},null)),D(qi,{ref:u,renderless:!0,items:p.value,itemKey:"value"},{default:Kt=>{var Pn,Xn,Un;let{item:rt,index:Ct,itemRef:ft}=Kt;const On=gt(rt.props,{ref:ft,key:rt.value,active:et.value&&rt===q.value?!0:void 0,onClick:()=>st(rt,null),"aria-posinset":Ct+1,"aria-setsize":p.value.length});return rt.type==="divider"?((Pn=r.divider)==null?void 0:Pn.call(r,{props:rt.raw,index:Ct}))??D(na,gt(rt.props,{key:`divider-${Ct}`}),null):rt.type==="subheader"?((Xn=r.subheader)==null?void 0:Xn.call(r,{props:rt.raw,index:Ct}))??D(ta,gt(rt.props,{key:`subheader-${Ct}`}),null):((Un=r.item)==null?void 0:Un.call(r,{item:rt,index:Ct,props:On}))??D(Fe,gt(On,{role:"option"}),{prepend:xe=>{let{isSelected:pi}=xe;return vt(It,null,[t.multiple&&!t.hideSelected?D(ra,{key:rt.value,modelValue:pi,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:mi=>mi.preventDefault()},null):void 0,rt.props.prependAvatar&&D(bn,{image:rt.props.prependAvatar},null),rt.props.prependIcon&&D(Yt,{icon:rt.props.prependIcon},null)])},title:()=>{var xe;return o.value?rt.title:Ji("v-combobox",rt.title,(xe=tt(rt))==null?void 0:xe.title)}})}}),(at=r["append-item"])==null?void 0:at.call(r)]}})]}),A.value.map((J,ut)=>{function at(ft){ft.stopPropagation(),ft.preventDefault(),st(J,!1)}const Kt=gt(De.filterProps(J.props),{"onClick:close":at,onKeydown(ft){ft.key!=="Enter"&&ft.key!==" "||(ft.preventDefault(),ft.stopPropagation(),at(ft))},onMousedown(ft){ft.preventDefault(),ft.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),rt=L.value?!!r.chip:!!r.selection,Ct=rt?Mi(L.value?r.chip({item:J,index:ut,props:Kt}):r.selection({item:J,index:ut})):void 0;if(!(rt&&!Ct))return vt("div",{key:J.value,class:Di(["v-combobox__selection",ut===h.value&&["v-combobox__selection--selected",S.value]]),style:Bi(ut===h.value?C.value:{})},[L.value?r.chip?D(Ni,{key:"chip-defaults",defaults:{VChip:{closable:I.value,size:"small",text:J.title}}},{default:()=>[Ct]}):D(De,gt({key:"chip",closable:I.value,size:"small",text:J.title,disabled:J.props.disabled},Kt),null):Ct??vt("span",{class:"v-combobox__selection-text"},[J.title,t.multiple&&ut<A.value.length-1&&vt("span",{class:"v-combobox__selection-comma"},[yt(",")])])])})])},"append-inner":function(){var ut,at;for(var Q=arguments.length,xt=new Array(Q),J=0;J<Q;J++)xt[J]=arguments[J];return vt(It,null,[(ut=r["append-inner"])==null?void 0:ut.call(r,...xt),(!t.hideNoData||t.items.length)&&t.menuIcon?D(Yt,{class:"v-combobox__menu-icon",color:(at=a.value)==null?void 0:at.fieldIconColor,icon:t.menuIcon,onMousedown:U,onClick:Ai,"aria-hidden":!0,tabindex:"-1"},null):void 0,t.appendInnerIcon&&D(z,{key:"append-icon",name:"appendInner",color:xt[0].iconColor.value},null)])}})}),zi({isFocused:s,isPristine:o,menu:b,search:E,selectionIndex:h,filteredItems:G,select:st},a)}});function sa(t,n){var e=0,r=0;return Float64Array.from(t,n===void 0?i=>e+=+i||0:i=>e+=+n(i,r++,t)||0)}function la(t,n){let e;if(n===void 0)for(const r of t)r!=null&&(e<r||e===void 0&&r>=r)&&(e=r);else{let r=-1;for(let i of t)(i=n(i,++r,t))!=null&&(e<i||e===void 0&&i>=i)&&(e=i)}return e}function ua(t,n){let e;if(n===void 0)for(const r of t)r!=null&&(e>r||e===void 0&&r>=r)&&(e=r);else{let r=-1;for(let i of t)(i=n(i,++r,t))!=null&&(e>i||e===void 0&&i>=i)&&(e=i)}return e}function ca(t,n){let e=0;if(n===void 0)for(let r of t)(r=+r)&&(e+=r);else{let r=-1;for(let i of t)(i=+n(i,++r,t))&&(e+=i)}return e}var ha={value:()=>{}};function Ye(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new $e(e)}function $e(t){this._=t}function da(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}$e.prototype=Ye.prototype={constructor:$e,on:function(t,n){var e=this._,r=da(t+"",e),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(t=r[a]).type)&&(i=fa(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<s;)if(i=(t=r[a]).type)e[i]=Wn(e[i],t.name,n);else if(n==null)for(i in e)e[i]=Wn(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new $e(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,a;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};function fa(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function Wn(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=ha,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var an="http://www.w3.org/1999/xhtml";const Gn={svg:"http://www.w3.org/2000/svg",xhtml:an,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function He(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),Gn.hasOwnProperty(n)?{space:Gn[n],local:t}:t}function ga(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===an&&n.documentElement.namespaceURI===an?n.createElement(t):n.createElementNS(e,t)}}function pa(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Er(t){var n=He(t);return(n.local?pa:ga)(n)}function ma(){}function Sn(t){return t==null?ma:function(){return this.querySelector(t)}}function va(t){typeof t!="function"&&(t=Sn(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a=n[i],s=a.length,o=r[i]=new Array(s),c,l,u=0;u<s;++u)(c=a[u])&&(l=t.call(c,c.__data__,u,a))&&("__data__"in c&&(l.__data__=c.__data__),o[u]=l);return new dt(r,this._parents)}function ya(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function xa(){return[]}function kr(t){return t==null?xa:function(){return this.querySelectorAll(t)}}function _a(t){return function(){return ya(t.apply(this,arguments))}}function wa(t){typeof t=="function"?t=_a(t):t=kr(t);for(var n=this._groups,e=n.length,r=[],i=[],a=0;a<e;++a)for(var s=n[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(r.push(t.call(c,c.__data__,l,s)),i.push(c));return new dt(r,i)}function $r(t){return function(){return this.matches(t)}}function Sr(t){return function(n){return n.matches(t)}}var ba=Array.prototype.find;function Ca(t){return function(){return ba.call(this.children,t)}}function Ea(){return this.firstElementChild}function ka(t){return this.select(t==null?Ea:Ca(typeof t=="function"?t:Sr(t)))}var $a=Array.prototype.filter;function Sa(){return Array.from(this.children)}function Aa(t){return function(){return $a.call(this.children,t)}}function Ma(t){return this.selectAll(t==null?Sa:Aa(typeof t=="function"?t:Sr(t)))}function Ba(t){typeof t!="function"&&(t=$r(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a=n[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new dt(r,this._parents)}function Ar(t){return new Array(t.length)}function Da(){return new dt(this._enter||this._groups.map(Ar),this._parents)}function Te(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}Te.prototype={constructor:Te,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Na(t){return function(){return t}}function za(t,n,e,r,i,a){for(var s=0,o,c=n.length,l=a.length;s<l;++s)(o=n[s])?(o.__data__=a[s],r[s]=o):e[s]=new Te(t,a[s]);for(;s<c;++s)(o=n[s])&&(i[s]=o)}function Fa(t,n,e,r,i,a,s){var o,c,l=new Map,u=n.length,h=a.length,d=new Array(u),g;for(o=0;o<u;++o)(c=n[o])&&(d[o]=g=s.call(c,c.__data__,o,n)+"",l.has(g)?i[o]=c:l.set(g,c));for(o=0;o<h;++o)g=s.call(t,a[o],o,a)+"",(c=l.get(g))?(r[o]=c,c.__data__=a[o],l.delete(g)):e[o]=new Te(t,a[o]);for(o=0;o<u;++o)(c=n[o])&&l.get(d[o])===c&&(i[o]=c)}function Ta(t){return t.__data__}function Ra(t,n){if(!arguments.length)return Array.from(this,Ta);var e=n?Fa:za,r=this._parents,i=this._groups;typeof t!="function"&&(t=Na(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),l=0;l<a;++l){var u=r[l],h=i[l],d=h.length,g=Ia(t.call(u,u&&u.__data__,l,r)),v=g.length,y=o[l]=new Array(v),S=s[l]=new Array(v),C=c[l]=new Array(d);e(u,h,y,S,C,g,n);for(var z=0,A=0,w,I;z<v;++z)if(w=y[z]){for(z>=A&&(A=z+1);!(I=S[A])&&++A<v;);w._next=I||null}}return s=new dt(s,r),s._enter=o,s._exit=c,s}function Ia(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Va(){return new dt(this._exit||this._groups.map(Ar),this._parents)}function La(t,n,e){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),n!=null&&(i=n(i),i&&(i=i.selection())),e==null?a.remove():e(a),r&&i?r.merge(i).order():i}function Oa(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,a=r.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var l=e[c],u=r[c],h=l.length,d=o[c]=new Array(h),g,v=0;v<h;++v)(g=l[v]||u[v])&&(d[v]=g);for(;c<i;++c)o[c]=e[c];return new dt(o,this._parents)}function Pa(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r=t[n],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Xa(t){t||(t=Ua);function n(h,d){return h&&d?t(h.__data__,d.__data__):!h-!d}for(var e=this._groups,r=e.length,i=new Array(r),a=0;a<r;++a){for(var s=e[a],o=s.length,c=i[a]=new Array(o),l,u=0;u<o;++u)(l=s[u])&&(c[u]=l);c.sort(n)}return new dt(i,this._parents).order()}function Ua(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function Ya(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ha(){return Array.from(this)}function qa(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function Wa(){let t=0;for(const n of this)++t;return t}function Ga(){return!this.node()}function Ka(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i=n[e],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function Ja(t){return function(){this.removeAttribute(t)}}function ja(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Za(t,n){return function(){this.setAttribute(t,n)}}function Qa(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function to(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function eo(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function no(t,n){var e=He(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((n==null?e.local?ja:Ja:typeof n=="function"?e.local?eo:to:e.local?Qa:Za)(e,n))}function Mr(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ro(t){return function(){this.style.removeProperty(t)}}function io(t,n,e){return function(){this.style.setProperty(t,n,e)}}function ao(t,n,e){return function(){var r=n.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function oo(t,n,e){return arguments.length>1?this.each((n==null?ro:typeof n=="function"?ao:io)(t,n,e??"")):Qt(this.node(),t)}function Qt(t,n){return t.style.getPropertyValue(n)||Mr(t).getComputedStyle(t,null).getPropertyValue(n)}function so(t){return function(){delete this[t]}}function lo(t,n){return function(){this[t]=n}}function uo(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function co(t,n){return arguments.length>1?this.each((n==null?so:typeof n=="function"?uo:lo)(t,n)):this.node()[t]}function Br(t){return t.trim().split(/^|\s+/)}function An(t){return t.classList||new Dr(t)}function Dr(t){this._node=t,this._names=Br(t.getAttribute("class")||"")}Dr.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Nr(t,n){for(var e=An(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function zr(t,n){for(var e=An(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function ho(t){return function(){Nr(this,t)}}function fo(t){return function(){zr(this,t)}}function go(t,n){return function(){(n.apply(this,arguments)?Nr:zr)(this,t)}}function po(t,n){var e=Br(t+"");if(arguments.length<2){for(var r=An(this.node()),i=-1,a=e.length;++i<a;)if(!r.contains(e[i]))return!1;return!0}return this.each((typeof n=="function"?go:n?ho:fo)(e,n))}function mo(){this.textContent=""}function vo(t){return function(){this.textContent=t}}function yo(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function xo(t){return arguments.length?this.each(t==null?mo:(typeof t=="function"?yo:vo)(t)):this.node().textContent}function _o(){this.innerHTML=""}function wo(t){return function(){this.innerHTML=t}}function bo(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function Co(t){return arguments.length?this.each(t==null?_o:(typeof t=="function"?bo:wo)(t)):this.node().innerHTML}function Eo(){this.nextSibling&&this.parentNode.appendChild(this)}function ko(){return this.each(Eo)}function $o(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function So(){return this.each($o)}function Ao(t){var n=typeof t=="function"?t:Er(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function Mo(){return null}function Bo(t,n){var e=typeof t=="function"?t:Er(t),r=n==null?Mo:typeof n=="function"?n:Sn(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})}function Do(){var t=this.parentNode;t&&t.removeChild(this)}function No(){return this.each(Do)}function zo(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Fo(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function To(t){return this.select(t?Fo:zo)}function Ro(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Io(t){return function(n){t.call(this,n,this.__data__)}}function Vo(t){return t.trim().split(/^|\s+/).map(function(n){var e="",r=n.indexOf(".");return r>=0&&(e=n.slice(r+1),n=n.slice(0,r)),{type:n,name:e}})}function Lo(t){return function(){var n=this.__on;if(n){for(var e=0,r=-1,i=n.length,a;e<i;++e)a=n[e],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):n[++r]=a;++r?n.length=r:delete this.__on}}}function Oo(t,n,e){return function(){var r=this.__on,i,a=Io(n);if(r){for(var s=0,o=r.length;s<o;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=e),i.value=n;return}}this.addEventListener(t.type,a,e),i={type:t.type,name:t.name,value:n,listener:a,options:e},r?r.push(i):this.__on=[i]}}function Po(t,n,e){var r=Vo(t+""),i,a=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,u;c<l;++c)for(i=0,u=o[c];i<a;++i)if((s=r[i]).type===u.type&&s.name===u.name)return u.value}return}for(o=n?Oo:Lo,i=0;i<a;++i)this.each(o(r[i],n,e));return this}function Fr(t,n,e){var r=Mr(t),i=r.CustomEvent;typeof i=="function"?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function Xo(t,n){return function(){return Fr(this,t,n)}}function Uo(t,n){return function(){return Fr(this,t,n.apply(this,arguments))}}function Yo(t,n){return this.each((typeof n=="function"?Uo:Xo)(t,n))}function*Ho(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length,s;i<a;++i)(s=r[i])&&(yield s)}var Tr=[null];function dt(t,n){this._groups=t,this._parents=n}function ne(){return new dt([[document.documentElement]],Tr)}function qo(){return this}dt.prototype=ne.prototype={constructor:dt,select:va,selectAll:wa,selectChild:ka,selectChildren:Ma,filter:Ba,data:Ra,enter:Da,exit:Va,join:La,merge:Oa,selection:qo,order:Pa,sort:Xa,call:Ya,nodes:Ha,node:qa,size:Wa,empty:Ga,each:Ka,attr:no,style:oo,property:co,classed:po,text:xo,html:Co,raise:ko,lower:So,append:Ao,insert:Bo,remove:No,clone:To,datum:Ro,on:Po,dispatch:Yo,[Symbol.iterator]:Ho};function it(t){return typeof t=="string"?new dt([[document.querySelector(t)]],[document.documentElement]):new dt([[t]],Tr)}function Wo(t){let n;for(;n=t.sourceEvent;)t=n;return t}function Mt(t,n){if(t=Wo(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}function Go(t){return new dt([document.querySelectorAll(t)],[document.documentElement])}const Ko={passive:!1},de={capture:!0,passive:!1};function Ge(t){t.stopImmediatePropagation()}function jt(t){t.preventDefault(),t.stopImmediatePropagation()}function Rr(t){var n=t.document.documentElement,e=it(t).on("dragstart.drag",jt,de);"onselectstart"in n?e.on("selectstart.drag",jt,de):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Ir(t,n){var e=t.document.documentElement,r=it(t).on("dragstart.drag",null);n&&(r.on("click.drag",jt,de),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}const _e=t=>()=>t;function on(t,{sourceEvent:n,subject:e,target:r,identifier:i,active:a,x:s,y:o,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}on.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Jo(t){return!t.ctrlKey&&!t.button}function jo(){return this.parentNode}function Zo(t,n){return n??{x:t.x,y:t.y}}function Qo(){return navigator.maxTouchPoints||"ontouchstart"in this}function ts(){var t=Jo,n=jo,e=Zo,r=Qo,i={},a=Ye("start","drag","end"),s=0,o,c,l,u,h=0;function d(w){w.on("mousedown.drag",g).filter(r).on("touchstart.drag",S).on("touchmove.drag",C,Ko).on("touchend.drag touchcancel.drag",z).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(w,I){if(!(u||!t.call(this,w,I))){var L=A(this,n.call(this,w,I),w,I,"mouse");L&&(it(w.view).on("mousemove.drag",v,de).on("mouseup.drag",y,de),Rr(w.view),Ge(w),l=!1,o=w.clientX,c=w.clientY,L("start",w))}}function v(w){if(jt(w),!l){var I=w.clientX-o,L=w.clientY-c;l=I*I+L*L>h}i.mouse("drag",w)}function y(w){it(w.view).on("mousemove.drag mouseup.drag",null),Ir(w.view,l),jt(w),i.mouse("end",w)}function S(w,I){if(t.call(this,w,I)){var L=w.changedTouches,x=n.call(this,w,I),_=L.length,F,E;for(F=0;F<_;++F)(E=A(this,x,w,I,L[F].identifier,L[F]))&&(Ge(w),E("start",w,L[F]))}}function C(w){var I=w.changedTouches,L=I.length,x,_;for(x=0;x<L;++x)(_=i[I[x].identifier])&&(jt(w),_("drag",w,I[x]))}function z(w){var I=w.changedTouches,L=I.length,x,_;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),x=0;x<L;++x)(_=i[I[x].identifier])&&(Ge(w),_("end",w,I[x]))}function A(w,I,L,x,_,F){var E=a.copy(),M=Mt(F||L,I),G,tt,p;if((p=e.call(w,new on("beforestart",{sourceEvent:L,target:d,identifier:_,active:s,x:M[0],y:M[1],dx:0,dy:0,dispatch:E}),x))!=null)return G=p.x-M[0]||0,tt=p.y-M[1]||0,function f(m,b,N){var T=M,R;switch(m){case"start":i[_]=f,R=s++;break;case"end":delete i[_],--s;case"drag":M=Mt(N||b,I),R=s;break}E.call(m,w,new on(m,{sourceEvent:b,subject:p,target:d,identifier:_,active:R,x:M[0]+G,y:M[1]+tt,dx:M[0]-T[0],dy:M[1]-T[1],dispatch:E}),x)}}return d.filter=function(w){return arguments.length?(t=typeof w=="function"?w:_e(!!w),d):t},d.container=function(w){return arguments.length?(n=typeof w=="function"?w:_e(w),d):n},d.subject=function(w){return arguments.length?(e=typeof w=="function"?w:_e(w),d):e},d.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:_e(!!w),d):r},d.on=function(){var w=a.on.apply(a,arguments);return w===a?d:w},d.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,d):Math.sqrt(h)},d}function Mn(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Vr(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function ve(){}var fe=.7,Re=1/fe,Zt="\\s*([+-]?\\d+)\\s*",ge="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$t="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",es=/^#([0-9a-f]{3,8})$/,ns=new RegExp(`^rgb\\(${Zt},${Zt},${Zt}\\)$`),rs=new RegExp(`^rgb\\(${$t},${$t},${$t}\\)$`),is=new RegExp(`^rgba\\(${Zt},${Zt},${Zt},${ge}\\)$`),as=new RegExp(`^rgba\\(${$t},${$t},${$t},${ge}\\)$`),os=new RegExp(`^hsl\\(${ge},${$t},${$t}\\)$`),ss=new RegExp(`^hsla\\(${ge},${$t},${$t},${ge}\\)$`),Kn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Mn(ve,pe,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Jn,formatHex:Jn,formatHex8:ls,formatHsl:us,formatRgb:jn,toString:jn});function Jn(){return this.rgb().formatHex()}function ls(){return this.rgb().formatHex8()}function us(){return Lr(this).formatHsl()}function jn(){return this.rgb().formatRgb()}function pe(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=es.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?Zn(n):e===3?new ht(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?we(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?we(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=ns.exec(t))?new ht(n[1],n[2],n[3],1):(n=rs.exec(t))?new ht(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=is.exec(t))?we(n[1],n[2],n[3],n[4]):(n=as.exec(t))?we(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=os.exec(t))?er(n[1],n[2]/100,n[3]/100,1):(n=ss.exec(t))?er(n[1],n[2]/100,n[3]/100,n[4]):Kn.hasOwnProperty(t)?Zn(Kn[t]):t==="transparent"?new ht(NaN,NaN,NaN,0):null}function Zn(t){return new ht(t>>16&255,t>>8&255,t&255,1)}function we(t,n,e,r){return r<=0&&(t=n=e=NaN),new ht(t,n,e,r)}function cs(t){return t instanceof ve||(t=pe(t)),t?(t=t.rgb(),new ht(t.r,t.g,t.b,t.opacity)):new ht}function sn(t,n,e,r){return arguments.length===1?cs(t):new ht(t,n,e,r??1)}function ht(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}Mn(ht,sn,Vr(ve,{brighter(t){return t=t==null?Re:Math.pow(Re,t),new ht(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?fe:Math.pow(fe,t),new ht(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ht(qt(this.r),qt(this.g),qt(this.b),Ie(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qn,formatHex:Qn,formatHex8:hs,formatRgb:tr,toString:tr}));function Qn(){return`#${Ut(this.r)}${Ut(this.g)}${Ut(this.b)}`}function hs(){return`#${Ut(this.r)}${Ut(this.g)}${Ut(this.b)}${Ut((isNaN(this.opacity)?1:this.opacity)*255)}`}function tr(){const t=Ie(this.opacity);return`${t===1?"rgb(":"rgba("}${qt(this.r)}, ${qt(this.g)}, ${qt(this.b)}${t===1?")":`, ${t})`}`}function Ie(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function qt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ut(t){return t=qt(t),(t<16?"0":"")+t.toString(16)}function er(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new wt(t,n,e,r)}function Lr(t){if(t instanceof wt)return new wt(t.h,t.s,t.l,t.opacity);if(t instanceof ve||(t=pe(t)),!t)return new wt;if(t instanceof wt)return t;t=t.rgb();var n=t.r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),a=Math.max(n,e,r),s=NaN,o=a-i,c=(a+i)/2;return o?(n===a?s=(e-r)/o+(e<r)*6:e===a?s=(r-n)/o+2:s=(n-e)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new wt(s,o,c,t.opacity)}function ds(t,n,e,r){return arguments.length===1?Lr(t):new wt(t,n,e,r??1)}function wt(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}Mn(wt,ds,Vr(ve,{brighter(t){return t=t==null?Re:Math.pow(Re,t),new wt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?fe:Math.pow(fe,t),new wt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new ht(Ke(t>=240?t-240:t+120,i,r),Ke(t,i,r),Ke(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new wt(nr(this.h),be(this.s),be(this.l),Ie(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ie(this.opacity);return`${t===1?"hsl(":"hsla("}${nr(this.h)}, ${be(this.s)*100}%, ${be(this.l)*100}%${t===1?")":`, ${t})`}`}}));function nr(t){return t=(t||0)%360,t<0?t+360:t}function be(t){return Math.max(0,Math.min(1,t||0))}function Ke(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}const Or=t=>()=>t;function fs(t,n){return function(e){return t+e*n}}function gs(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}function ps(t){return(t=+t)==1?Pr:function(n,e){return e-n?gs(n,e,t):Or(isNaN(n)?e:n)}}function Pr(t,n){var e=n-t;return e?fs(t,e):Or(isNaN(t)?n:t)}const rr=(function t(n){var e=ps(n);function r(i,a){var s=e((i=sn(i)).r,(a=sn(a)).r),o=e(i.g,a.g),c=e(i.b,a.b),l=Pr(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=t,r})(1);function Tt(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}var ln=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Je=new RegExp(ln.source,"g");function ms(t){return function(){return t}}function vs(t){return function(n){return t(n)+""}}function ys(t,n){var e=ln.lastIndex=Je.lastIndex=0,r,i,a,s=-1,o=[],c=[];for(t=t+"",n=n+"";(r=ln.exec(t))&&(i=Je.exec(n));)(a=i.index)>e&&(a=n.slice(e,a),o[s]?o[s]+=a:o[++s]=a),(r=r[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:Tt(r,i)})),e=Je.lastIndex;return e<n.length&&(a=n.slice(e),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?vs(c[0].x):ms(n):(n=c.length,function(l){for(var u=0,h;u<n;++u)o[(h=c[u]).i]=h.x(l);return o.join("")})}var ir=180/Math.PI,un={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Xr(t,n,e,r,i,a){var s,o,c;return(s=Math.sqrt(t*t+n*n))&&(t/=s,n/=s),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(o=Math.sqrt(e*e+r*r))&&(e/=o,r/=o,c/=o),t*r<n*e&&(t=-t,n=-n,c=-c,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(n,t)*ir,skewX:Math.atan(c)*ir,scaleX:s,scaleY:o}}var Ce;function xs(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?un:Xr(n.a,n.b,n.c,n.d,n.e,n.f)}function _s(t){return t==null||(Ce||(Ce=document.createElementNS("http://www.w3.org/2000/svg","g")),Ce.setAttribute("transform",t),!(t=Ce.transform.baseVal.consolidate()))?un:(t=t.matrix,Xr(t.a,t.b,t.c,t.d,t.e,t.f))}function Ur(t,n,e,r){function i(l){return l.length?l.pop()+" ":""}function a(l,u,h,d,g,v){if(l!==h||u!==d){var y=g.push("translate(",null,n,null,e);v.push({i:y-4,x:Tt(l,h)},{i:y-2,x:Tt(u,d)})}else(h||d)&&g.push("translate("+h+n+d+e)}function s(l,u,h,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Tt(l,u)})):u&&h.push(i(h)+"rotate("+u+r)}function o(l,u,h,d){l!==u?d.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Tt(l,u)}):u&&h.push(i(h)+"skewX("+u+r)}function c(l,u,h,d,g,v){if(l!==h||u!==d){var y=g.push(i(g)+"scale(",null,",",null,")");v.push({i:y-4,x:Tt(l,h)},{i:y-2,x:Tt(u,d)})}else(h!==1||d!==1)&&g.push(i(g)+"scale("+h+","+d+")")}return function(l,u){var h=[],d=[];return l=t(l),u=t(u),a(l.translateX,l.translateY,u.translateX,u.translateY,h,d),s(l.rotate,u.rotate,h,d),o(l.skewX,u.skewX,h,d),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,d),l=u=null,function(g){for(var v=-1,y=d.length,S;++v<y;)h[(S=d[v]).i]=S.x(g);return h.join("")}}}var ws=Ur(xs,"px, ","px)","deg)"),bs=Ur(_s,", ",")",")"),Cs=1e-12;function ar(t){return((t=Math.exp(t))+1/t)/2}function Es(t){return((t=Math.exp(t))-1/t)/2}function ks(t){return((t=Math.exp(2*t))-1)/(t+1)}const $s=(function t(n,e,r){function i(a,s){var o=a[0],c=a[1],l=a[2],u=s[0],h=s[1],d=s[2],g=u-o,v=h-c,y=g*g+v*v,S,C;if(y<Cs)C=Math.log(d/l)/n,S=function(x){return[o+x*g,c+x*v,l*Math.exp(n*x*C)]};else{var z=Math.sqrt(y),A=(d*d-l*l+r*y)/(2*l*e*z),w=(d*d-l*l-r*y)/(2*d*e*z),I=Math.log(Math.sqrt(A*A+1)-A),L=Math.log(Math.sqrt(w*w+1)-w);C=(L-I)/n,S=function(x){var _=x*C,F=ar(I),E=l/(e*z)*(F*ks(n*_+I)-Es(I));return[o+E*g,c+E*v,l*F/ar(n*_+I)]}}return S.duration=C*1e3*n/Math.SQRT2,S}return i.rho=function(a){var s=Math.max(.001,+a),o=s*s,c=o*o;return t(s,o,c)},i})(Math.SQRT2,2,4);var te=0,se=0,ae=0,Yr=1e3,Ve,le,Le=0,Wt=0,qe=0,me=typeof performance=="object"&&performance.now?performance:Date,Hr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Bn(){return Wt||(Hr(Ss),Wt=me.now()+qe)}function Ss(){Wt=0}function Oe(){this._call=this._time=this._next=null}Oe.prototype=qr.prototype={constructor:Oe,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?Bn():+e)+(n==null?0:+n),!this._next&&le!==this&&(le?le._next=this:Ve=this,le=this),this._call=t,this._time=e,cn()},stop:function(){this._call&&(this._call=null,this._time=1/0,cn())}};function qr(t,n,e){var r=new Oe;return r.restart(t,n,e),r}function As(){Bn(),++te;for(var t=Ve,n;t;)(n=Wt-t._time)>=0&&t._call.call(void 0,n),t=t._next;--te}function or(){Wt=(Le=me.now())+qe,te=se=0;try{As()}finally{te=0,Bs(),Wt=0}}function Ms(){var t=me.now(),n=t-Le;n>Yr&&(qe-=n,Le=t)}function Bs(){for(var t,n=Ve,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ve=e);le=t,cn(r)}function cn(t){if(!te){se&&(se=clearTimeout(se));var n=t-Wt;n>24?(t<1/0&&(se=setTimeout(or,t-me.now()-qe)),ae&&(ae=clearInterval(ae))):(ae||(Le=me.now(),ae=setInterval(Ms,Yr)),te=1,Hr(or))}}function sr(t,n,e){var r=new Oe;return n=n==null?0:+n,r.restart(i=>{r.stop(),t(i+n)},n,e),r}var Ds=Ye("start","end","cancel","interrupt"),Ns=[],Wr=0,lr=1,hn=2,Se=3,ur=4,dn=5,Ae=6;function We(t,n,e,r,i,a){var s=t.__transition;if(!s)t.__transition={};else if(e in s)return;zs(t,e,{name:n,index:r,group:i,on:Ds,tween:Ns,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Wr})}function Dn(t,n){var e=bt(t,n);if(e.state>Wr)throw new Error("too late; already scheduled");return e}function St(t,n){var e=bt(t,n);if(e.state>Se)throw new Error("too late; already running");return e}function bt(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function zs(t,n,e){var r=t.__transition,i;r[n]=e,e.timer=qr(a,0,e.time);function a(l){e.state=lr,e.timer.restart(s,e.delay,e.time),e.delay<=l&&s(l-e.delay)}function s(l){var u,h,d,g;if(e.state!==lr)return c();for(u in r)if(g=r[u],g.name===e.name){if(g.state===Se)return sr(s);g.state===ur?(g.state=Ae,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[u]):+u<n&&(g.state=Ae,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[u])}if(sr(function(){e.state===Se&&(e.state=ur,e.timer.restart(o,e.delay,e.time),o(l))}),e.state=hn,e.on.call("start",t,t.__data__,e.index,e.group),e.state===hn){for(e.state=Se,i=new Array(d=e.tween.length),u=0,h=-1;u<d;++u)(g=e.tween[u].value.call(t,t.__data__,e.index,e.group))&&(i[++h]=g);i.length=h+1}}function o(l){for(var u=l<e.duration?e.ease.call(null,l/e.duration):(e.timer.restart(c),e.state=dn,1),h=-1,d=i.length;++h<d;)i[h].call(t,u);e.state===dn&&(e.on.call("end",t,t.__data__,e.index,e.group),c())}function c(){e.state=Ae,e.timer.stop(),delete r[n];for(var l in r)return;delete t.__transition}}function Me(t,n){var e=t.__transition,r,i,a=!0,s;if(e){n=n==null?null:n+"";for(s in e){if((r=e[s]).name!==n){a=!1;continue}i=r.state>hn&&r.state<dn,r.state=Ae,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete e[s]}a&&delete t.__transition}}function Fs(t){return this.each(function(){Me(this,t)})}function Ts(t,n){var e,r;return function(){var i=St(this,t),a=i.tween;if(a!==e){r=e=a;for(var s=0,o=r.length;s<o;++s)if(r[s].name===n){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Rs(t,n,e){var r,i;if(typeof e!="function")throw new Error;return function(){var a=St(this,t),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:n,value:e},c=0,l=i.length;c<l;++c)if(i[c].name===n){i[c]=o;break}c===l&&i.push(o)}a.tween=i}}function Is(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r=bt(this.node(),e).tween,i=0,a=r.length,s;i<a;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((n==null?Ts:Rs)(e,t,n))}function Nn(t,n,e){var r=t._id;return t.each(function(){var i=St(this,r);(i.value||(i.value={}))[n]=e.apply(this,arguments)}),function(i){return bt(i,r).value[n]}}function Gr(t,n){var e;return(typeof n=="number"?Tt:n instanceof pe?rr:(e=pe(n))?(n=e,rr):ys)(t,n)}function Vs(t){return function(){this.removeAttribute(t)}}function Ls(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Os(t,n,e){var r,i=e+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===r?a:a=n(r=s,e)}}function Ps(t,n,e){var r,i=e+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?a:a=n(r=s,e)}}function Xs(t,n,e){var r,i,a;return function(){var s,o=e(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===r&&c===i?a:(i=c,a=n(r=s,o)))}}function Us(t,n,e){var r,i,a;return function(){var s,o=e(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===r&&c===i?a:(i=c,a=n(r=s,o)))}}function Ys(t,n){var e=He(t),r=e==="transform"?bs:Gr;return this.attrTween(t,typeof n=="function"?(e.local?Us:Xs)(e,r,Nn(this,"attr."+t,n)):n==null?(e.local?Ls:Vs)(e):(e.local?Ps:Os)(e,r,n))}function Hs(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function qs(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Ws(t,n){var e,r;function i(){var a=n.apply(this,arguments);return a!==r&&(e=(r=a)&&qs(t,a)),e}return i._value=n,i}function Gs(t,n){var e,r;function i(){var a=n.apply(this,arguments);return a!==r&&(e=(r=a)&&Hs(t,a)),e}return i._value=n,i}function Ks(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var r=He(t);return this.tween(e,(r.local?Ws:Gs)(r,n))}function Js(t,n){return function(){Dn(this,t).delay=+n.apply(this,arguments)}}function js(t,n){return n=+n,function(){Dn(this,t).delay=n}}function Zs(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Js:js)(n,t)):bt(this.node(),n).delay}function Qs(t,n){return function(){St(this,t).duration=+n.apply(this,arguments)}}function tl(t,n){return n=+n,function(){St(this,t).duration=n}}function el(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Qs:tl)(n,t)):bt(this.node(),n).duration}function nl(t,n){if(typeof n!="function")throw new Error;return function(){St(this,t).ease=n}}function rl(t){var n=this._id;return arguments.length?this.each(nl(n,t)):bt(this.node(),n).ease}function il(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;St(this,t).ease=e}}function al(t){if(typeof t!="function")throw new Error;return this.each(il(this._id,t))}function ol(t){typeof t!="function"&&(t=$r(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a=n[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new zt(r,this._parents,this._name,this._id)}function sl(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var c=n[o],l=e[o],u=c.length,h=s[o]=new Array(u),d,g=0;g<u;++g)(d=c[g]||l[g])&&(h[g]=d);for(;o<r;++o)s[o]=n[o];return new zt(s,this._parents,this._name,this._id)}function ll(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function ul(t,n,e){var r,i,a=ll(n)?Dn:St;return function(){var s=a(this,t),o=s.on;o!==r&&(i=(r=o).copy()).on(n,e),s.on=i}}function cl(t,n){var e=this._id;return arguments.length<2?bt(this.node(),e).on.on(t):this.each(ul(e,t,n))}function hl(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function dl(){return this.on("end.remove",hl(this._id))}function fl(t){var n=this._name,e=this._id;typeof t!="function"&&(t=Sn(t));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o=r[s],c=o.length,l=a[s]=new Array(c),u,h,d=0;d<c;++d)(u=o[d])&&(h=t.call(u,u.__data__,d,o))&&("__data__"in u&&(h.__data__=u.__data__),l[d]=h,We(l[d],n,e,d,l,bt(u,e)));return new zt(a,this._parents,n,e)}function gl(t){var n=this._name,e=this._id;typeof t!="function"&&(t=kr(t));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var c=r[o],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var d=t.call(u,u.__data__,h,c),g,v=bt(u,e),y=0,S=d.length;y<S;++y)(g=d[y])&&We(g,n,e,y,d,v);a.push(d),s.push(u)}return new zt(a,s,n,e)}var pl=ne.prototype.constructor;function ml(){return new pl(this._groups,this._parents)}function vl(t,n){var e,r,i;return function(){var a=Qt(this,t),s=(this.style.removeProperty(t),Qt(this,t));return a===s?null:a===e&&s===r?i:i=n(e=a,r=s)}}function Kr(t){return function(){this.style.removeProperty(t)}}function yl(t,n,e){var r,i=e+"",a;return function(){var s=Qt(this,t);return s===i?null:s===r?a:a=n(r=s,e)}}function xl(t,n,e){var r,i,a;return function(){var s=Qt(this,t),o=e(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),Qt(this,t))),s===c?null:s===r&&c===i?a:(i=c,a=n(r=s,o))}}function _l(t,n){var e,r,i,a="style."+n,s="end."+a,o;return function(){var c=St(this,t),l=c.on,u=c.value[a]==null?o||(o=Kr(n)):void 0;(l!==e||i!==u)&&(r=(e=l).copy()).on(s,i=u),c.on=r}}function wl(t,n,e){var r=(t+="")=="transform"?ws:Gr;return n==null?this.styleTween(t,vl(t,r)).on("end.style."+t,Kr(t)):typeof n=="function"?this.styleTween(t,xl(t,r,Nn(this,"style."+t,n))).each(_l(this._id,t)):this.styleTween(t,yl(t,r,n),e).on("end.style."+t,null)}function bl(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function Cl(t,n,e){var r,i;function a(){var s=n.apply(this,arguments);return s!==i&&(r=(i=s)&&bl(t,s,e)),r}return a._value=n,a}function El(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,Cl(t,n,e??""))}function kl(t){return function(){this.textContent=t}}function $l(t){return function(){var n=t(this);this.textContent=n??""}}function Sl(t){return this.tween("text",typeof t=="function"?$l(Nn(this,"text",t)):kl(t==null?"":t+""))}function Al(t){return function(n){this.textContent=t.call(this,n)}}function Ml(t){var n,e;function r(){var i=t.apply(this,arguments);return i!==e&&(n=(e=i)&&Al(i)),n}return r._value=t,r}function Bl(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Ml(t))}function Dl(){for(var t=this._name,n=this._id,e=Jr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,c,l=0;l<o;++l)if(c=s[l]){var u=bt(c,n);We(c,t,e,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new zt(r,this._parents,t,e)}function Nl(){var t,n,e=this,r=e._id,i=e.size();return new Promise(function(a,s){var o={value:s},c={value:function(){--i===0&&a()}};e.each(function(){var l=St(this,r),u=l.on;u!==t&&(n=(t=u).copy(),n._.cancel.push(o),n._.interrupt.push(o),n._.end.push(c)),l.on=n}),i===0&&a()})}var zl=0;function zt(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Jr(){return++zl}var At=ne.prototype;zt.prototype={constructor:zt,select:fl,selectAll:gl,selectChild:At.selectChild,selectChildren:At.selectChildren,filter:ol,merge:sl,selection:ml,transition:Dl,call:At.call,nodes:At.nodes,node:At.node,size:At.size,empty:At.empty,each:At.each,on:cl,attr:Ys,attrTween:Ks,style:wl,styleTween:El,text:Sl,textTween:Bl,remove:dl,tween:Is,delay:Zs,duration:el,ease:rl,easeVarying:al,end:Nl,[Symbol.iterator]:At[Symbol.iterator]};function Fl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Tl={time:null,delay:0,duration:250,ease:Fl};function Rl(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function Il(t){var n,e;t instanceof zt?(n=t._id,t=t._name):(n=Jr(),(e=Tl).time=Bn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&We(c,t,n,l,s,e||Rl(c,n));return new zt(r,this._parents,t,n)}ne.prototype.interrupt=Fs;ne.prototype.transition=Il;const fn=Math.PI,gn=2*fn,Ot=1e-6,Vl=gn-Ot;function jr(t){this._+=t[0];for(let n=1,e=t.length;n<e;++n)this._+=arguments[n]+t[n]}function Ll(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return jr;const e=10**n;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*e)/e+r[i]}}class Ol{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?jr:Ll(n)}moveTo(n,e){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+e}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,e){this._append`L${this._x1=+n},${this._y1=+e}`}quadraticCurveTo(n,e,r,i){this._append`Q${+n},${+e},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(n,e,r,i,a,s){this._append`C${+n},${+e},${+r},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(n,e,r,i,a){if(n=+n,e=+e,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,c=r-n,l=i-e,u=s-n,h=o-e,d=u*u+h*h;if(this._x1===null)this._append`M${this._x1=n},${this._y1=e}`;else if(d>Ot)if(!(Math.abs(h*c-l*u)>Ot)||!a)this._append`L${this._x1=n},${this._y1=e}`;else{let g=r-s,v=i-o,y=c*c+l*l,S=g*g+v*v,C=Math.sqrt(y),z=Math.sqrt(d),A=a*Math.tan((fn-Math.acos((y+d-S)/(2*C*z)))/2),w=A/z,I=A/C;Math.abs(w-1)>Ot&&this._append`L${n+w*u},${e+w*h}`,this._append`A${a},${a},0,0,${+(h*g>u*v)},${this._x1=n+I*c},${this._y1=e+I*l}`}}arc(n,e,r,i,a,s){if(n=+n,e=+e,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),c=r*Math.sin(i),l=n+o,u=e+c,h=1^s,d=s?i-a:a-i;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>Ot||Math.abs(this._y1-u)>Ot)&&this._append`L${l},${u}`,r&&(d<0&&(d=d%gn+gn),d>Vl?this._append`A${r},${r},0,1,${h},${n-o},${e-c}A${r},${r},0,1,${h},${this._x1=l},${this._y1=u}`:d>Ot&&this._append`A${r},${r},0,${+(d>=fn)},${h},${this._x1=n+r*Math.cos(a)},${this._y1=e+r*Math.sin(a)}`)}rect(n,e,r,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+e}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Pl(t){var n=0,e=t.children,r=e&&e.length;if(!r)n=1;else for(;--r>=0;)n+=e[r].value;t.value=n}function Xl(){return this.eachAfter(Pl)}function Ul(t,n){let e=-1;for(const r of this)t.call(n,r,++e,this);return this}function Yl(t,n){for(var e=this,r=[e],i,a,s=-1;e=r.pop();)if(t.call(n,e,++s,this),i=e.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function Hl(t,n){for(var e=this,r=[e],i=[],a,s,o,c=-1;e=r.pop();)if(i.push(e),a=e.children)for(s=0,o=a.length;s<o;++s)r.push(a[s]);for(;e=i.pop();)t.call(n,e,++c,this);return this}function ql(t,n){let e=-1;for(const r of this)if(t.call(n,r,++e,this))return r}function Wl(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e})}function Gl(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})}function Kl(t){for(var n=this,e=Jl(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r}function Jl(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;for(t=e.pop(),n=r.pop();t===n;)i=t,t=e.pop(),n=r.pop();return i}function jl(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n}function Zl(){return Array.from(this)}function Ql(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t}function tu(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function*eu(){var t=this,n,e=[t],r,i,a;do for(n=e.reverse(),e=[];t=n.pop();)if(yield t,r=t.children)for(i=0,a=r.length;i<a;++i)e.push(r[i]);while(e.length)}function Zr(t,n){t instanceof Map?(t=[void 0,t],n===void 0&&(n=iu)):n===void 0&&(n=ru);for(var e=new ee(t),r,i=[e],a,s,o,c;r=i.pop();)if((s=n(r.data))&&(c=(s=Array.from(s)).length))for(r.children=s,o=c-1;o>=0;--o)i.push(a=s[o]=new ee(s[o])),a.parent=r,a.depth=r.depth+1;return e.eachBefore(Qr)}function nu(){return Zr(this).eachBefore(au)}function ru(t){return t.children}function iu(t){return Array.isArray(t)?t[1]:null}function au(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Qr(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function ee(t){this.data=t,this.depth=this.height=0,this.parent=null}ee.prototype=Zr.prototype={constructor:ee,count:Xl,each:Ul,eachAfter:Hl,eachBefore:Yl,find:ql,sum:Wl,sort:Gl,path:Kl,ancestors:jl,descendants:Zl,leaves:Ql,links:tu,copy:nu,[Symbol.iterator]:eu};function je(t){return t==null?null:ou(t)}function ou(t){if(typeof t!="function")throw new Error;return t}var su={depth:-1},cr={},Ze={};function lu(t){return t.id}function uu(t){return t.parentId}function cu(){var t=lu,n=uu,e;function r(i){var a=Array.from(i),s=t,o=n,c,l,u,h,d,g,v,y,S=new Map;if(e!=null){const C=a.map((w,I)=>hu(e(w,I,i))),z=C.map(hr),A=new Set(C).add("");for(const w of z)A.has(w)||(A.add(w),C.push(w),z.push(hr(w)),a.push(Ze));s=(w,I)=>C[I],o=(w,I)=>z[I]}for(u=0,c=a.length;u<c;++u)l=a[u],g=a[u]=new ee(l),(v=s(l,u,i))!=null&&(v+="")&&(y=g.id=v,S.set(y,S.has(y)?cr:g)),(v=o(l,u,i))!=null&&(v+="")&&(g.parent=v);for(u=0;u<c;++u)if(g=a[u],v=g.parent){if(d=S.get(v),!d)throw new Error("missing: "+v);if(d===cr)throw new Error("ambiguous: "+v);d.children?d.children.push(g):d.children=[g],g.parent=d}else{if(h)throw new Error("multiple roots");h=g}if(!h)throw new Error("no root");if(e!=null){for(;h.data===Ze&&h.children.length===1;)h=h.children[0],--c;for(let C=a.length-1;C>=0&&(g=a[C],g.data===Ze);--C)g.data=null}if(h.parent=su,h.eachBefore(function(C){C.depth=C.parent.depth+1,--c}).eachBefore(Qr),h.parent=null,c>0)throw new Error("cycle");return h}return r.id=function(i){return arguments.length?(t=je(i),r):t},r.parentId=function(i){return arguments.length?(n=je(i),r):n},r.path=function(i){return arguments.length?(e=je(i),r):e},r}function hu(t){t=`${t}`;let n=t.length;return pn(t,n-1)&&!pn(t,n-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:`/${t}`}function hr(t){let n=t.length;if(n<2)return"";for(;--n>1&&!pn(t,n););return t.slice(0,n)}function pn(t,n){if(t[n]==="/"){let e=0;for(;n>0&&t[--n]==="\\";)++e;if((e&1)===0)return!0}return!1}function du(t,n){return t.parent===n.parent?1:2}function Qe(t){var n=t.children;return n?n[0]:t.t}function tn(t){var n=t.children;return n?n[n.length-1]:t.t}function fu(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function gu(t){for(var n=0,e=0,r=t.children,i=r.length,a;--i>=0;)a=r[i],a.z+=n,a.m+=n,n+=a.s+(e+=a.c)}function pu(t,n,e){return t.a.parent===n.parent?t.a:e}function Be(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}Be.prototype=Object.create(ee.prototype);function mu(t){for(var n=new Be(t,0),e,r=[n],i,a,s,o;e=r.pop();)if(a=e._.children)for(e.children=new Array(o=a.length),s=o-1;s>=0;--s)r.push(i=e.children[s]=new Be(a[s],s)),i.parent=e;return(n.parent=new Be(null,0)).children=[n],n}function vu(){var t=du,n=1,e=1,r=null;function i(l){var u=mu(l);if(u.eachAfter(a),u.parent.m=-u.z,u.eachBefore(s),r)l.eachBefore(c);else{var h=l,d=l,g=l;l.eachBefore(function(z){z.x<h.x&&(h=z),z.x>d.x&&(d=z),z.depth>g.depth&&(g=z)});var v=h===d?1:t(h,d)/2,y=v-h.x,S=n/(d.x+v+y),C=e/(g.depth||1);l.eachBefore(function(z){z.x=(z.x+y)*S,z.y=z.depth*C})}return l}function a(l){var u=l.children,h=l.parent.children,d=l.i?h[l.i-1]:null;if(u){gu(l);var g=(u[0].z+u[u.length-1].z)/2;d?(l.z=d.z+t(l._,d._),l.m=l.z-g):l.z=g}else d&&(l.z=d.z+t(l._,d._));l.parent.A=o(l,d,l.parent.A||h[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function o(l,u,h){if(u){for(var d=l,g=l,v=u,y=d.parent.children[0],S=d.m,C=g.m,z=v.m,A=y.m,w;v=tn(v),d=Qe(d),v&&d;)y=Qe(y),g=tn(g),g.a=l,w=v.z+z-d.z-S+t(v._,d._),w>0&&(fu(pu(v,l,h),l,w),S+=w,C+=w),z+=v.m,S+=d.m,A+=y.m,C+=g.m;v&&!tn(g)&&(g.t=v,g.m+=z-C),d&&!Qe(y)&&(y.t=d,y.m+=S-A,h=l)}return h}function c(l){l.x*=n,l.y=l.depth*e}return i.separation=function(l){return arguments.length?(t=l,i):t},i.size=function(l){return arguments.length?(r=!1,n=+l[0],e=+l[1],i):r?null:[n,e]},i.nodeSize=function(l){return arguments.length?(r=!0,n=+l[0],e=+l[1],i):r?[n,e]:null},i}function dr(t){return function(){return t}}function yu(t){let n=3;return t.digits=function(e){if(!arguments.length)return n;if(e==null)n=null;else{const r=Math.floor(e);if(!(r>=0))throw new RangeError(`invalid digits: ${e}`);n=r}return t},()=>new Ol(n)}var xu=Array.prototype.slice;function _u(t){return t[0]}function wu(t){return t[1]}class bu{constructor(n,e){this._context=n,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,e){switch(n=+n,e=+e,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,e,n,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,n,this._y0,n,e);break}}this._x0=n,this._y0=e}}function Cu(t){return new bu(t,!0)}function Eu(t){return t.source}function ku(t){return t.target}function $u(t){let n=Eu,e=ku,r=_u,i=wu,a=null,s=null,o=yu(c);function c(){let l;const u=xu.call(arguments),h=n.apply(this,u),d=e.apply(this,u);if(a==null&&(s=t(l=o())),s.lineStart(),u[0]=h,s.point(+r.apply(this,u),+i.apply(this,u)),u[0]=d,s.point(+r.apply(this,u),+i.apply(this,u)),s.lineEnd(),l)return s=null,l+""||null}return c.source=function(l){return arguments.length?(n=l,c):n},c.target=function(l){return arguments.length?(e=l,c):e},c.x=function(l){return arguments.length?(r=typeof l=="function"?l:dr(+l),c):r},c.y=function(l){return arguments.length?(i=typeof l=="function"?l:dr(+l),c):i},c.context=function(l){return arguments.length?(l==null?a=s=null:s=t(a=l),c):a},c}function Su(){return $u(Cu)}const Ee=t=>()=>t;function Au(t,{sourceEvent:n,target:e,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Dt(t,n,e){this.k=t,this.x=n,this.y=e}Dt.prototype={constructor:Dt,scale:function(t){return t===1?this:new Dt(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new Dt(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var zn=new Dt(1,0,0);Dt.prototype;function en(t){t.stopImmediatePropagation()}function oe(t){t.preventDefault(),t.stopImmediatePropagation()}function Mu(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Bu(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function fr(){return this.__zoom||zn}function Du(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Nu(){return navigator.maxTouchPoints||"ontouchstart"in this}function zu(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],a=t.invertY(n[0][1])-e[0][1],s=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function Fu(){var t=Mu,n=Bu,e=zu,r=Du,i=Nu,a=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],o=250,c=$s,l=Ye("start","zoom","end"),u,h,d,g=500,v=150,y=0,S=10;function C(p){p.property("__zoom",fr).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",F).on("dblclick.zoom",E).filter(i).on("touchstart.zoom",M).on("touchmove.zoom",G).on("touchend.zoom touchcancel.zoom",tt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}C.transform=function(p,f,m,b){var N=p.selection?p.selection():p;N.property("__zoom",fr),p!==N?I(p,f,m,b):N.interrupt().each(function(){L(this,arguments).event(b).start().zoom(null,typeof f=="function"?f.apply(this,arguments):f).end()})},C.scaleBy=function(p,f,m,b){C.scaleTo(p,function(){var N=this.__zoom.k,T=typeof f=="function"?f.apply(this,arguments):f;return N*T},m,b)},C.scaleTo=function(p,f,m,b){C.transform(p,function(){var N=n.apply(this,arguments),T=this.__zoom,R=m==null?w(N):typeof m=="function"?m.apply(this,arguments):m,Y=T.invert(R),q=typeof f=="function"?f.apply(this,arguments):f;return e(A(z(T,q),R,Y),N,s)},m,b)},C.translateBy=function(p,f,m,b){C.transform(p,function(){return e(this.__zoom.translate(typeof f=="function"?f.apply(this,arguments):f,typeof m=="function"?m.apply(this,arguments):m),n.apply(this,arguments),s)},null,b)},C.translateTo=function(p,f,m,b,N){C.transform(p,function(){var T=n.apply(this,arguments),R=this.__zoom,Y=b==null?w(T):typeof b=="function"?b.apply(this,arguments):b;return e(zn.translate(Y[0],Y[1]).scale(R.k).translate(typeof f=="function"?-f.apply(this,arguments):-f,typeof m=="function"?-m.apply(this,arguments):-m),T,s)},b,N)};function z(p,f){return f=Math.max(a[0],Math.min(a[1],f)),f===p.k?p:new Dt(f,p.x,p.y)}function A(p,f,m){var b=f[0]-m[0]*p.k,N=f[1]-m[1]*p.k;return b===p.x&&N===p.y?p:new Dt(p.k,b,N)}function w(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function I(p,f,m,b){p.on("start.zoom",function(){L(this,arguments).event(b).start()}).on("interrupt.zoom end.zoom",function(){L(this,arguments).event(b).end()}).tween("zoom",function(){var N=this,T=arguments,R=L(N,T).event(b),Y=n.apply(N,T),q=m==null?w(Y):typeof m=="function"?m.apply(N,T):m,et=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),K=N.__zoom,k=typeof f=="function"?f.apply(N,T):f,B=c(K.invert(q).concat(et/K.k),k.invert(q).concat(et/k.k));return function(H){if(H===1)H=k;else{var U=B(H),nt=et/U[2];H=new Dt(nt,q[0]-U[0]*nt,q[1]-U[1]*nt)}R.zoom(null,H)}})}function L(p,f,m){return!m&&p.__zooming||new x(p,f)}function x(p,f){this.that=p,this.args=f,this.active=0,this.sourceEvent=null,this.extent=n.apply(p,f),this.taps=0}x.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,f){return this.mouse&&p!=="mouse"&&(this.mouse[1]=f.invert(this.mouse[0])),this.touch0&&p!=="touch"&&(this.touch0[1]=f.invert(this.touch0[0])),this.touch1&&p!=="touch"&&(this.touch1[1]=f.invert(this.touch1[0])),this.that.__zoom=f,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var f=it(this.that).datum();l.call(p,this.that,new Au(p,{sourceEvent:this.sourceEvent,target:C,transform:this.that.__zoom,dispatch:l}),f)}};function _(p,...f){if(!t.apply(this,arguments))return;var m=L(this,f).event(p),b=this.__zoom,N=Math.max(a[0],Math.min(a[1],b.k*Math.pow(2,r.apply(this,arguments)))),T=Mt(p);if(m.wheel)(m.mouse[0][0]!==T[0]||m.mouse[0][1]!==T[1])&&(m.mouse[1]=b.invert(m.mouse[0]=T)),clearTimeout(m.wheel);else{if(b.k===N)return;m.mouse=[T,b.invert(T)],Me(this),m.start()}oe(p),m.wheel=setTimeout(R,v),m.zoom("mouse",e(A(z(b,N),m.mouse[0],m.mouse[1]),m.extent,s));function R(){m.wheel=null,m.end()}}function F(p,...f){if(d||!t.apply(this,arguments))return;var m=p.currentTarget,b=L(this,f,!0).event(p),N=it(p.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",et,!0),T=Mt(p,m),R=p.clientX,Y=p.clientY;Rr(p.view),en(p),b.mouse=[T,this.__zoom.invert(T)],Me(this),b.start();function q(K){if(oe(K),!b.moved){var k=K.clientX-R,B=K.clientY-Y;b.moved=k*k+B*B>y}b.event(K).zoom("mouse",e(A(b.that.__zoom,b.mouse[0]=Mt(K,m),b.mouse[1]),b.extent,s))}function et(K){N.on("mousemove.zoom mouseup.zoom",null),Ir(K.view,b.moved),oe(K),b.event(K).end()}}function E(p,...f){if(t.apply(this,arguments)){var m=this.__zoom,b=Mt(p.changedTouches?p.changedTouches[0]:p,this),N=m.invert(b),T=m.k*(p.shiftKey?.5:2),R=e(A(z(m,T),b,N),n.apply(this,f),s);oe(p),o>0?it(this).transition().duration(o).call(I,R,b,p):it(this).call(C.transform,R,b,p)}}function M(p,...f){if(t.apply(this,arguments)){var m=p.touches,b=m.length,N=L(this,f,p.changedTouches.length===b).event(p),T,R,Y,q;for(en(p),R=0;R<b;++R)Y=m[R],q=Mt(Y,this),q=[q,this.__zoom.invert(q),Y.identifier],N.touch0?!N.touch1&&N.touch0[2]!==q[2]&&(N.touch1=q,N.taps=0):(N.touch0=q,T=!0,N.taps=1+!!u);u&&(u=clearTimeout(u)),T&&(N.taps<2&&(h=q[0],u=setTimeout(function(){u=null},g)),Me(this),N.start())}}function G(p,...f){if(this.__zooming){var m=L(this,f).event(p),b=p.changedTouches,N=b.length,T,R,Y,q;for(oe(p),T=0;T<N;++T)R=b[T],Y=Mt(R,this),m.touch0&&m.touch0[2]===R.identifier?m.touch0[0]=Y:m.touch1&&m.touch1[2]===R.identifier&&(m.touch1[0]=Y);if(R=m.that.__zoom,m.touch1){var et=m.touch0[0],K=m.touch0[1],k=m.touch1[0],B=m.touch1[1],H=(H=k[0]-et[0])*H+(H=k[1]-et[1])*H,U=(U=B[0]-K[0])*U+(U=B[1]-K[1])*U;R=z(R,Math.sqrt(H/U)),Y=[(et[0]+k[0])/2,(et[1]+k[1])/2],q=[(K[0]+B[0])/2,(K[1]+B[1])/2]}else if(m.touch0)Y=m.touch0[0],q=m.touch0[1];else return;m.zoom("touch",e(A(R,Y,q),m.extent,s))}}function tt(p,...f){if(this.__zooming){var m=L(this,f).event(p),b=p.changedTouches,N=b.length,T,R;for(en(p),d&&clearTimeout(d),d=setTimeout(function(){d=null},g),T=0;T<N;++T)R=b[T],m.touch0&&m.touch0[2]===R.identifier?delete m.touch0:m.touch1&&m.touch1[2]===R.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&(R=Mt(R,this),Math.hypot(h[0]-R[0],h[1]-R[1])<S)){var Y=it(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return C.wheelDelta=function(p){return arguments.length?(r=typeof p=="function"?p:Ee(+p),C):r},C.filter=function(p){return arguments.length?(t=typeof p=="function"?p:Ee(!!p),C):t},C.touchable=function(p){return arguments.length?(i=typeof p=="function"?p:Ee(!!p),C):i},C.extent=function(p){return arguments.length?(n=typeof p=="function"?p:Ee([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),C):n},C.scaleExtent=function(p){return arguments.length?(a[0]=+p[0],a[1]=+p[1],C):[a[0],a[1]]},C.translateExtent=function(p){return arguments.length?(s[0][0]=+p[0][0],s[1][0]=+p[1][0],s[0][1]=+p[0][1],s[1][1]=+p[1][1],C):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},C.constrain=function(p){return arguments.length?(e=p,C):e},C.duration=function(p){return arguments.length?(o=+p,C):o},C.interpolate=function(p){return arguments.length?(c=p,C):c},C.on=function(){var p=l.on.apply(l,arguments);return p===l?C:p},C.clickDistance=function(p){return arguments.length?(y=(p=+p)*p,C):Math.sqrt(y)},C.tapDistance=function(p){return arguments.length?(S=+p,C):S},C}function Tu(t){var n=0,e=t.children,r=e&&e.length;if(!r)n=1;else for(;--r>=0;)n+=e[r].value;t.value=n}function Ru(){return this.eachAfter(Tu)}function Iu(t){var n=this,e,r=[n],i,a,s;do for(e=r.reverse(),r=[];n=e.pop();)if(t(n),i=n.children,i)for(a=0,s=i.length;a<s;++a)r.push(i[a]);while(r.length);return this}function Vu(t){for(var n=this,e=[n],r,i;n=e.pop();)if(t(n),r=n.children,r)for(i=r.length-1;i>=0;--i)e.push(r[i]);return this}function Lu(t){for(var n=this,e=[n],r=[],i,a,s;n=e.pop();)if(r.push(n),i=n.children,i)for(a=0,s=i.length;a<s;++a)e.push(i[a]);for(;n=r.pop();)t(n);return this}function Ou(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e})}function Pu(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})}function Xu(t){for(var n=this,e=Uu(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r}function Uu(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;for(t=e.pop(),n=r.pop();t===n;)i=t,t=e.pop(),n=r.pop();return i}function Yu(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n}function Hu(){var t=[];return this.each(function(n){t.push(n)}),t}function qu(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t}function Wu(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function Fn(t,n){var e=new Pe(t),r=+t.value&&(e.value=t.value),i,a=[e],s,o,c,l;for(n==null&&(n=Ku);i=a.pop();)if(r&&(i.value=+i.data.value),(o=n(i.data))&&(l=o.length))for(i.children=new Array(l),c=l-1;c>=0;--c)a.push(s=i.children[c]=new Pe(o[c])),s.parent=i,s.depth=i.depth+1;return e.eachBefore(ju)}function Gu(){return Fn(this).eachBefore(Ju)}function Ku(t){return t.children}function Ju(t){t.data=t.data.data}function ju(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function Pe(t){this.data=t,this.depth=this.height=0,this.parent=null}Pe.prototype=Fn.prototype={constructor:Pe,count:Ru,each:Iu,eachAfter:Lu,eachBefore:Vu,sum:Ou,sort:Pu,path:Xu,ancestors:Yu,descendants:Hu,leaves:qu,links:Wu,copy:Gu};const Zu="2.1.2",Qu={version:Zu},{version:tc}=Qu,ec=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function Tn(t){const n=Object.assign({},ec,t);function e(o){const c=n[o];return typeof c=="function"?c:()=>c}function r(o){const c=s(a(),o,l=>l.children);return c.update(),c.data}function i(){const o=e("nodeSize"),c=e("spacing");return class ti extends Fn.prototype.constructor{constructor(u){super(u)}copy(){const u=s(this.constructor,this,h=>h.children);return u.each(h=>h.data=h.data.data),u}get size(){return o(this)}spacing(u){return c(this,u)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const u=this.ancestors();return u[u.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((u,h)=>ti.maxExtents(u,h.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(u,h){return{top:Math.min(u.top,h.top),bottom:Math.max(u.bottom,h.bottom),left:Math.min(u.left,h.left),right:Math.max(u.right,h.right)}}}}function a(){const o=i(),c=e("nodeSize"),l=e("spacing");return class extends o{constructor(u){super(u),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return c(this.data)}spacing(u){return l(this.data,u.data)}get x(){return this.data.x}set x(u){this.data.x=u}get y(){return this.data.y}set y(u){this.data.y=u}update(){return ei(this),ni(this),this}}}function s(o,c,l){const u=(h,d)=>{const g=new o(h);Object.assign(g,{parent:d,depth:d===null?0:d.depth+1,height:0,length:1});const v=l(h)||[];return g.children=v.length===0?null:v.map(y=>u(y,g)),g.children&&Object.assign(g,g.children.reduce((y,S)=>({height:Math.max(y.height,S.height+1),length:y.length+S.length}),g)),g};return u(c,null)}return Object.assign(r,{nodeSize(o){return arguments.length?(n.nodeSize=o,r):n.nodeSize},spacing(o){return arguments.length?(n.spacing=o,r):n.spacing},children(o){return arguments.length?(n.children=o,r):n.children},hierarchy(o,c){const l=typeof c>"u"?n.children:c;return s(i(),o,l)},dump(o){const c=e("nodeSize"),l=u=>h=>{const d=u+"  ",g=u+"    ",{x:v,y}=h,S=c(h),C=h.children||[],z=C.length===0?" ":`,${d}children: [${g}${C.map(l(g)).join(g)}${d}],${u}`;return`{ size: [${S.join(", ")}],${d}x: ${v}, y: ${y}${z}},`};return l(`
`)(o)}}),r}Tn.version=tc;const ei=(t,n=0)=>(t.y=n,(t.children||[]).reduce((e,r)=>{const[i,a]=e;ei(r,t.y+t.ySize);const s=(i===0?r.lExt:r.rExt).bottom;i!==0&&rc(t,i,a);const o=hc(s,i,a);return[i+1,o]},[0,null]),nc(t),cc(t),t),ni=(t,n,e)=>{typeof n>"u"&&(n=-t.relX-t.prelim,e=0);const r=n+t.relX;return t.relX=r+t.prelim-e,t.prelim=0,t.x=e+t.relX,(t.children||[]).forEach(i=>ni(i,r,t.x)),t},nc=t=>{(t.children||[]).reduce((n,e)=>{const[r,i]=n,a=r+e.shift,s=i+a+e.change;return e.relX+=s,[a,s]},[0,0])},rc=(t,n,e)=>{const r=t.children[n-1],i=t.children[n];let a=r,s=r.relX,o=i,c=i.relX,l=!0;for(;a&&o;){a.bottom>e.lowY&&(e=e.next);const u=s+a.prelim-(c+o.prelim)+a.xSize/2+o.xSize/2+a.spacing(o);(u>0||u<0&&l)&&(c+=u,ic(i,u),ac(t,n,e.index,u)),l=!1;const h=a.bottom,d=o.bottom;h<=d&&(a=sc(a),a&&(s+=a.relX)),h>=d&&(o=oc(o),o&&(c+=o.relX))}!a&&o?lc(t,n,o,c):a&&!o&&uc(t,n,a,s)},ic=(t,n)=>{t.relX+=n,t.lExtRelX+=n,t.rExtRelX+=n},ac=(t,n,e,r)=>{const i=t.children[n],a=n-e;if(a>1){const s=r/a;t.children[e+1].shift+=s,i.shift-=s,i.change-=r-s}},oc=t=>t.hasChildren?t.firstChild:t.lThr,sc=t=>t.hasChildren?t.lastChild:t.rThr,lc=(t,n,e,r)=>{const i=t.firstChild,a=i.lExt,s=t.children[n];a.lThr=e;const o=r-e.relX-i.lExtRelX;a.relX+=o,a.prelim-=o,i.lExt=s.lExt,i.lExtRelX=s.lExtRelX},uc=(t,n,e,r)=>{const i=t.children[n],a=i.rExt,s=t.children[n-1];a.rThr=e;const o=r-e.relX-i.rExtRelX;a.relX+=o,a.prelim-=o,i.rExt=s.rExt,i.rExtRelX=s.rExtRelX},cc=t=>{if(t.hasChildren){const n=t.firstChild,e=t.lastChild,r=(n.prelim+n.relX-n.xSize/2+e.relX+e.prelim+e.xSize/2)/2;Object.assign(t,{prelim:r,lExt:n.lExt,lExtRelX:n.lExtRelX,rExt:e.rExt,rExtRelX:e.rExtRelX})}},hc=(t,n,e)=>{for(;e!==null&&t>=e.lowY;)e=e.next;return{lowY:t,index:n,next:e}},j={selection:ne,select:it,max:la,min:ua,sum:ca,cumsum:sa,tree:vu,stratify:cu,zoom:Fu,zoomIdentity:zn,linkHorizontal:Su,flextree:Tn};class dc{constructor(){const n={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:e=>e.nodeId||e.id,parentNodeId:e=>e.parentNodeId||e.parentId,rootMargin:40,nodeWidth:e=>250,nodeHeight:e=>150,neighbourMargin:(e,r)=>80,siblingsMargin:e=>20,childrenMargin:e=>60,compactMarginPair:e=>100,compactMarginBetween:(e=>20),nodeButtonWidth:e=>40,nodeButtonHeight:e=>40,nodeButtonX:e=>-20,nodeButtonY:e=>-20,linkYOffset:30,pagingStep:e=>5,minPagingVisibleNodes:e=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:e=>j.zoom(),onZoomStart:e=>{},onZoom:e=>{},onZoomEnd:e=>{},onNodeClick:e=>e,onExpandOrCollapse:e=>e,nodeContent:e=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${e.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:e,state:r})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:a=>a?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`,bottom:a=>a?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${e.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${e.data._directSubordinatesPaging} </span></div>
                    `,right:a=>a?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`,top:a=>a?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${e.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${e.data._directSubordinatesPaging} </span></div>
                    `}[r.layout](e.children)}  </div>`,pagingButton:(e,r,i,a)=>{const s=a.pagingStep(e.parent),o=e.parent.data._pagingStep,c=e.parent.data._directSubordinatesPaging-o;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(c,s)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(e,r,i){j.select(this).select(".node-rect").attr("stroke",a=>a.data._highlighted||a.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",e.data._highlighted||e.data._upToTheRootHighlighted?10:1)},nodeEnter:e=>e,nodeExit:e=>e,linkUpdate:function(e,r,i){j.select(this).attr("stroke",a=>a.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",a=>a.data._upToTheRootHighlighted?5:1),e.data._upToTheRootHighlighted&&j.select(this).raise()},hdiagonal:function(e,r,i){const a=e.x,s=e.y,o=r.x,c=r.y;let l=i&&i.x!=null?i.x:a,u=i&&i.y!=null?i.y:s,h=o-a<0?-1:1,d=c-s<0?-1:1,g=35,v=Math.abs(o-a)/2<g?Math.abs(o-a)/2:g;v=Math.abs(c-s)/2<v?Math.abs(c-s)/2:v;let y=Math.abs(o-a)/2-v;return`
                          M ${l} ${u}
                          L ${l} ${s}
                          L ${a} ${s}
                          L ${a+y*h} ${s}
                          C ${a+y*h+v*h} ${s} 
                            ${a+y*h+v*h} ${s} 
                            ${a+y*h+v*h} ${s+v*d}
                          L ${a+y*h+v*h} ${c-v*d} 
                          C ${a+y*h+v*h}  ${c} 
                            ${a+y*h+v*h}  ${c} 
                            ${o-y*h}  ${c}
                          L ${o} ${c}
               `},diagonal:function(e,r,i,a={sy:0}){const s=e.x;let o=e.y;const c=r.x,l=r.y;let u=i&&i.x!=null?i.x:s,h=i&&i.y!=null?i.y:o,d=c-s<0?-1:1,g=l-o<0?-1:1;o+=a.sy;let v=35,y=Math.abs(c-s)/2<v?Math.abs(c-s)/2:v;y=Math.abs(l-o)/2<y?Math.abs(l-o)/2:y;let S=Math.abs(l-o)/2-y,C=Math.abs(c-s)-y*2;return`
                          M ${u} ${h}
                          L ${s} ${h}
                          L ${s} ${o}
                          L ${s} ${o+S*g}
                          C  ${s} ${o+S*g+y*g} ${s} ${o+S*g+y*g} ${s+y*d} ${o+S*g+y*g}
                          L ${s+C*d+y*d} ${o+S*g+y*g}
                          C  ${c}  ${o+S*g+y*g} ${c}  ${o+S*g+y*g} ${c} ${l-S*g}
                          L ${c} ${l}
               `},defs:function(e,r){return`<defs>
                    ${r.map(i=>{const a=this.getTextWidth(i.label,{ctx:e.ctx,fontSize:2,defaultFont:e.defaultFont});return`
                       <marker id="${i.from+"_"+i.to}" refX="${i._source.x<i._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${i._source.x<i._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${i.label?a+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${i.label||""}</text>
                       </marker>

                       <marker id="arrow-${i.from+"_"+i.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${i._source.x<i._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(e,r,i){j.select(this).attr("stroke",a=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",a=>"5").attr("pointer-events","none").attr("marker-start",a=>`url(#${a.from+"_"+a.to})`).attr("marker-end",a=>`url(#arrow-${a.from+"_"+a.to})`)},linkGroupArc:j.linkHorizontal().x(e=>e.x).y(e=>e.y),layoutBindings:{left:{nodeLeftX:e=>0,nodeRightX:e=>e.width,nodeTopY:e=>-e.height/2,nodeBottomY:e=>e.height/2,nodeJoinX:e=>e.x+e.width,nodeJoinY:e=>e.y-e.height/2,linkJoinX:e=>e.x+e.width,linkJoinY:e=>e.y,linkX:e=>e.x,linkY:e=>e.y,linkCompactXStart:e=>e.x+e.width/2,linkCompactYStart:e=>e.y+(e.compactEven?e.height/2:-e.height/2),compactLinkMidX:(e,r)=>e.firstCompactNode.x,compactLinkMidY:(e,r)=>e.firstCompactNode.y+e.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(e)/4,linkParentX:e=>e.parent.x+e.parent.width,linkParentY:e=>e.parent.y,buttonX:e=>e.width,buttonY:e=>e.height/2,centerTransform:({root:e,rootMargin:r,centerY:i,scale:a,centerX:s})=>`translate(${r},${i}) scale(${a})`,compactDimension:{sizeColumn:e=>e.height,sizeRow:e=>e.width,reverse:e=>e.slice().reverse()},nodeFlexSize:({height:e,width:r,siblingsMargin:i,childrenMargin:a,state:s,node:o})=>s.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[e+i,r+a],zoomTransform:({centerY:e,scale:r})=>`translate(0,${e}) scale(${r})`,diagonal:this.hdiagonal.bind(this),swap:e=>{const r=e.x;e.x=e.y,e.y=r},nodeUpdateTransform:({x:e,y:r,width:i,height:a})=>`translate(${e},${r-a/2})`},top:{nodeLeftX:e=>-e.width/2,nodeRightX:e=>e.width/2,nodeTopY:e=>0,nodeBottomY:e=>e.height,nodeJoinX:e=>e.x-e.width/2,nodeJoinY:e=>e.y+e.height,linkJoinX:e=>e.x,linkJoinY:e=>e.y+e.height,linkCompactXStart:e=>e.x+(e.compactEven?e.width/2:-e.width/2),linkCompactYStart:e=>e.y+e.height/2,compactLinkMidX:(e,r)=>e.firstCompactNode.x+e.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(e)/4,compactLinkMidY:e=>e.firstCompactNode.y,compactDimension:{sizeColumn:e=>e.width,sizeRow:e=>e.height,reverse:e=>e},linkX:e=>e.x,linkY:e=>e.y,linkParentX:e=>e.parent.x,linkParentY:e=>e.parent.y+e.parent.height,buttonX:e=>e.width/2,buttonY:e=>e.height,centerTransform:({root:e,rootMargin:r,centerY:i,scale:a,centerX:s})=>`translate(${s},${r}) scale(${a})`,nodeFlexSize:({height:e,width:r,siblingsMargin:i,childrenMargin:a,state:s,node:o,compactViewIndex:c})=>s.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[r+i,e+a],zoomTransform:({centerX:e,scale:r})=>`translate(${e},0}) scale(${r})`,diagonal:this.diagonal.bind(this),swap:e=>{},nodeUpdateTransform:({x:e,y:r,width:i,height:a})=>`translate(${e-i/2},${r})`},bottom:{nodeLeftX:e=>-e.width/2,nodeRightX:e=>e.width/2,nodeTopY:e=>-e.height,nodeBottomY:e=>0,nodeJoinX:e=>e.x-e.width/2,nodeJoinY:e=>e.y-e.height-e.height,linkJoinX:e=>e.x,linkJoinY:e=>e.y-e.height,linkCompactXStart:e=>e.x+(e.compactEven?e.width/2:-e.width/2),linkCompactYStart:e=>e.y-e.height/2,compactLinkMidX:(e,r)=>e.firstCompactNode.x+e.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(e)/4,compactLinkMidY:e=>e.firstCompactNode.y,linkX:e=>e.x,linkY:e=>e.y,compactDimension:{sizeColumn:e=>e.width,sizeRow:e=>e.height,reverse:e=>e},linkParentX:e=>e.parent.x,linkParentY:e=>e.parent.y-e.parent.height,buttonX:e=>e.width/2,buttonY:e=>0,centerTransform:({root:e,rootMargin:r,centerY:i,scale:a,centerX:s,chartHeight:o})=>`translate(${s},${o-r}) scale(${a})`,nodeFlexSize:({height:e,width:r,siblingsMargin:i,childrenMargin:a,state:s,node:o})=>s.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[r+i,e+a],zoomTransform:({centerX:e,scale:r})=>`translate(${e},0}) scale(${r})`,diagonal:this.diagonal.bind(this),swap:e=>{e.y=-e.y},nodeUpdateTransform:({x:e,y:r,width:i,height:a})=>`translate(${e-i/2},${r-a})`},right:{nodeLeftX:e=>-e.width,nodeRightX:e=>0,nodeTopY:e=>-e.height/2,nodeBottomY:e=>e.height/2,nodeJoinX:e=>e.x-e.width-e.width,nodeJoinY:e=>e.y-e.height/2,linkJoinX:e=>e.x-e.width,linkJoinY:e=>e.y,linkX:e=>e.x,linkY:e=>e.y,linkParentX:e=>e.parent.x-e.parent.width,linkParentY:e=>e.parent.y,buttonX:e=>0,buttonY:e=>e.height/2,linkCompactXStart:e=>e.x-e.width/2,linkCompactYStart:e=>e.y+(e.compactEven?e.height/2:-e.height/2),compactLinkMidX:(e,r)=>e.firstCompactNode.x,compactLinkMidY:(e,r)=>e.firstCompactNode.y+e.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(e)/4,centerTransform:({root:e,rootMargin:r,centerY:i,scale:a,centerX:s,chartWidth:o})=>`translate(${o-r},${i}) scale(${a})`,nodeFlexSize:({height:e,width:r,siblingsMargin:i,childrenMargin:a,state:s,node:o})=>s.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[e+i,r+a],compactDimension:{sizeColumn:e=>e.height,sizeRow:e=>e.width,reverse:e=>e.slice().reverse()},zoomTransform:({centerY:e,scale:r})=>`translate(0,${e}) scale(${r})`,diagonal:this.hdiagonal.bind(this),swap:e=>{const r=e.x;e.x=-e.y,e.y=r},nodeUpdateTransform:({x:e,y:r,width:i,height:a})=>`translate(${e-i},${r-a/2})`}}};this.getChartState=()=>n,Object.keys(n).forEach(e=>{this[e]=function(r){if(arguments.length)n[e]=r;else return n[e];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){j.selection.prototype.patternify=function(n){var e=this,r=n.selector,i=n.tag,a=n.data||[r],s=e.selectAll("."+r).data(a,(o,c)=>typeof o=="object"&&o.id?o.id:c);return s.exit().remove(),s=s.enter().append(i).merge(s),s.attr("class",r),s}}getNodeChildren({data:n,children:e,_children:r},i){return i.push(n),e&&e.forEach(a=>{this.getNodeChildren(a,i)}),r&&r.forEach(a=>{this.getNodeChildren(a,i)}),i}initialZoom(n){const e=this.getChartState();return e.lastTransform.k=n,this}render(){const n=this.getChartState();if(!n.data||n.data.length==0)return console.log("ORG CHART - Data is empty"),n.container&&(it(n.container).select(".nodes-wrapper").remove(),it(n.container).select(".links-wrapper").remove(),it(n.container).select(".connections-wrapper").remove()),this;const e=j.select(n.container),r=e.node().getBoundingClientRect();r.width>0&&(n.svgWidth=r.width);const i={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:n.svgWidth,chartHeight:n.svgHeight};if(n.calc=i,i.centerX=i.chartWidth/2,i.centerY=i.chartHeight/2,n.firstDraw){const o={zoom:null};o.zoom=n.createZoom().clickDistance(10).on("start",(c,l)=>n.onZoomStart(c)).on("end",(c,l)=>n.onZoomEnd(c)).on("zoom",(c,l)=>{n.onZoom(c),this.zoomed(c,l)}).scaleExtent(n.scaleExtent),n.zoomBehavior=o.zoom}n.flexTreeLayout=Tn({nodeSize:o=>{const c=n.nodeWidth(o),l=n.nodeHeight(o),u=n.siblingsMargin(o),h=n.childrenMargin(o);return n.layoutBindings[n.layout].nodeFlexSize({state:n,node:o,width:c,height:l,siblingsMargin:u,childrenMargin:h})}}).spacing((o,c)=>o.parent==c.parent?0:n.neighbourMargin(o,c)),this.setLayouts({expandNodesFirst:!1});const a=e.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",n.svgWidth).attr("height",n.svgHeight).attr("font-family",n.defaultFont);n.firstDraw&&a.call(n.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),n.svg=a;const s=a.patternify({tag:"g",selector:"chart"});return n.centerG=s.patternify({tag:"g",selector:"center-group"}),n.linksWrapper=n.centerG.patternify({tag:"g",selector:"links-wrapper"}),n.nodesWrapper=n.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),n.connectionsWrapper=n.centerG.patternify({tag:"g",selector:"connections-wrapper"}),n.defsWrapper=a.patternify({tag:"g",selector:"defs-wrapper"}),n.firstDraw&&n.centerG.attr("transform",()=>n.layoutBindings[n.layout].centerTransform({centerX:i.centerX,centerY:i.centerY,scale:n.lastTransform.k,rootMargin:n.rootMargin,root:n.root,chartHeight:i.chartHeight,chartWidth:i.chartWidth})),n.chart=s,this.update(n.root),j.select(window).on(`resize.${n.id}`,()=>{const o=j.select(n.container).node().getBoundingClientRect();n.svg.attr("width",o.width)}),n.firstDraw&&(n.firstDraw=!1),this}addNode(n){const e=this.getChartState();if(n&&(e.parentNodeId(n)==null||e.parentNodeId(n)==e.nodeId(n))&&e.data.length==0)return e.data.push(n),this.render(),this;const i=e.generateRoot(e.data).descendants(),a=i.filter(({data:s})=>e.nodeId(s).toString()===e.nodeId(n).toString())[0];return i.filter(({data:s})=>e.nodeId(s).toString()===e.parentNodeId(n).toString())[0],a?(console.log(`ORG CHART - ADD - Node with id "${e.nodeId(n)}" already exists in tree`),this):(n._centered&&!n._expanded&&(n._expanded=!0),e.data.push(n),this.updateNodesState(),this)}removeNode(n){const e=this.getChartState(),a=e.generateRoot(e.data).descendants().filter(({data:o})=>e.nodeId(o)==n)[0];return a?(a.descendants().forEach(o=>o.data._filteredOut=!0),e.data=e.data.filter(o=>!o._filteredOut),e.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${n}" not found in the tree`),this)}groupBy(n,e,r){const i={};return n.forEach(a=>{const s=e(a);i[s]||(i[s]=[]),i[s].push(a)}),Object.keys(i).forEach(a=>{i[a]=r(i[a])}),Object.entries(i)}calculateCompactFlexDimensions(n){const e=this.getChartState();n.eachBefore(r=>{r.firstCompact=null,r.compactEven=null,r.flexCompactDim=null,r.firstCompactNode=null}),n.eachBefore(r=>{if(r.children&&r.children.length>1){const i=r.children.filter(u=>!u.children);if(i.length<2)return;i.forEach((u,h)=>{h||(u.firstCompact=!0),h%2?u.compactEven=!1:u.compactEven=!0,u.row=Math.floor(h/2)});const a=j.max(i.filter(u=>u.compactEven),e.layoutBindings[e.layout].compactDimension.sizeColumn),s=j.max(i.filter(u=>!u.compactEven),e.layoutBindings[e.layout].compactDimension.sizeColumn),o=Math.max(a,s)*2,c=this.groupBy(i,u=>u.row,u=>j.max(u,h=>e.layoutBindings[e.layout].compactDimension.sizeRow(h)+e.compactMarginBetween(h))),l=j.sum(c.map(u=>u[1]));i.forEach(u=>{u.firstCompactNode=i[0],u.firstCompact?u.flexCompactDim=[o+e.compactMarginPair(u),l-e.compactMarginBetween(u)]:u.flexCompactDim=[0,0]}),r.flexCompactDim=null}})}calculateCompactFlexPositions(n){const e=this.getChartState();n.eachBefore(r=>{if(r.children){const i=r.children.filter(u=>u.flexCompactDim),a=i[0];if(!a)return;i.forEach((u,h,d)=>{h==0&&(a.x-=a.flexCompactDim[0]/2),h&h%2-1?u.x=a.x+a.flexCompactDim[0]*.25-e.compactMarginPair(u)/4:h&&(u.x=a.x+a.flexCompactDim[0]*.75+e.compactMarginPair(u)/4)});const s=a.x+a.flexCompactDim[0]*.5;a.x=a.x+a.flexCompactDim[0]*.25-e.compactMarginPair(a)/4;const o=r.x-s;Math.abs(o)<10&&i.forEach(u=>u.x+=o);const c=this.groupBy(i,u=>u.row,u=>j.max(u,h=>e.layoutBindings[e.layout].compactDimension.sizeRow(h))),l=j.cumsum(c.map(u=>u[1]+e.compactMarginBetween(u)));i.forEach((u,h)=>{u.row?u.y=a.y+l[u.row-1]:u.y=a.y})}})}update({x0:n,y0:e,x:r=0,y:i=0,width:a,height:s}){const o=this.getChartState();o.calc,o.compact&&this.calculateCompactFlexDimensions(o.root);const c=o.flexTreeLayout(o.root);o.compact&&this.calculateCompactFlexPositions(o.root);const l=c.descendants(),u=c.descendants().slice(1);l.forEach(o.layoutBindings[o.layout].swap);const h=o.connections,d={};o.allNodes.forEach(f=>d[o.nodeId(f.data)]=f);const g={};l.forEach(f=>g[o.nodeId(f.data)]=f),h.forEach(f=>{const m=d[f.from],b=d[f.to];f._source=m,f._target=b});const v=h.filter(f=>g[f.from]&&g[f.to]),y=o.defs.bind(this)(o,v),S=o.defsWrapper.html();y!==S&&o.defsWrapper.html(y);const C=o.linksWrapper.selectAll("path.link").data(u,f=>o.nodeId(f.data)),A=C.enter().insert("path","g").attr("class","link").attr("d",f=>{const m=o.layoutBindings[o.layout].linkJoinX({x:n,y:e,width:a,height:s}),b=o.layoutBindings[o.layout].linkJoinY({x:n,y:e,width:a,height:s}),N={x:m,y:b};return o.layoutBindings[o.layout].diagonal(N,N,N)}).merge(C);A.attr("fill","none"),this.isEdge()?A.style("display",f=>f.data._pagingButton?"none":"auto"):A.attr("display",f=>f.data._pagingButton?"none":"auto"),A.each(o.linkUpdate),A.transition().duration(o.duration).attr("d",f=>{const m=o.compact&&f.flexCompactDim?{x:o.layoutBindings[o.layout].compactLinkMidX(f,o),y:o.layoutBindings[o.layout].compactLinkMidY(f,o)}:{x:o.layoutBindings[o.layout].linkX(f),y:o.layoutBindings[o.layout].linkY(f)},b={x:o.layoutBindings[o.layout].linkParentX(f),y:o.layoutBindings[o.layout].linkParentY(f)},N=o.compact&&f.flexCompactDim?{x:o.layoutBindings[o.layout].linkCompactXStart(f),y:o.layoutBindings[o.layout].linkCompactYStart(f)}:m;return o.layoutBindings[o.layout].diagonal(m,b,N,{sy:o.linkYOffset})}),C.exit().transition().duration(o.duration).attr("d",f=>{const m=o.layoutBindings[o.layout].linkJoinX({x:r,y:i,width:a,height:s}),b=o.layoutBindings[o.layout].linkJoinY({x:r,y:i,width:a,height:s}),N={x:m,y:b};return o.layoutBindings[o.layout].diagonal(N,N,null,{sy:o.linkYOffset})}).remove();const w=o.connectionsWrapper.selectAll("path.connection").data(v),L=w.enter().insert("path","g").attr("class","connection").attr("d",f=>{const m=o.layoutBindings[o.layout].linkJoinX({x:n,y:e,width:a,height:s}),b=o.layoutBindings[o.layout].linkJoinY({x:n,y:e,width:a,height:s}),N={x:m,y:b};return o.layoutBindings[o.layout].diagonal(N,N,null,{sy:o.linkYOffset})}).merge(w);L.attr("fill","none"),L.transition().duration(o.duration).attr("d",f=>{const m=o.layoutBindings[o.layout].linkX({x:f._source.x,y:f._source.y,width:f._source.width,height:f._source.height}),b=o.layoutBindings[o.layout].linkY({x:f._source.x,y:f._source.y,width:f._source.width,height:f._source.height}),N=o.layoutBindings[o.layout].linkJoinX({x:f._target.x,y:f._target.y,width:f._target.width,height:f._target.height}),T=o.layoutBindings[o.layout].linkJoinY({x:f._target.x,y:f._target.y,width:f._target.width,height:f._target.height});return o.linkGroupArc({source:{x:m,y:b},target:{x:N,y:T}})}),L.each(o.connectionsUpdate),w.exit().transition().duration(o.duration).attr("opacity",0).remove();const x=o.nodesWrapper.selectAll("g.node").data(l,({data:f})=>o.nodeId(f)),_=x.enter().append("g").attr("class","node").attr("transform",f=>{if(f==o.root)return`translate(${n},${e})`;const m=o.layoutBindings[o.layout].nodeJoinX({x:n,y:e,width:a,height:s}),b=o.layoutBindings[o.layout].nodeJoinY({x:n,y:e,width:a,height:s});return`translate(${m},${b})`}).attr("cursor","pointer").on("click.node",(f,m)=>{const{data:b}=m;if(![...f.srcElement.classList].includes("node-button-foreign-object")){if([...f.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(m);return}if(!b._pagingButton){o.onNodeClick(m);return}console.log("event fired, no handlers")}}).on("keydown.node",(f,m)=>{const{data:b}=m;if(f.key==="Enter"||f.key===" "||f.key==="Spacebar"){if([...f.srcElement.classList].includes("node-button-foreign-object"))return;if([...f.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(m);return}(f.key==="Enter"||f.key===" "||f.key==="Spacebar")&&this.onButtonClick(f,m)}});_.each(o.nodeEnter),_.patternify({tag:"rect",selector:"node-rect",data:f=>[f]});const F=_.merge(x).style("font","12px sans-serif");F.patternify({tag:"foreignObject",selector:"node-foreign-object",data:f=>[f]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:f=>[f]}),this.restyleForeignObjectElements();const M=_.patternify({tag:"g",selector:"node-button-g",data:f=>[f]}).on("click",(f,m)=>this.onButtonClick(f,m)).on("keydown",(f,m)=>{(f.key==="Enter"||f.key===" "||f.key==="Spacebar")&&this.onButtonClick(f,m)});M.patternify({tag:"rect",selector:"node-button-rect",data:f=>[f]}).attr("opacity",0).attr("pointer-events","all").attr("width",f=>o.nodeButtonWidth(f)).attr("height",f=>o.nodeButtonHeight(f)).attr("x",f=>o.nodeButtonX(f)).attr("y",f=>o.nodeButtonY(f)),M.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:f=>[f]}).attr("width",f=>o.nodeButtonWidth(f)).attr("height",f=>o.nodeButtonHeight(f)).attr("x",f=>o.nodeButtonX(f)).attr("y",f=>o.nodeButtonY(f)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:f=>[f]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),F.transition().attr("opacity",0).duration(o.duration).attr("transform",({x:f,y:m,width:b,height:N})=>o.layoutBindings[o.layout].nodeUpdateTransform({x:f,y:m,width:b,height:N})).attr("opacity",1),F.select(".node-rect").attr("width",({width:f})=>f).attr("height",({height:f})=>f).attr("x",({width:f})=>0).attr("y",({height:f})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",o.nodeDefaultBackground),F.select(".node-button-g").attr("transform",({data:f,width:m,height:b})=>{const N=o.layoutBindings[o.layout].buttonX({width:m,height:b}),T=o.layoutBindings[o.layout].buttonY({width:m,height:b});return`translate(${N},${T})`}).attr("display",({data:f})=>f._directSubordinates>0?null:"none").attr("opacity",({data:f,children:m,_children:b})=>f._pagingButton?0:m||b?1:0),F.select(".node-button-foreign-object .node-button-div").html(f=>o.buttonContent({node:f,state:o})),F.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:f})=>f?40:26).text(({children:f})=>f?"-":"+").attr("y",this.isEdge()?10:0),F.each(o.nodeUpdate);const G=x.exit();G.each(o.nodeExit);const tt=G.data().reduce((f,m)=>f.depth<m.depth?f:m,{depth:1/0});G.attr("opacity",1).transition().duration(o.duration).attr("transform",f=>{let{x:m,y:b,width:N,height:T}=tt.parent||{};const R=o.layoutBindings[o.layout].nodeJoinX({x:m,y:b,width:N,height:T}),Y=o.layoutBindings[o.layout].nodeJoinY({x:m,y:b,width:N,height:T});return`translate(${R},${Y})`}).on("end",function(){j.select(this).remove()}).attr("opacity",0),l.forEach(f=>{f.x0=f.x,f.y0=f.y});const p=o.allNodes.filter(f=>f.data._centered)[0];if(p){let f=[p];p.data._centeredWithDescendants&&(o.compact?f=p.descendants().filter((m,b)=>b<7):f=p.descendants().filter((m,b,N)=>{const T=Math.round(N.length/2),R=2;return N.length%2?b>T-R&&b<T+R-1:b>T-R&&b<T+R})),p.data._centeredWithDescendants=null,p.data._centered=null,this.fit({animate:!0,scale:!1,nodes:f})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(n,e,r,i){return this.getChartState().hdiagonal(n,e,r,i)}diagonal(n,e,r,i){return this.getChartState().diagonal(n,e,r,i)}restyleForeignObjectElements(){const n=this.getChartState();n.svg.selectAll(".node-foreign-object").attr("width",({width:e})=>e).attr("height",({height:e})=>e).attr("x",({width:e})=>0).attr("y",({height:e})=>0),n.svg.selectAll(".node-foreign-object-div").style("width",({width:e})=>`${e}px`).style("height",({height:e})=>`${e}px`).html(function(e,r,i){return e.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${n.pagingButton(e,r,i,n)}</div></div>`:n.nodeContent.bind(this)(e,r,i,n)})}onButtonClick(n,e){const r=this.getChartState();e.data._pagingButton||(r.setActiveNodeCentered&&(e.data._centered=!0,e.data._centeredWithDescendants=!0),e.children?(e._children=e.children,e.children=null,this.setExpansionFlagToChildren(e,!1)):(e.children=e._children,e._children=null,e.children&&e.children.forEach(({data:i})=>i._expanded=!0)),this.update(e),n.stopPropagation(),r.onExpandOrCollapse(e))}setExpansionFlagToChildren({data:n,children:e,_children:r},i){n._expanded=i,e&&e.forEach(a=>{this.setExpansionFlagToChildren(a,i)}),r&&r.forEach(a=>{this.setExpansionFlagToChildren(a,i)})}expandSomeNodes(n){if(n.data._expanded){let e=n.parent;for(;e&&e._children;)e.children=e._children,e._children=null,e=e.parent}n._children&&n._children.forEach(e=>this.expandSomeNodes(e)),n.children&&n.children.forEach(e=>this.expandSomeNodes(e))}updateNodesState(){const n=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(n.root)}setLayouts({expandNodesFirst:n=!0}){const e=this.getChartState();e.generateRoot=j.stratify().id(a=>e.nodeId(a)).parentId(a=>e.parentNodeId(a)),e.root=e.generateRoot(e.data);const r=e.root.descendants();e.initialExpandLevel>1&&r.length>0&&(r.forEach(a=>{a.depth<=e.initialExpandLevel&&(a.data._expanded=!0)}),e.initialExpandLevel=1);const i={};e.root.descendants().filter(a=>a.children).filter(a=>!a.data._pagingStep).forEach(a=>{a.data._pagingStep=e.minPagingVisibleNodes(a)}),e.root.eachBefore((a,s)=>{a.data._directSubordinatesPaging=a.children?a.children.length:0,a.children&&a.children.forEach((o,c)=>{if(o.data._pagingButton=!1,c>a.data._pagingStep&&(i[o.id]=!0),c===a.data._pagingStep&&a.children.length-1>a.data._pagingStep&&(o.data._pagingButton=!0),i[o.parent.id]&&(i[o.id]=!0),o.data._expanded||o.data._centered||o.data._highlighted||o.data._upToTheRootHighlighted){let l=o;for(;l&&(i[l.id]||l.data._pagingButton);)i[l.id]=!1,l.data._pagingButton&&(l.data._pagingButton=!1,l.parent.children.forEach(u=>{u.data._expanded=!0,i[u.id]=!1})),l=l.parent}})}),e.root=j.stratify().id(a=>e.nodeId(a)).parentId(a=>e.parentNodeId(a))(e.data.filter(a=>i[a.id]!==!0)),e.root.each((a,s,o)=>{let c=a._hierarchyHeight||a.height,l=e.nodeWidth(a),u=e.nodeHeight(a);Object.assign(a,{width:l,height:u,_hierarchyHeight:c})}),e.root.x0=0,e.root.y0=0,e.allNodes=e.root.descendants(),e.allNodes.forEach(a=>{Object.assign(a.data,{_directSubordinates:a.children?a.children.length:0,_totalSubordinates:a.descendants().length-1})}),e.root.children&&(n&&e.root.children.forEach(this.expand),e.root.children.forEach(a=>this.collapse(a)),e.initialExpandLevel==0&&(e.root._children=e.root.children,e.root.children=null),[e.root].forEach(a=>this.expandSomeNodes(a)))}collapse(n){n.children&&(n._children=n.children,n._children.forEach(e=>this.collapse(e)),n.children=null)}expand(n){n._children&&(n.children=n._children,n.children.forEach(e=>this.expand(e)),n._children=null)}zoomed(n,e){const r=this.getChartState(),i=r.chart,a=n.transform;r.lastTransform=a,i.attr("transform",a),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:n,x1:e,y0:r,y1:i,params:a={animate:!0,scale:!0,onCompleted:()=>{}}}){const{centerG:s,svgWidth:o,svgHeight:c,svg:l,zoomBehavior:u,duration:h,lastTransform:d}=this.getChartState();let g=Math.min(8,.9/Math.max((e-n)/o,(i-r)/c)),v=j.zoomIdentity.translate(o/2,c/2);v=v.scale(a.scale?g:d.k),v=v.translate(-(n+e)/2,-(r+i)/2),l.transition().duration(a.animate?h:0).call(u.transform,v),s.transition().duration(a.animate?h:0).attr("transform","translate(0,0)").on("end",function(){a.onCompleted&&a.onCompleted()})}fit({animate:n=!0,nodes:e,scale:r=!0,onCompleted:i=()=>{}}={}){const a=this.getChartState(),{root:s}=a;let o=e||s.descendants();const c=j.min(o,d=>d.x+a.layoutBindings[a.layout].nodeLeftX(d)),l=j.max(o,d=>d.x+a.layoutBindings[a.layout].nodeRightX(d)),u=j.min(o,d=>d.y+a.layoutBindings[a.layout].nodeTopY(d)),h=j.max(o,d=>d.y+a.layoutBindings[a.layout].nodeBottomY(d));return this.zoomTreeBounds({params:{animate:n,scale:r,onCompleted:i},x0:c-50,x1:l+50,y0:u-50,y1:h+50}),this}loadPagingNodes(n){const e=this.getChartState();n.data._pagingButton=!1;const r=n.parent.data._pagingStep,i=e.pagingStep(n.parent),a=r+i;n.parent.data._pagingStep=a,this.updateNodesState()}setExpanded(n,e=!0){const r=this.getChartState(),i=r.allNodes.filter(({data:a})=>r.nodeId(a)==n)[0];if(!i)return console.log(`ORG CHART - ${e?"EXPAND":"COLLAPSE"} - Node with id (${n})  not found in the tree`),this;if(i.data._expanded=e,e==!1){const a=i.parent||{descendants:()=>[]};a.descendants().filter(o=>o!=a).forEach(o=>o.data._expanded=!1)}return this}setCentered(n){const e=this.getChartState(),a=e.generateRoot(e.data).descendants().filter(({data:o})=>e.nodeId(o).toString()==n.toString())[0];return a?(a.ancestors().forEach(o=>o.data._expanded=!0),a.data._centered=!0,a.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${n}) not found in the tree`),this)}setHighlighted(n){const e=this.getChartState(),a=e.generateRoot(e.data).descendants().filter(o=>e.nodeId(o.data).toString()===n.toString())[0];return a?(a.ancestors().forEach(o=>o.data._expanded=!0),a.data._highlighted=!0,a.data._expanded=!0,a.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${n})  not found in the tree`),this)}setUpToTheRootHighlighted(n){const e=this.getChartState(),a=e.generateRoot(e.data).descendants().filter(o=>e.nodeId(o.data).toString()===n.toString())[0];return a?(a.ancestors().forEach(o=>o.data._expanded=!0),a.data._upToTheRootHighlighted=!0,a.data._expanded=!0,a.ancestors().forEach(o=>o.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${n}) not found in the tree`),this)}clearHighlighting(){const n=this.getChartState();return n.allNodes.forEach(e=>{e.data._highlighted=!1,e.data._upToTheRootHighlighted=!1}),this.update(n.root),this}fullscreen(n){const e=this.getChartState(),r=j.select(n||e.container).node();j.select(document).on("fullscreenchange."+e.id,function(i){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==r?setTimeout(s=>{e.svg.attr("height",window.innerHeight-40)},500):e.svg.attr("height",e.svgHeight)}),r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():r.msRequestFullscreen&&r.msRequestFullscreen()}zoomIn(){const{svg:n,zoomBehavior:e}=this.getChartState();n.transition().call(e.scaleBy,1.3)}zoomOut(){const{svg:n,zoomBehavior:e}=this.getChartState();n.transition().call(e.scaleBy,.78)}toDataURL(n,e){var r=new XMLHttpRequest;r.onload=function(){var i=new FileReader;i.onloadend=function(){e(i.result)},i.readAsDataURL(r.response)},r.open("GET",n),r.responseType="blob",r.send()}exportImg({full:n=!1,scale:e=3,onLoad:r=s=>s,save:i=!0,backgroundColor:a="#FAFAFA"}={}){const s=this,o=this.getChartState(),{svg:c,root:l}=o;let u=0;const h=c.selectAll("img");let d=h.size();const g=()=>{JSON.parse(JSON.stringify(s.lastTransform()));const v=s.duration();n&&s.fit();const{svg:y}=s.getChartState();setTimeout(S=>{s.downloadImage({node:y.node(),scale:e,isSvg:!1,backgroundColor:a,onAlreadySerialized:C=>{s.update(l)},imageName:o.imageName,onLoad:r,save:i})},n?v+10:0)};d>0?h.each(function(){s.toDataURL(this.src,v=>{this.src=v,++u==d&&g()})}):g()}exportSvg(){const{svg:n,imageName:e}=this.getChartState();return this.downloadImage({imageName:e,node:n.node(),scale:3,isSvg:!0}),this}expandAll(){const{allNodes:n,root:e,data:r}=this.getChartState();return r.forEach(i=>i._expanded=!0),this.render(),this}collapseAll(){const{allNodes:n,root:e}=this.getChartState();return n.forEach(r=>r.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:n,scale:e=2,imageName:r="graph",isSvg:i=!1,save:a=!0,backgroundColor:s="#FAFAFA",onAlreadySerialized:o=l=>{},onLoad:c=l=>{}}){const l=n;function u(y,S){var C=document.createElement("a");typeof C.download=="string"?(document.body.appendChild(C),C.download=S,C.href=y,C.click(),document.body.removeChild(C)):location.replace(y)}function h(y){const S="http://www.w3.org/2000/xmlns/",C="http://www.w3.org/1999/xlink",z="http://www.w3.org/2000/svg";y=y.cloneNode(!0);const A=window.location.href+"#",w=document.createTreeWalker(y,NodeFilter.SHOW_ELEMENT,null,!1);for(;w.nextNode();)for(const x of w.currentNode.attributes)x.value.includes(A)&&(x.value=x.value.replace(A,"#"));return y.setAttributeNS(S,"xmlns",z),y.setAttributeNS(S,"xmlns:xlink",C),new XMLSerializer().serializeToString(y)}if(i){let y=h(l);y=`<?xml version="1.0" standalone="no"?>\r
`+y;var v="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(y);u(v,r+".svg"),o();return}const d=e,g=document.createElement("img");g.onload=function(){const y=document.createElement("canvas"),S=l.getBoundingClientRect();y.width=S.width*d,y.height=S.height*d;const C=y.getContext("2d");C.fillStyle=s,C.fillRect(0,0,S.width*d,S.height*d),C.drawImage(g,0,0,S.width*d,S.height*d);let z=y.toDataURL("image/png");c&&c(z),a&&u(z,r+".png")};var v="data:image/svg+xml; charset=utf8, "+encodeURIComponent(h(l));o(),g.src=v}getTextWidth(n,{fontSize:e=14,fontWeight:r=400,defaultFont:i="Helvetice",ctx:a}={}){return a.font=`${r||""} ${e}px ${i} `,a.measureText(n).width}clear(){const n=this.getChartState();j.select(window).on(`resize.${n.id}`,null),n.svg&&n.svg.selectAll("*").remove()}}function Ft(t){return Array.isArray?Array.isArray(t):ai(t)==="[object Array]"}function fc(t){if(typeof t=="string")return t;let n=t+"";return n=="0"&&1/t==-1/0?"-0":n}function gc(t){return t==null?"":fc(t)}function Et(t){return typeof t=="string"}function ri(t){return typeof t=="number"}function pc(t){return t===!0||t===!1||mc(t)&&ai(t)=="[object Boolean]"}function ii(t){return typeof t=="object"}function mc(t){return ii(t)&&t!==null}function pt(t){return t!=null}function nn(t){return!t.trim().length}function ai(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const vc="Incorrect 'index' type",yc=t=>`Invalid value for key ${t}`,xc=t=>`Pattern length exceeds max of ${t}.`,_c=t=>`Missing ${t} property in key`,wc=t=>`Property 'weight' in key '${t}' must be a positive integer`,gr=Object.prototype.hasOwnProperty;class bc{constructor(n){this._keys=[],this._keyMap={};let e=0;n.forEach(r=>{let i=oi(r);this._keys.push(i),this._keyMap[i.id]=i,e+=i.weight}),this._keys.forEach(r=>{r.weight/=e})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function oi(t){let n=null,e=null,r=null,i=1,a=null;if(Et(t)||Ft(t))r=t,n=pr(t),e=mn(t);else{if(!gr.call(t,"name"))throw new Error(_c("name"));const s=t.name;if(r=s,gr.call(t,"weight")&&(i=t.weight,i<=0))throw new Error(wc(s));n=pr(s),e=mn(s),a=t.getFn}return{path:n,id:e,weight:i,src:r,getFn:a}}function pr(t){return Ft(t)?t:t.split(".")}function mn(t){return Ft(t)?t.join("."):t}function Cc(t,n){let e=[],r=!1;const i=(a,s,o)=>{if(pt(a))if(!s[o])e.push(a);else{let c=s[o];const l=a[c];if(!pt(l))return;if(o===s.length-1&&(Et(l)||ri(l)||pc(l)))e.push(gc(l));else if(Ft(l)){r=!0;for(let u=0,h=l.length;u<h;u+=1)i(l[u],s,o+1)}else s.length&&i(l,s,o+1)}};return i(t,Et(n)?n.split("."):n,0),r?e:e[0]}const Ec={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},kc={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,n)=>t.score===n.score?t.idx<n.idx?-1:1:t.score<n.score?-1:1},$c={location:0,threshold:.6,distance:100},Sc={useExtendedSearch:!1,getFn:Cc,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var P={...kc,...Ec,...$c,...Sc};const Ac=/[^ ]+/g;function Mc(t=1,n=3){const e=new Map,r=Math.pow(10,n);return{get(i){const a=i.match(Ac).length;if(e.has(a))return e.get(a);const s=1/Math.pow(a,.5*t),o=parseFloat(Math.round(s*r)/r);return e.set(a,o),o},clear(){e.clear()}}}class Rn{constructor({getFn:n=P.getFn,fieldNormWeight:e=P.fieldNormWeight}={}){this.norm=Mc(e,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((e,r)=>{this._keysMap[e.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Et(this.docs[0])?this.docs.forEach((n,e)=>{this._addString(n,e)}):this.docs.forEach((n,e)=>{this._addObject(n,e)}),this.norm.clear())}add(n){const e=this.size();Et(n)?this._addString(n,e):this._addObject(n,e)}removeAt(n){this.records.splice(n,1);for(let e=n,r=this.size();e<r;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(n,e){return n[this._keysMap[e]]}size(){return this.records.length}_addString(n,e){if(!pt(n)||nn(n))return;let r={v:n,i:e,n:this.norm.get(n)};this.records.push(r)}_addObject(n,e){let r={i:e,$:{}};this.keys.forEach((i,a)=>{let s=i.getFn?i.getFn(n):this.getFn(n,i.path);if(pt(s)){if(Ft(s)){let o=[];const c=[{nestedArrIndex:-1,value:s}];for(;c.length;){const{nestedArrIndex:l,value:u}=c.pop();if(pt(u))if(Et(u)&&!nn(u)){let h={v:u,i:l,n:this.norm.get(u)};o.push(h)}else Ft(u)&&u.forEach((h,d)=>{c.push({nestedArrIndex:d,value:h})})}r.$[a]=o}else if(Et(s)&&!nn(s)){let o={v:s,n:this.norm.get(s)};r.$[a]=o}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function si(t,n,{getFn:e=P.getFn,fieldNormWeight:r=P.fieldNormWeight}={}){const i=new Rn({getFn:e,fieldNormWeight:r});return i.setKeys(t.map(oi)),i.setSources(n),i.create(),i}function Bc(t,{getFn:n=P.getFn,fieldNormWeight:e=P.fieldNormWeight}={}){const{keys:r,records:i}=t,a=new Rn({getFn:n,fieldNormWeight:e});return a.setKeys(r),a.setIndexRecords(i),a}function ke(t,{errors:n=0,currentLocation:e=0,expectedLocation:r=0,distance:i=P.distance,ignoreLocation:a=P.ignoreLocation}={}){const s=n/t.length;if(a)return s;const o=Math.abs(r-e);return i?s+o/i:o?1:s}function Dc(t=[],n=P.minMatchCharLength){let e=[],r=-1,i=-1,a=0;for(let s=t.length;a<s;a+=1){let o=t[a];o&&r===-1?r=a:!o&&r!==-1&&(i=a-1,i-r+1>=n&&e.push([r,i]),r=-1)}return t[a-1]&&a-r>=n&&e.push([r,a-1]),e}const Xt=32;function Nc(t,n,e,{location:r=P.location,distance:i=P.distance,threshold:a=P.threshold,findAllMatches:s=P.findAllMatches,minMatchCharLength:o=P.minMatchCharLength,includeMatches:c=P.includeMatches,ignoreLocation:l=P.ignoreLocation}={}){if(n.length>Xt)throw new Error(xc(Xt));const u=n.length,h=t.length,d=Math.max(0,Math.min(r,h));let g=a,v=d;const y=o>1||c,S=y?Array(h):[];let C;for(;(C=t.indexOf(n,v))>-1;){let x=ke(n,{currentLocation:C,expectedLocation:d,distance:i,ignoreLocation:l});if(g=Math.min(x,g),v=C+u,y){let _=0;for(;_<u;)S[C+_]=1,_+=1}}v=-1;let z=[],A=1,w=u+h;const I=1<<u-1;for(let x=0;x<u;x+=1){let _=0,F=w;for(;_<F;)ke(n,{errors:x,currentLocation:d+F,expectedLocation:d,distance:i,ignoreLocation:l})<=g?_=F:w=F,F=Math.floor((w-_)/2+_);w=F;let E=Math.max(1,d-F+1),M=s?h:Math.min(d+F,h)+u,G=Array(M+2);G[M+1]=(1<<x)-1;for(let p=M;p>=E;p-=1){let f=p-1,m=e[t.charAt(f)];if(y&&(S[f]=+!!m),G[p]=(G[p+1]<<1|1)&m,x&&(G[p]|=(z[p+1]|z[p])<<1|1|z[p+1]),G[p]&I&&(A=ke(n,{errors:x,currentLocation:f,expectedLocation:d,distance:i,ignoreLocation:l}),A<=g)){if(g=A,v=f,v<=d)break;E=Math.max(1,2*d-v)}}if(ke(n,{errors:x+1,currentLocation:d,expectedLocation:d,distance:i,ignoreLocation:l})>g)break;z=G}const L={isMatch:v>=0,score:Math.max(.001,A)};if(y){const x=Dc(S,o);x.length?c&&(L.indices=x):L.isMatch=!1}return L}function zc(t){let n={};for(let e=0,r=t.length;e<r;e+=1){const i=t.charAt(e);n[i]=(n[i]||0)|1<<r-e-1}return n}const Xe=String.prototype.normalize?(t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,"")):(t=>t);class li{constructor(n,{location:e=P.location,threshold:r=P.threshold,distance:i=P.distance,includeMatches:a=P.includeMatches,findAllMatches:s=P.findAllMatches,minMatchCharLength:o=P.minMatchCharLength,isCaseSensitive:c=P.isCaseSensitive,ignoreDiacritics:l=P.ignoreDiacritics,ignoreLocation:u=P.ignoreLocation}={}){if(this.options={location:e,threshold:r,distance:i,includeMatches:a,findAllMatches:s,minMatchCharLength:o,isCaseSensitive:c,ignoreDiacritics:l,ignoreLocation:u},n=c?n:n.toLowerCase(),n=l?Xe(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const h=(g,v)=>{this.chunks.push({pattern:g,alphabet:zc(g),startIndex:v})},d=this.pattern.length;if(d>Xt){let g=0;const v=d%Xt,y=d-v;for(;g<y;)h(this.pattern.substr(g,Xt),g),g+=Xt;if(v){const S=d-Xt;h(this.pattern.substr(S),S)}}else h(this.pattern,0)}searchIn(n){const{isCaseSensitive:e,ignoreDiacritics:r,includeMatches:i}=this.options;if(n=e?n:n.toLowerCase(),n=r?Xe(n):n,this.pattern===n){let y={isMatch:!0,score:0};return i&&(y.indices=[[0,n.length-1]]),y}const{location:a,distance:s,threshold:o,findAllMatches:c,minMatchCharLength:l,ignoreLocation:u}=this.options;let h=[],d=0,g=!1;this.chunks.forEach(({pattern:y,alphabet:S,startIndex:C})=>{const{isMatch:z,score:A,indices:w}=Nc(n,y,S,{location:a+C,distance:s,threshold:o,findAllMatches:c,minMatchCharLength:l,includeMatches:i,ignoreLocation:u});z&&(g=!0),d+=A,z&&w&&(h=[...h,...w])});let v={isMatch:g,score:g?d/this.chunks.length:1};return g&&i&&(v.indices=h),v}}class Vt{constructor(n){this.pattern=n}static isMultiMatch(n){return mr(n,this.multiRegex)}static isSingleMatch(n){return mr(n,this.singleRegex)}search(){}}function mr(t,n){const e=t.match(n);return e?e[1]:null}class Fc extends Vt{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const e=n===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class Tc extends Vt{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class Rc extends Vt{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const e=n.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class Ic extends Vt{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const e=!n.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,n.length-1]}}}class Vc extends Vt{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const e=n.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class Lc extends Vt{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const e=!n.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,n.length-1]}}}class ui extends Vt{constructor(n,{location:e=P.location,threshold:r=P.threshold,distance:i=P.distance,includeMatches:a=P.includeMatches,findAllMatches:s=P.findAllMatches,minMatchCharLength:o=P.minMatchCharLength,isCaseSensitive:c=P.isCaseSensitive,ignoreDiacritics:l=P.ignoreDiacritics,ignoreLocation:u=P.ignoreLocation}={}){super(n),this._bitapSearch=new li(n,{location:e,threshold:r,distance:i,includeMatches:a,findAllMatches:s,minMatchCharLength:o,isCaseSensitive:c,ignoreDiacritics:l,ignoreLocation:u})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class ci extends Vt{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let e=0,r;const i=[],a=this.pattern.length;for(;(r=n.indexOf(this.pattern,e))>-1;)e=r+a,i.push([r,e-1]);const s=!!i.length;return{isMatch:s,score:s?0:1,indices:i}}}const vn=[Fc,ci,Rc,Ic,Lc,Vc,Tc,ui],vr=vn.length,Oc=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Pc="|";function Xc(t,n={}){return t.split(Pc).map(e=>{let r=e.trim().split(Oc).filter(a=>a&&!!a.trim()),i=[];for(let a=0,s=r.length;a<s;a+=1){const o=r[a];let c=!1,l=-1;for(;!c&&++l<vr;){const u=vn[l];let h=u.isMultiMatch(o);h&&(i.push(new u(h,n)),c=!0)}if(!c)for(l=-1;++l<vr;){const u=vn[l];let h=u.isSingleMatch(o);if(h){i.push(new u(h,n));break}}}return i})}const Uc=new Set([ui.type,ci.type]);class Yc{constructor(n,{isCaseSensitive:e=P.isCaseSensitive,ignoreDiacritics:r=P.ignoreDiacritics,includeMatches:i=P.includeMatches,minMatchCharLength:a=P.minMatchCharLength,ignoreLocation:s=P.ignoreLocation,findAllMatches:o=P.findAllMatches,location:c=P.location,threshold:l=P.threshold,distance:u=P.distance}={}){this.query=null,this.options={isCaseSensitive:e,ignoreDiacritics:r,includeMatches:i,minMatchCharLength:a,findAllMatches:o,ignoreLocation:s,location:c,threshold:l,distance:u},n=e?n:n.toLowerCase(),n=r?Xe(n):n,this.pattern=n,this.query=Xc(this.pattern,this.options)}static condition(n,e){return e.useExtendedSearch}searchIn(n){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:i,ignoreDiacritics:a}=this.options;n=i?n:n.toLowerCase(),n=a?Xe(n):n;let s=0,o=[],c=0;for(let l=0,u=e.length;l<u;l+=1){const h=e[l];o.length=0,s=0;for(let d=0,g=h.length;d<g;d+=1){const v=h[d],{isMatch:y,indices:S,score:C}=v.search(n);if(y){if(s+=1,c+=C,r){const z=v.constructor.type;Uc.has(z)?o=[...o,...S]:o.push(S)}}else{c=0,s=0,o.length=0;break}}if(s){let d={isMatch:!0,score:c/s};return r&&(d.indices=o),d}}return{isMatch:!1,score:1}}}const yn=[];function Hc(...t){yn.push(...t)}function xn(t,n){for(let e=0,r=yn.length;e<r;e+=1){let i=yn[e];if(i.condition(t,n))return new i(t,n)}return new li(t,n)}const Ue={AND:"$and",OR:"$or"},_n={PATH:"$path",PATTERN:"$val"},wn=t=>!!(t[Ue.AND]||t[Ue.OR]),qc=t=>!!t[_n.PATH],Wc=t=>!Ft(t)&&ii(t)&&!wn(t),yr=t=>({[Ue.AND]:Object.keys(t).map(n=>({[n]:t[n]}))});function hi(t,n,{auto:e=!0}={}){const r=i=>{let a=Object.keys(i);const s=qc(i);if(!s&&a.length>1&&!wn(i))return r(yr(i));if(Wc(i)){const c=s?i[_n.PATH]:a[0],l=s?i[_n.PATTERN]:i[c];if(!Et(l))throw new Error(yc(c));const u={keyId:mn(c),pattern:l};return e&&(u.searcher=xn(l,n)),u}let o={children:[],operator:a[0]};return a.forEach(c=>{const l=i[c];Ft(l)&&l.forEach(u=>{o.children.push(r(u))})}),o};return wn(t)||(t=yr(t)),r(t)}function Gc(t,{ignoreFieldNorm:n=P.ignoreFieldNorm}){t.forEach(e=>{let r=1;e.matches.forEach(({key:i,norm:a,score:s})=>{const o=i?i.weight:null;r*=Math.pow(s===0&&o?Number.EPSILON:s,(o||1)*(n?1:a))}),e.score=r})}function Kc(t,n){const e=t.matches;n.matches=[],pt(e)&&e.forEach(r=>{if(!pt(r.indices)||!r.indices.length)return;const{indices:i,value:a}=r;let s={indices:i,value:a};r.key&&(s.key=r.key.src),r.idx>-1&&(s.refIndex=r.idx),n.matches.push(s)})}function Jc(t,n){n.score=t.score}function jc(t,n,{includeMatches:e=P.includeMatches,includeScore:r=P.includeScore}={}){const i=[];return e&&i.push(Kc),r&&i.push(Jc),t.map(a=>{const{idx:s}=a,o={item:n[s],refIndex:s};return i.length&&i.forEach(c=>{c(a,o)}),o})}class Gt{constructor(n,e={},r){this.options={...P,...e},this.options.useExtendedSearch,this._keyStore=new bc(this.options.keys),this.setCollection(n,r)}setCollection(n,e){if(this._docs=n,e&&!(e instanceof Rn))throw new Error(vc);this._myIndex=e||si(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){pt(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const e=[];for(let r=0,i=this._docs.length;r<i;r+=1){const a=this._docs[r];n(a,r)&&(this.removeAt(r),r-=1,i-=1,e.push(a))}return e}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:e=-1}={}){const{includeMatches:r,includeScore:i,shouldSort:a,sortFn:s,ignoreFieldNorm:o}=this.options;let c=Et(n)?Et(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return Gc(c,{ignoreFieldNorm:o}),a&&c.sort(s),ri(e)&&e>-1&&(c=c.slice(0,e)),jc(c,this._docs,{includeMatches:r,includeScore:i})}_searchStringList(n){const e=xn(n,this.options),{records:r}=this._myIndex,i=[];return r.forEach(({v:a,i:s,n:o})=>{if(!pt(a))return;const{isMatch:c,score:l,indices:u}=e.searchIn(a);c&&i.push({item:a,idx:s,matches:[{score:l,value:a,norm:o,indices:u}]})}),i}_searchLogical(n){const e=hi(n,this.options),r=(o,c,l)=>{if(!o.children){const{keyId:h,searcher:d}=o,g=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(c,h),searcher:d});return g&&g.length?[{idx:l,item:c,matches:g}]:[]}const u=[];for(let h=0,d=o.children.length;h<d;h+=1){const g=o.children[h],v=r(g,c,l);if(v.length)u.push(...v);else if(o.operator===Ue.AND)return[]}return u},i=this._myIndex.records,a={},s=[];return i.forEach(({$:o,i:c})=>{if(pt(o)){let l=r(e,o,c);l.length&&(a[c]||(a[c]={idx:c,item:o,matches:[]},s.push(a[c])),l.forEach(({matches:u})=>{a[c].matches.push(...u)}))}}),s}_searchObjectList(n){const e=xn(n,this.options),{keys:r,records:i}=this._myIndex,a=[];return i.forEach(({$:s,i:o})=>{if(!pt(s))return;let c=[];r.forEach((l,u)=>{c.push(...this._findMatches({key:l,value:s[u],searcher:e}))}),c.length&&a.push({idx:o,item:s,matches:c})}),a}_findMatches({key:n,value:e,searcher:r}){if(!pt(e))return[];let i=[];if(Ft(e))e.forEach(({v:a,i:s,n:o})=>{if(!pt(a))return;const{isMatch:c,score:l,indices:u}=r.searchIn(a);c&&i.push({score:l,key:n,value:a,idx:s,norm:o,indices:u})});else{const{v:a,n:s}=e,{isMatch:o,score:c,indices:l}=r.searchIn(a);o&&i.push({score:c,key:n,value:a,norm:s,indices:l})}return i}}Gt.version="7.1.0";Gt.createIndex=si;Gt.parseIndex=Bc;Gt.config=P;Gt.parseQuery=hi;Hc(Yc);const Zc={style:{"block-size":"100%"}},di={__name:"SelectUserDialog",props:{isDialogVisible:{type:Boolean,required:!0},users:{type:Array,required:!0},selectedUsers:{type:Array,required:!0}},emits:["update:isDialogVisible","selectUser"],setup(t,{emit:n}){const e=t,r=n,i=Lt(null),a=W(null),{theme:s}=Pi();function o(v){i.value=v.api,i.value.setGridOption("rowData",u())}const c=W([{headerName:"ÙØ­Ù Ú©Ø§Ø±",field:"workplace",rowGroup:!0,hide:!0},{headerName:"ÙÙØ·ÙÙ Ú©Ø§Ø±Û",field:"workArea",rowGroup:!0,hide:!0},{headerName:"ÙØ±Ú©Ø² ÙØ²ÛÙÙ",field:"costCenter",rowGroup:!0,hide:!0},{headerName:"Ú©Ø¯ Ù¾Ø±Ø³ÙÙÛ",field:"personnelCode"},{headerName:"ÙØ§Ù",field:"firstName"},{headerName:"ÙØ§Ù Ø®Ø§ÙÙØ§Ø¯Ú¯Û",field:"lastName"},{headerName:"ÙØ¶Ø¹ÛØª",field:"active",cellRenderer:"Active",cellStyle:{display:"flex","align-items":"center"},filterParams:{valueFormatter:v=>v.value===1?"ÙØ¹Ø§Ù":"ØºÛØ±ÙØ¹Ø§Ù"}}]),l=W({mode:"multiRow",enableClickSelection:!0,selectAll:"filtered",groupSelects:"filteredDescendants"});function u(){return e.users.map(v=>{var y,S,C,z,A,w;return{id:v.id,personnelCode:Number.parseInt(v.personnel_code),firstName:v.first_name,lastName:v.last_name,workplace:(S=(y=v.profile)==null?void 0:y.workplace)==null?void 0:S.name,workArea:(z=(C=v.profile)==null?void 0:C.work_area)==null?void 0:z.name,costCenter:(w=(A=v.profile)==null?void 0:A.cost_center)==null?void 0:w.name,active:v.active}})}const h=W({filter:"agGroupColumnFilter"});function d(){r("selectUser",i.value.getSelectedRows().map(v=>Number.parseInt(v.id))),r("update:isDialogVisible",!1)}function g(v){r("update:isDialogVisible",v)}return Bt(()=>e.isDialogVisible,v=>{v&&(a.value={rowSelection:e.selectedUsers.map(y=>String(y.id))})}),(v,y)=>{const S=Cn,C=xr("AgGridVue");return kt(),ue($n,{width:v.$vuetify.display.smAndDown?"auto":"90%",height:v.$vuetify.display.smAndDown?"auto":"90%","model-value":e.isDialogVisible,"onUpdate:modelValue":g},{default:O(()=>[D(S,{onClick:y[0]||(y[0]=z=>g(!1))}),D(Ht,null,{default:O(()=>[D(_t,null,{default:O(()=>[D(En,{style:{"block-size":"100%"},class:"d-flex flex-column"},{default:O(()=>[D(Xi,{class:"ma-3"},{default:O(()=>[...y[1]||(y[1]=[yt(" Ø§ÙØªØ®Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±Ø§Ù ",-1)])]),_:1}),D(kn,null,{default:O(()=>[vt("section",Zc,[D(C,{style:{"block-size":"100%","inline-size":"100%"},"column-defs":V(c),"get-row-id":z=>String(z.data.id),"enable-rtl":"",pagination:"","group-display-type":"multipleColumns","auto-group-column-def":V(h),"cell-selection":"","row-selection":V(l),theme:V(s),"initial-state":V(a),onGridReady:o},null,8,["column-defs","get-row-id","auto-group-column-def","row-selection","theme","initial-state"])])]),_:1}),D(Ui,null,{default:O(()=>[D(Nt,{color:"primary",onClick:d},{default:O(()=>[...y[2]||(y[2]=[yt(" Ø§ÙØ²ÙØ¯Ù ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","height","model-value"])}}},Qc={__name:"AddNodeDialog",props:{isDialogVisible:{type:Boolean,required:!0},orgPositions:{type:Array,required:!0},orgUnits:{type:Array,required:!0},users:{type:Array,required:!0}},emits:["add","update:isDialogVisible"],setup(t,{emit:n}){const e=t,r=n,i="https://blureen.afgc.ir/storage",a=W(),s=Ne({isSelectUserDialogOpen:!1}),o=W(e.orgUnits),c=W(null),l=W(null),u=W([]),h=W(""),d=ct(()=>{const x=e.users.map(_=>{var F,E,M,G,tt,p,f,m;return{..._,full_name:v([_.first_name,_.last_name]),work_area_cost_center:v([(E=(F=_.profile)==null?void 0:F.work_area)==null?void 0:E.name,(G=(M=_.profile)==null?void 0:M.cost_center)==null?void 0:G.name]),last_name_work_area_cost_center:v([_.last_name,(p=(tt=_.profile)==null?void 0:tt.work_area)==null?void 0:p.name,(m=(f=_.profile)==null?void 0:f.cost_center)==null?void 0:m.name])}});return new Gt(x,{keys:[{name:"personnel_code",weight:2},{name:"full_name",weight:1.5},{name:"work_area_cost_center",weight:1.5},{name:"last_name_work_area_cost_center",weight:1.5}],threshold:.4,ignoreLocation:!0,useExtendedSearch:!0,includeScore:!0,findAllMatches:!0,minMatchCharLength:1})}),g=ct(()=>{var F;const x=(F=h.value)==null?void 0:F.trim();return x?d.value.search(x).map(E=>E.item):e.users});function v(x){return x.filter(Boolean).join(" ").replace(/[\s\u200C]+/g,"")}function y(x){return(x||"").toString().replace(/[\s\u200C]+/g,"")}function S(x){x.key==="Backspace"&&!h.value&&x.stopPropagation()}function C(x){if(typeof x!="string")return;if(!x.trim()){l.value=null;return}const _=o.value.find(F=>y(F.name)===y(x));_&&(l.value=_)}function z(x){u.value=u.value.filter(_=>_.id!==x)}function A(x){u.value=e.users.filter(_=>x.includes(_.id))}function w(){var x;(x=a.value)==null||x.validate().then(({valid:_})=>{if(_){if(typeof l.value=="string"){const F=l.value.trim();l.value={id:`${Date.now()}-${Math.random()}`,name:F},o.value.push(l.value)}r("add",{orgPosition:c.value,orgUnit:l.value,users:u.value}),r("update:isDialogVisible",!1)}})}function I(){r("update:isDialogVisible",!1)}function L(x){r("update:isDialogVisible",x)}return Bt(()=>e.isDialogVisible,x=>{x||(c.value=null,l.value=null,u.value=[],h.value="")}),(x,_)=>{const F=Cn;return kt(),ce(It,null,[D($n,{width:x.$vuetify.display.smAndDown?"auto":900,"model-value":e.isDialogVisible,"onUpdate:modelValue":L},{default:O(()=>[D(F,{onClick:_[0]||(_[0]=E=>L(!1))}),D(En,{class:"pa-1"},{default:O(()=>[D(kn,null,{default:O(()=>[_[10]||(_[10]=vt("h6",{class:"text-h6 text-center mb-6"}," Ø§ÙØ²ÙØ¯Ù Ú¯Ø±Ù Ø¬Ø¯ÛØ¯ ",-1)),D(br,{ref_key:"refVForm",ref:a,"validate-on":"submit lazy",onSubmit:_r(w,["prevent"])},{default:O(()=>[D(Ht,null,{default:O(()=>[D(_t,{cols:"12",md:"6"},{default:O(()=>[D(ze,{modelValue:V(c),"onUpdate:modelValue":_[1]||(_[1]=E=>Rt(c)?c.value=E:null),label:"Ø³ÙØª",items:e.orgPositions,"item-title":"name","item-value":"id","return-object":"",rules:["requiredValidator"in x?x.requiredValidator:V(Jt)]},null,8,["modelValue","items","rules"])]),_:1}),D(_t,{cols:"12",md:"6"},{default:O(()=>[D(Cr,{modelValue:V(l),"onUpdate:modelValue":[_[2]||(_[2]=E=>Rt(l)?l.value=E:null),C],label:"ÙØ§Ø­Ø¯",items:V(o),"item-title":"name","item-value":"id",rules:["requiredValidator"in x?x.requiredValidator:V(Jt)]},null,8,["modelValue","items","rules"])]),_:1}),D(_t,{cols:"12"},{default:O(()=>[D(ze,{modelValue:V(u),"onUpdate:modelValue":_[4]||(_[4]=E=>Rt(u)?u.value=E:null),search:V(h),"onUpdate:search":_[5]||(_[5]=E=>Rt(h)?h.value=E:null),multiple:"",items:V(g),"item-title":E=>`${E.first_name} ${E.last_name} (${E.personnel_code})`,clearable:"","item-value":"id",label:"Ú©Ø§Ø±Ø¨Ø±Ø§Ù","no-filter":!0,"return-object":"",rules:["requiredValidator"in x?x.requiredValidator:V(Jt)],onKeydownCapture:S},{selection:O(()=>[..._[7]||(_[7]=[])]),item:O(({props:E,item:M})=>{var G,tt,p,f,m,b,N,T,R,Y,q,et,K,k;return[D(Fe,gt(E,{"prepend-avatar":`${V(i)}/${(tt=(G=M==null?void 0:M.raw)==null?void 0:G.avatar)==null?void 0:tt.path}`,title:`${(p=M==null?void 0:M.raw)==null?void 0:p.first_name} ${(f=M==null?void 0:M.raw)==null?void 0:f.last_name} (${(m=M==null?void 0:M.raw)==null?void 0:m.personnel_code})`,subtitle:`${((T=(N=(b=M==null?void 0:M.raw)==null?void 0:b.profile)==null?void 0:N.work_area)==null?void 0:T.name)||""} ${(q=(Y=(R=M==null?void 0:M.raw)==null?void 0:R.profile)==null?void 0:Y.work_area)!=null&&q.name?"â":""} ${((k=(K=(et=M==null?void 0:M.raw)==null?void 0:et.profile)==null?void 0:K.cost_center)==null?void 0:k.name)||""}`}),null,16,["prepend-avatar","title","subtitle"])]}),append:O(()=>[D(Nt,{variant:"outlined",color:"secondary",class:"border",onClick:_[3]||(_[3]=E=>V(s).isSelectUserDialogOpen=!0)},{default:O(()=>[D(Yt,{icon:"tabler-users",size:"25"})]),_:1})]),_:1},8,["modelValue","search","items","item-title","rules"])]),_:1})]),_:1}),D(Ht,null,{default:O(()=>[D(_t,{cols:"12",style:{"max-block-size":"50em"},class:"overflow-auto"},{default:O(()=>[(kt(!0),ce(It,null,wr(V(u),E=>(kt(),ue(De,gt({ref_for:!0},e,{key:E.id,link:"",pill:"",closable:"",variant:"outlined",size:"x-large",class:"ml-3 mb-3","onClick:close":M=>z(E.id)}),{default:O(()=>{var M;return[D(bn,{start:"",size:"40",image:`${V(i)}/${(M=E.avatar)==null?void 0:M.path}`},null,8,["image"]),yt(" "+he(E.first_name)+" "+he(E.last_name),1)]}),_:2},1040,["onClick:close"]))),128))]),_:1})]),_:1}),D(Ht,null,{default:O(()=>[D(_t,{cols:"12",class:"d-flex justify-center gap-4"},{default:O(()=>[D(Nt,{type:"submit"},{default:O(()=>[..._[8]||(_[8]=[yt(" Ø§ÙØ²ÙØ¯Ù ",-1)])]),_:1}),D(Nt,{color:"secondary",variant:"tonal",onClick:I},{default:O(()=>[..._[9]||(_[9]=[yt(" Ø¨Ø³ØªÙ ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"]),D(di,{"is-dialog-visible":V(s).isSelectUserDialogOpen,"onUpdate:isDialogVisible":_[6]||(_[6]=E=>V(s).isSelectUserDialogOpen=E),users:e.users,"selected-users":V(u),onSelectUser:A},null,8,["is-dialog-visible","users","selected-users"])],64)}}},th={__name:"EditNodeDialog",props:{isDialogVisible:{type:Boolean,required:!0},orgPositions:{type:Array,required:!0},orgUnits:{type:Array,required:!0},users:{type:Array,required:!0},node:{type:Object,required:!1}},emits:["edit","update:isDialogVisible"],setup(t,{emit:n}){const e=t,r=n,i="https://blureen.afgc.ir/storage",a=W(),s=Ne({isSelectUserDialogOpen:!1}),o=W(e.orgUnits),c=W(null),l=W(null),u=W([]),h=W(""),d=ct(()=>{const x=e.users.map(_=>{var F,E,M,G,tt,p,f,m;return{..._,full_name:v([_.first_name,_.last_name]),work_area_cost_center:v([(E=(F=_.profile)==null?void 0:F.work_area)==null?void 0:E.name,(G=(M=_.profile)==null?void 0:M.cost_center)==null?void 0:G.name]),last_name_work_area_cost_center:v([_.last_name,(p=(tt=_.profile)==null?void 0:tt.work_area)==null?void 0:p.name,(m=(f=_.profile)==null?void 0:f.cost_center)==null?void 0:m.name])}});return new Gt(x,{keys:[{name:"personnel_code",weight:2},{name:"full_name",weight:1.5},{name:"work_area_cost_center",weight:1.5},{name:"last_name_work_area_cost_center",weight:1.5}],threshold:.4,ignoreLocation:!0,useExtendedSearch:!0,includeScore:!0,findAllMatches:!0,minMatchCharLength:1})}),g=ct(()=>{var F;const x=(F=h.value)==null?void 0:F.trim();return x?d.value.search(x).map(E=>E.item):e.users});function v(x){return x.filter(Boolean).join(" ").replace(/[\s\u200C]+/g,"")}function y(x){return(x||"").toString().replace(/[\s\u200C]+/g,"")}function S(x){x.key==="Backspace"&&!h.value&&x.stopPropagation()}function C(x){if(typeof x!="string")return;if(!x.trim()){l.value=null;return}const _=o.value.find(F=>y(F.name)===y(x));_&&(l.value=_)}function z(x){u.value=u.value.filter(_=>_.id!==x)}function A(x){u.value=e.users.filter(_=>x.includes(_.id))}function w(){var x;(x=a.value)==null||x.validate().then(({valid:_})=>{if(_){if(typeof l.value=="string"){const F=l.value.trim();l.value={id:`${Date.now()}-${Math.random()}`,name:F},o.value.push(l.value)}r("edit",{id:e.node.id,parentId:e.node.parentId,orgPosition:c.value,orgUnit:l.value,users:u.value}),r("update:isDialogVisible",!1)}})}function I(){r("update:isDialogVisible",!1)}function L(x){r("update:isDialogVisible",x)}return Bt(()=>e.isDialogVisible,x=>{x&&(c.value=e.node.orgPosition,l.value=e.node.orgUnit,u.value=e.node.users,h.value="")}),(x,_)=>{const F=Cn;return kt(),ce(It,null,[D($n,{width:x.$vuetify.display.smAndDown?"auto":900,"model-value":e.isDialogVisible,"onUpdate:modelValue":L},{default:O(()=>[D(F,{onClick:_[0]||(_[0]=E=>L(!1))}),D(En,{class:"pa-1"},{default:O(()=>[D(kn,null,{default:O(()=>[_[10]||(_[10]=vt("h6",{class:"text-h6 text-center mb-6"}," Ø§ÙØ²ÙØ¯Ù Ú¯Ø±Ù Ø¬Ø¯ÛØ¯ ",-1)),D(br,{ref_key:"refVForm",ref:a,"validate-on":"submit lazy",onSubmit:_r(w,["prevent"])},{default:O(()=>[D(Ht,null,{default:O(()=>[D(_t,{cols:"12",md:"6"},{default:O(()=>[D(ze,{modelValue:V(c),"onUpdate:modelValue":_[1]||(_[1]=E=>Rt(c)?c.value=E:null),label:"Ø³ÙØª",items:e.orgPositions,"item-title":"name","item-value":"id","return-object":"",rules:["requiredValidator"in x?x.requiredValidator:V(Jt)]},null,8,["modelValue","items","rules"])]),_:1}),D(_t,{cols:"12",md:"6"},{default:O(()=>[D(Cr,{modelValue:V(l),"onUpdate:modelValue":[_[2]||(_[2]=E=>Rt(l)?l.value=E:null),C],label:"ÙØ§Ø­Ø¯",items:V(o),"item-title":"name","item-value":"id",rules:["requiredValidator"in x?x.requiredValidator:V(Jt)]},null,8,["modelValue","items","rules"])]),_:1}),D(_t,{cols:"12"},{default:O(()=>[D(ze,{modelValue:V(u),"onUpdate:modelValue":_[4]||(_[4]=E=>Rt(u)?u.value=E:null),search:V(h),"onUpdate:search":_[5]||(_[5]=E=>Rt(h)?h.value=E:null),multiple:"",items:V(g),"item-title":E=>`${E.first_name} ${E.last_name} (${E.personnel_code})`,clearable:"","item-value":"id",label:"Ú©Ø§Ø±Ø¨Ø±Ø§Ù","no-filter":!0,"return-object":"",rules:["requiredValidator"in x?x.requiredValidator:V(Jt)],onKeydownCapture:S},{selection:O(()=>[..._[7]||(_[7]=[])]),item:O(({props:E,item:M})=>{var G,tt,p,f,m,b,N,T,R,Y,q,et,K,k;return[D(Fe,gt(E,{"prepend-avatar":`${V(i)}/${(tt=(G=M==null?void 0:M.raw)==null?void 0:G.avatar)==null?void 0:tt.path}`,title:`${(p=M==null?void 0:M.raw)==null?void 0:p.first_name} ${(f=M==null?void 0:M.raw)==null?void 0:f.last_name} (${(m=M==null?void 0:M.raw)==null?void 0:m.personnel_code})`,subtitle:`${((T=(N=(b=M==null?void 0:M.raw)==null?void 0:b.profile)==null?void 0:N.work_area)==null?void 0:T.name)||""} ${(q=(Y=(R=M==null?void 0:M.raw)==null?void 0:R.profile)==null?void 0:Y.work_area)!=null&&q.name?"â":""} ${((k=(K=(et=M==null?void 0:M.raw)==null?void 0:et.profile)==null?void 0:K.cost_center)==null?void 0:k.name)||""}`}),null,16,["prepend-avatar","title","subtitle"])]}),append:O(()=>[D(Nt,{variant:"outlined",color:"secondary",class:"border",onClick:_[3]||(_[3]=E=>V(s).isSelectUserDialogOpen=!0)},{default:O(()=>[D(Yt,{icon:"tabler-users",size:"25"})]),_:1})]),_:1},8,["modelValue","search","items","item-title","rules"])]),_:1})]),_:1}),D(Ht,null,{default:O(()=>[D(_t,{cols:"12",style:{"max-block-size":"50em"},class:"overflow-auto"},{default:O(()=>[(kt(!0),ce(It,null,wr(V(u),E=>(kt(),ue(De,gt({ref_for:!0},e,{key:E.id,link:"",pill:"",closable:"",variant:"outlined",size:"x-large",class:"ml-3 mb-3","onClick:close":M=>z(E.id)}),{default:O(()=>{var M;return[D(bn,{start:"",size:"40",image:`${V(i)}/${(M=E.avatar)==null?void 0:M.path}`},null,8,["image"]),yt(" "+he(E.first_name)+" "+he(E.last_name),1)]}),_:2},1040,["onClick:close"]))),128))]),_:1})]),_:1}),D(Ht,null,{default:O(()=>[D(_t,{cols:"12",class:"d-flex justify-center gap-4"},{default:O(()=>[D(Nt,{type:"submit"},{default:O(()=>[..._[8]||(_[8]=[yt(" ÙÛØ±Ø§ÛØ´ ",-1)])]),_:1}),D(Nt,{color:"secondary",variant:"tonal",onClick:I},{default:O(()=>[..._[9]||(_[9]=[yt(" Ø¨Ø³ØªÙ ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"]),D(di,{"is-dialog-visible":V(s).isSelectUserDialogOpen,"onUpdate:isDialogVisible":_[6]||(_[6]=E=>V(s).isSelectUserDialogOpen=E),users:e.users,"selected-users":V(u),onSelectUser:A},null,8,["is-dialog-visible","users","selected-users"])],64)}}};function eh(t){const n=ia[t.data.orgPosition.id]||"rgb(var(--v-theme-on-secondary))";return`
    <div class="org-chart-node ${t.data._highlighted?"highlighted":""}" style="width: ${t.width}px; height: ${t.height}px;">
      <!-- Node Card -->
      <div class="org-chart-card">
        <!-- Action Buttons -->
        <div class="org-chart-action-bar">
          <button 
            class="node-action-btn" 
            data-action="edit" 
            data-node-id="${t.data.id}"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/>
              <path d="m15 5 4 4"/>
            </svg>
          </button>
          <button 
            class="node-action-btn" 
            data-action="add" 
            data-node-id="${t.data.id}"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 5v14"/>
              <path d="M5 12h14"/>
            </svg>
          </button>
          <button 
            class="node-action-btn" 
            data-action="delete" 
            data-node-id="${t.data.id}"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 6h18"/>
              <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
              <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
            </svg>
          </button>
        </div>
        <!-- OrgPosition (top) -->
        <div class="org-position" style="background-color: ${n};">
          ${t.data.orgPosition.name}
        </div>
        <!-- OrgUnit (middle) -->
        <div class="org-unit">
          ${t.data.orgUnit.name}
        </div>
      </div>
    </div>
  `}const nh={class:"d-flex flex-column justify-space-between"},rh={class:"org-chart-controls d-flex justify-space-between"},ih={__name:"organization-chart",async setup(t){let n,e;const r=Ne({hasError:!1,errorMessage:"",isDeleteNodeDialogOpen:!1,isAddNodeDialogOpen:!1,isEditNodeDialogOpen:!1}),i=Ne({updateOrganizationChart:!1}),a=W([]),s=W(null),o=W(null),c=W([]),l=W([]),u=W([]),h=W(null),d=W(null),g=W(!1),v=W(null),y=W(null),S=W(0),C=W(0),z=W(!1),A=Vi();Bt(()=>A.current.value.colors,async()=>{o.value&&a.value.length>0&&o.value.render()},{deep:!0});async function w(){await ie.get("/base/org-chart-node").then(({data:{data:k}})=>{a.value=k.map(B=>({id:B.id,parentId:B.parent_id,orgPosition:B.org_position,orgUnit:B.org_unit,users:B.users}))}).catch(({response:k})=>{console.error("Error fetching org chart nodes:",k.data.message),r.hasError=!0,r.errorMessage=k.data.message||"Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª ÚØ§Ø±Øª Ø³Ø§Ø²ÙØ§ÙÛ"})}async function I(){await ie.get("/base/org-position").then(({data:{data:k}})=>{c.value=k.sort((B,H)=>B.level-H.level)}).catch(({response:k})=>{console.error("Error fetching org positions:",k.data.message),r.hasError=!0,r.errorMessage=k.data.message||"Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª Ø³ÙØªâÙØ§Û Ø³Ø§Ø²ÙØ§ÙÛ"})}async function L(){await ie.get("/base/org-unit").then(({data:{data:k}})=>{l.value=k}).catch(({response:k})=>{console.error("Error fetching org units:",k.data.message),r.hasError=!0,r.errorMessage=k.data.message||"Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª ÙØ§Ø­Ø¯ÙØ§Û Ø³Ø§Ø²ÙØ§ÙÛ"})}async function x(){await ie.get("/base/user/details").then(({data:{data:k}})=>{u.value=k}).catch(({response:k})=>{console.error("Error fetching users:",k.data.message),r.hasError=!0,r.errorMessage=k.data.message||"Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù"})}async function _(){i.updateOrganizationChart=!0;const k=o.value.getChartState();a.value=k.allNodes.map(B=>B.data),await ie.put("/base/org-chart-node/update",{orgChartNodes:a.value}).then(()=>{et()}).catch(({response:B})=>{console.error("Error updating organization chart:",B.data.message),r.hasError=!0,r.errorMessage=B.data.message||"Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±ÙØ²Ø±Ø³Ø§ÙÛ ÚØ§Ø±Øª Ø³Ø§Ø²ÙØ§ÙÛ"}).finally(()=>{i.updateOrganizationChart=!1})}function F(){!s.value||a.value.length===0||(o.value=new dc().container(s.value).data(a.value).nodeWidth(()=>220).nodeHeight(()=>90).childrenMargin(()=>50).compactMarginBetween(()=>35).compactMarginPair(()=>30).neighbourMargin(()=>20).siblingsMargin(()=>30).nodeContent(k=>eh(k)).linkUpdate(function(){it(this).attr("stroke","rgb(var(--v-theme-secondary))").attr("stroke-opacity",.38).attr("stroke-width",1.5).attr("stroke-linecap","round")}).buttonContent(({node:k})=>`
        <div class="org-expand-btn">
          ${k.children?"â²":"â¼"} ${k.data._directSubordinates||""}
        </div>
      `).nodeEnter(function(){it(this).call(ts().filter(function(){return g.value&&this.classList.contains("draggable")}).on("start",function(k,B){b(this,k,B)}).on("drag",function(k){N(this,k)}).on("end",function(k){T(this,k)}))}).nodeUpdate(function(k){k.parent?it(this).classed("draggable",!0):it(this).classed("draggable",!1),it(this).classed("droppable",!0)}).render(),E())}function E(){s.value&&s.value.addEventListener("click",k=>{const B=k.target.closest(".node-action-btn");if(!B)return;k.stopPropagation();const H=B.dataset.action,U=B.dataset.nodeId;switch(H){case"edit":M(U);break;case"add":tt(U);break;case"delete":f(U);break}})}function M(k){const H=o.value.getChartState().allNodes.find(U=>String(U.data.id)===String(k));d.value=H.data,r.isEditNodeDialogOpen=!0}function G({id:k,parentId:B,orgPosition:H,orgUnit:U,users:nt}){a.value=a.value.filter(lt=>String(lt.id)!==String(k)),a.value.push({id:k,parentId:B,orgPosition:H,orgUnit:U,users:nt}),o.value.data(a.value).render()}function tt(k){h.value=k,r.isAddNodeDialogOpen=!0}function p({orgPosition:k,orgUnit:B,users:H}){o.value.addNode({id:`${Date.now()}-${Math.random()}`,parentId:h.value,orgPosition:k,orgUnit:B,users:H})}function f(k){h.value=k,r.isDeleteNodeDialogOpen=!0}function m(){o.value.removeNode(h.value),r.isDeleteNodeDialogOpen=!1}function b(k,B,H){v.value=H;const nt=B.subject.width/2,lt=B.x-nt;S.value=lt,C.value=Number.parseFloat(B.y),z.value=!0,it(k).classed("dragging",!0)}function N(k,B){if(!v.value)return;const H=o.value.getChartState(),U=it(k);if(z.value){z.value=!1,s.value.classList.add("dragging-active"),U.raise();const ot=B.subject.descendants(),mt=[...ot||[],B.subject],ye=ot.filter(st=>st.data.id!==B.subject.data.id);H.linksWrapper.selectAll("path.link").data(mt,st=>H.nodeId(st)).remove(),ye&&H.nodesWrapper.selectAll("g.node").data(ye,st=>H.nodeId(st)).remove()}y.value=null;const nt={width:B.subject.width,height:B.subject.height,left:B.x,right:B.x+B.subject.width,top:B.y,bottom:B.y+B.subject.height,midX:B.x+B.subject.width/2,midY:B.y+B.subject.height/2},lt=Go("g.node:not(.dragging)");lt.select("rect").attr("fill","none"),lt.filter(function(ot){const mt={left:ot.x,right:ot.x+ot.width,top:ot.y,bottom:ot.y+ot.height};if(nt.midX>mt.left&&nt.midX<mt.right&&nt.midY>mt.top&&nt.midY<mt.bottom&&this.classList.contains("droppable"))return y.value=ot,ot}).select("rect").attr("fill","rgba(var(--v-theme-success), 0.2)"),S.value+=Number.parseFloat(B.dx),C.value+=Number.parseFloat(B.dy),U.attr("transform",`translate(${S.value},${C.value})`)}function T(k,B){var lt,ot;if((lt=s.value)==null||lt.classList.remove("dragging-active"),!v.value)return;if(it(k).classed("dragging",!1),!y.value){o.value.render();return}if(((ot=B.subject.parent)==null?void 0:ot.data.id)===y.value.data.id){o.value.render();return}if(B.subject.descendants().some(mt=>mt.data.id===y.value.data.id)){o.value.render();return}it(k).remove();const U=o.value.getChartState().data,nt=U==null?void 0:U.find(mt=>String(mt.id)===String(B.subject.data.id));nt.parentId=y.value.data.id,y.value=null,v.value=null,o.value.render()}function R(k){if(k=K(k),!o.value)return;o.value.clearHighlighting();const B=o.value.data();if(k===""){o.value.data(B).render().fit();return}const H=B.filter(U=>K(U.orgUnit.name).includes(k)||U.users.some(nt=>K(nt.personnel_code)===k));H.forEach(U=>{U._highlighted=!0,U._expanded=!0;let nt=U;for(;nt.parentId;){const lt=B.find(ot=>String(ot.id)===String(nt.parentId));if(lt)lt._expanded=!0,nt=lt;else break}}),o.value.data(B).render(),H.length!==0&&o.value.setCentered(H[0].id).render()}function Y(){var k;g.value=!0,(k=s.value)==null||k.classList.add("drag-enabled")}function q(){var k;g.value=!1,(k=s.value)==null||k.classList.remove("drag-enabled")}async function et(){w(),await L(),await Pt(),F()}function K(k){return(k||"").toString().replace(/[\s\u200C]+/g,"")}return w(),I(),L(),[n,e]=Li(()=>x()),await n,e(),Oi(async()=>{await Pt(),F()}),(k,B)=>{const H=xr("IconBtn");return kt(),ce(It,null,[D(aa,{modelValue:V(r).hasError,"onUpdate:modelValue":B[0]||(B[0]=U=>V(r).hasError=U),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:O(()=>[yt(he(V(r).errorMessage),1)]),_:1},8,["modelValue"]),vt("div",nh,[vt("div",rh,[D(rn,{placeholder:"Ø¬Ø³ØªØ¬Ù Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ§Ø­Ø¯ ÛØ§ Ú©Ø¯ Ù¾Ø±Ø³ÙÙÛ ...","prepend-inner-icon":"tabler-search",clearable:"",style:{"max-inline-size":"300px"},"onUpdate:modelValue":R}),V(g)?(kt(),ue(Nt,{key:1,color:"success",variant:"tonal",onClick:q},{default:O(()=>[D(Yt,{start:"",icon:"tabler-check"}),B[5]||(B[5]=yt(" ØªØ§ÛÛØ¯ ",-1))]),_:1})):(kt(),ue(Nt,{key:0,color:"secondary",variant:"tonal",onClick:Y},{default:O(()=>[D(Yt,{start:"",icon:"tabler-arrows-move"}),B[4]||(B[4]=yt(" Ø³Ø§Ø²ÙØ§ÙØ¯ÙÛ ",-1))]),_:1}))]),vt("div",{ref_key:"orgChartRef",ref:s,class:"org-chart-container"},null,512),D(H,{size:"x-large",variant:"elevated",color:"primary",loading:V(i).updateOrganizationChart,onClick:_},{default:O(()=>[D(Yt,{icon:"tabler-device-floppy",size:"35"})]),_:1},8,["loading"])]),D(vi,{"is-dialog-visible":V(r).isDeleteNodeDialogOpen,"onUpdate:isDialogVisible":B[1]||(B[1]=U=>V(r).isDeleteNodeDialogOpen=U),title:"Ø¢ÛØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛÙ ÙÙØ±Ø¯ Ø§Ø·ÙÛÙØ§Ù Ø¯Ø§Ø±ÛØ¯Ø",loading:!1,onConfirm:m},null,8,["is-dialog-visible"]),D(Qc,{"is-dialog-visible":V(r).isAddNodeDialogOpen,"onUpdate:isDialogVisible":B[2]||(B[2]=U=>V(r).isAddNodeDialogOpen=U),"org-positions":V(c),"org-units":V(l),users:V(u),onAdd:p},null,8,["is-dialog-visible","org-positions","org-units","users"]),D(th,{"is-dialog-visible":V(r).isEditNodeDialogOpen,"onUpdate:isDialogVisible":B[3]||(B[3]=U=>V(r).isEditNodeDialogOpen=U),"org-positions":V(c),"org-units":V(l),users:V(u),node:V(d),onEdit:G},null,8,["is-dialog-visible","org-positions","org-units","users","node"])],64)}}},Rh=Ii(ih,[["__scopeId","data-v-7a4406e3"]]);export{Rh as default};
