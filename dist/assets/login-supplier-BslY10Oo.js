import{r as q,m as M}from"./validators-CT5dUf4l.js";import{M as T,bC as k,j as I,k as U,r as l,a as j,c as z,o as A,b as t,e as a,v as n,n as o,bq as x,x as g,d as s,I as v,bx as B,am as D,F as L,au as $}from"./index-BdyBgPhu.js";import{_ as O}from"./AppTextField-Bee4Bp4n.js";import{u as G,m as P,a as W}from"./misc-mask-light-BUTDkFMy.js";import{V as H}from"./VNodeRenderer-Dqs2tMLK.js";import{$ as J}from"./api-bY8qQkwS.js";import{V as N}from"./VSnackbar-ZHXLpg9D.js";import{a as c,V as w}from"./VRow-B98VMxdY.js";import{V as K}from"./VCard-EcF8lLvp.js";import{V as y}from"./VCardText-64sSaMeK.js";import{V as Q}from"./VForm-BAMYe4K_.js";import"./helpers-4BKJjDfb.js";import"./VTextField-BnlZ2Rzr.js";import"./VCounter-BunzhgoT.js";import"./VField-C8TvHZ1t.js";import"./VOverlay-C2gdwYAH.js";import"./useLogout-Cpw41dxa.js";/* empty css              */import"./createSimpleFunctional-DPrYPKAz.js";const X={class:"auth-logo d-flex align-center gap-x-3"},Y={class:"auth-title"},Z={class:"position-relative bg-background w-100 me-0"},ee=["src"],te={class:"text-h4 mb-1"},oe={class:"text-capitalize"},ae=Object.assign({beforeRouteEnter(R,_,m){if(k("otpExpiresAt").value>Math.floor(Date.now()/1e3))return m({name:"two-step-supplier"});m()}},{__name:"login-supplier",setup(R){const _=G(W,P),m=I(),S=U(),d=l({mobileNumber:void 0,other:void 0}),h=l(),p=l({mobileNumber:""}),f=l(!1),b=l(!1),V=l(m.query.isRedirectedFromUnauthorizedStatus==="true");async function C(){b.value=!0;try{const r=await J("/login-supplier",{method:"POST",body:{mobileNumber:p.value.mobileNumber},onResponseError({response:i}){b.value=!1,i._data.errors?d.value=i._data.errors:(d.value.other=i._data.message,f.value=!0)}}),{otpExpiresAt:e}=r;k("otpExpiresAt").value=e,await $(()=>{S.replace({path:"/two-step-supplier",query:{mobileNumber:p.value.mobileNumber}})})}catch{}}function F(){var r;(r=h.value)==null||r.validate().then(({valid:e})=>{e&&C()})}return(r,e)=>{const i=j("RouterLink"),E=O;return A(),z(L,null,[t(N,{modelValue:o(V),"onUpdate:modelValue":e[0]||(e[0]=u=>x(V)?V.value=u:null),timeout:5e3,location:"center",variant:"outlined",color:"error"},{default:a(()=>[...e[3]||(e[3]=[n(" زمان اعتبار توکن شما 8 ساعت می‌باشد و هم‌اکنون منقضی شده‌است. لطفاً دوباره وارد شوید. ",-1)])]),_:1},8,["modelValue"]),t(N,{modelValue:o(f),"onUpdate:modelValue":e[1]||(e[1]=u=>x(f)?f.value=u:null),timeout:2e3,location:"center",variant:"outlined",color:"error"},{default:a(()=>[n(g(o(d).other),1)]),_:1},8,["modelValue"]),t(i,{to:"/"},{default:a(()=>[s("div",X,[t(o(H),{nodes:o(v).app.logo},null,8,["nodes"]),s("h1",Y,g(o(v).app.title),1)])]),_:1}),t(w,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:a(()=>[t(c,{md:"8",class:"d-none d-md-flex"},{default:a(()=>[s("div",Z,[e[4]||(e[4]=s("div",{class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},null,-1)),s("img",{class:"auth-footer-mask",src:o(_),alt:"auth-footer-mask",height:"280",width:"100"},null,8,ee)])]),_:1}),t(c,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:a(()=>[t(K,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:a(()=>[t(y,null,{default:a(()=>[s("h4",te,[e[5]||(e[5]=n(" خوش آمدید ",-1)),s("span",oe,g(o(v).app.title),1),e[6]||(e[6]=n("! 👋🏻 ",-1))]),e[7]||(e[7]=s("p",{class:"mb-0"}," جهت ورود به سامانه، شماره تلفن همراه خود را وارد کنید ",-1))]),_:1}),t(y,null,{default:a(()=>[t(o(Q),{ref_key:"refVForm",ref:h,"validate-on":"submit lazy",onSubmit:B(F,["prevent"])},{default:a(()=>[t(w,null,{default:a(()=>[t(c,{cols:"12"},{default:a(()=>[t(E,{modelValue:o(p).mobileNumber,"onUpdate:modelValue":e[2]||(e[2]=u=>o(p).mobileNumber=u),label:"شماره تلفن همراه",placeholder:"مثلاً: 09123456789",type:"number",autofocus:"",rules:["requiredValidator"in r?r.requiredValidator:o(q),"mobileNumberValidator"in r?r.mobileNumberValidator:o(M)],"error-messages":o(d).mobileNumber},null,8,["modelValue","rules","error-messages"])]),_:1}),t(c,{cols:"12"},{default:a(()=>[t(D,{block:"",type:"submit",loading:o(b),disabled:o(b)},{default:a(()=>[...e[8]||(e[8]=[n(" ارسال کد تأیید ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}}),Ne=T(ae,[["__scopeId","data-v-1ff1d624"]]);export{Ne as default};
