import{V as K,m as L}from"./VField-BsMtzMvq.js";import{V as q}from"./VOverlay-DvC-zOaM.js";import{av as Z,a6 as J,aS as M,aE as Y,aD as $,al as G,Y as b,r as y,b4 as H,cP as Q,dk as U,b5 as W,w as h,b1 as X,Z as f,au as ee,ab as te,bT as ae,d as v,J as ne,b as V,F as le,y as ue,s as F,bK as oe,cE as ie,aI as se,aZ as re,cu as S}from"./index-B_AKHj9V.js";const ce=J({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...re(),...se(),...ie(L({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),me=Z()({name:"VOtpInput",props:ce(),emits:{finish:t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,A){let{attrs:I,emit:P,slots:c}=A;const{dimensionStyles:w}=M(t),{isFocused:k,focus:D,blur:_}=Y(t),i=$(t,"modelValue","",e=>e==null?[]:String(e).split(""),e=>e.join("")),{t:B}=G(),d=b(()=>Number(t.length)),R=b(()=>Array(d.value).fill(0)),o=y(-1),m=y(),s=y([]),p=b(()=>s.value[o.value]);let g=!1;H(()=>t.autofocus,()=>{const e=Q();e.run(()=>{const{intersectionRef:a,isIntersecting:l}=U();W(()=>{a.value=s.value[0]}),h(l,u=>{var n;u&&((n=a.value)==null||n.focus(),e.stop())})})});function C(){if(x(p.value.value)){p.value.value="";return}if(g)return;const e=i.value.slice(),a=p.value.value;e[o.value]=a;let l=null;o.value>i.value.length?l=i.value.length+1:o.value+1!==d.value&&(l="next"),i.value=e,l&&S(m.value,l)}function N(){g=!1,C()}function O(e){const a=i.value.slice(),l=o.value;let u=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(e.key)&&(e.preventDefault(),e.key==="ArrowLeft"?u="prev":e.key==="ArrowRight"?u="next":["Backspace","Delete"].includes(e.key)&&(a[o.value]="",i.value=a,o.value>0&&e.key==="Backspace"?u="prev":requestAnimationFrame(()=>{var n;(n=s.value[l])==null||n.select()})),requestAnimationFrame(()=>{u!=null&&S(m.value,u)}))}function T(e,a){var n,r;a.preventDefault(),a.stopPropagation();const l=((n=a==null?void 0:a.clipboardData)==null?void 0:n.getData("Text").trim().slice(0,d.value))??"",u=l.length-1===-1?e:l.length-1;x(l)||(i.value=l.split(""),(r=s.value)==null||r[u].focus())}function j(){i.value=[]}function z(e,a){D(),o.value=a}function E(){_(),o.value=-1}function x(e){return t.type==="number"&&/[^0-9]/g.test(e)}return X({VField:{color:f(()=>t.color),bgColor:f(()=>t.color),baseColor:f(()=>t.baseColor),disabled:f(()=>t.disabled),error:f(()=>t.error),variant:f(()=>t.variant)}},{scoped:!0}),h(i,e=>{e.length===d.value&&(o.value=d.value-1,P("finish",e.join("")))},{deep:!0}),h(o,e=>{e<0||ee(()=>{var a;(a=s.value[e])==null||a.select()})}),te(()=>{var l;const[e,a]=ae(I);return v("div",F({class:["v-otp-input",{"v-otp-input--divided":!!t.divider},t.class],style:[t.style]},e),[v("div",{ref:m,class:"v-otp-input__content",style:ne([w.value])},[R.value.map((u,n)=>v(le,null,[t.divider&&n!==0&&v("span",{class:"v-otp-input__divider"},[t.divider]),V(K,{focused:k.value&&t.focusAll||o.value===n,key:n},{...c,loader:void 0,default:()=>v("input",{ref:r=>s.value[n]=r,"aria-label":B(t.label,n+1),autofocus:n===0&&t.autofocus,autocomplete:"one-time-code",class:ue(["v-otp-input__field"]),disabled:t.disabled,inputmode:t.type==="number"?"numeric":"text",min:t.type==="number"?0:void 0,maxlength:n===0?d.value:"1",placeholder:t.placeholder,type:t.type==="number"?"text":t.type,value:i.value[n],onInput:C,onFocus:r=>z(r,n),onBlur:E,onKeydown:O,onCompositionstart:()=>g=!0,onCompositionend:N,onPaste:r=>T(n,r)},null)})])),v("input",F({class:"v-otp-input-input",type:"hidden"},a,{value:i.value.join("")}),null),V(q,{contained:!0,contentClass:"v-otp-input__loader",modelValue:!!t.loading,persistent:!0},{default:()=>{var u;return[((u=c.loader)==null?void 0:u.call(c))??V(oe,{color:typeof t.loading=="boolean"?void 0:t.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(l=c.default)==null?void 0:l.call(c)])])}),{blur:()=>{var e;(e=s.value)==null||e.some(a=>a.blur())},focus:()=>{var e;(e=s.value)==null||e[0].focus()},reset:j,isFocused:k}}});export{me as V};
