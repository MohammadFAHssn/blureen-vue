import{r as U}from"./validators-BQd4MaJQ.js";import{_ as ze}from"./DialogCloseBtn-CoyrTO-l.js";import{j as Re}from"./index-OQa6WG-U.js";import{_ as Ee}from"./AreYouSureDialog-CBSm6D2Z.js";import{bJ as ye,r as C,Y as oe,H as Ce,a as je,c as $,o as c,b as e,f as V,m as E,e as t,n as s,v as i,x as u,d as a,bv as T,am as S,F as N,i as K,a2 as v,a1 as Y,s as Ye,bF as he}from"./index-Zo5xFMHK.js";import{$ as P}from"./api-Dcx6azKG.js";import{V as ge}from"./VSnackbar-U2C-74aF.js";import{V as q}from"./VRow-BJj2z0Kr.js";import{V as M}from"./VCol-CeyytSgb.js";import{V as te,b as Se}from"./VCard-DYigshVT.js";import{V as fe}from"./VTextField-D8-QM1S_.js";import{V as qe}from"./VSelect-CWKpJGOA.js";import{a as _e,V as J}from"./VRadioGroup-CISW4a-S.js";import{V as xe}from"./VAutocomplete-JSUZgRHu.js";import{V as me}from"./VTable-BXfo3hVs.js";import{V as Pe}from"./VTooltip-COjBC_mo.js";import{V as be}from"./VSkeletonLoader-hXWjWOC5.js";import{V as ne,a as ue,b as ie,c as H}from"./VExpansionPanels-hf91PjsT.js";import{V as $e}from"./VContainer-BHuiBpaC.js";import{V as Ue}from"./VCardText-pIGyHu80.js";import{V as L}from"./VDivider-Bj56bceO.js";import{V as Te}from"./VDialog-C5f28Glv.js";import"./helpers-CcX6MmOA.js";import"./index-CvOPxmL5.js";import"./useLogout-C3fX3UoL.js";import"./VOverlay-BPrCTNzd.js";/* empty css              */import"./createSimpleFunctional-BT0kG59Z.js";import"./autofocus-UVnPG88R.js";import"./VCounter-C1unP97H.js";import"./VField-COyD4MGe.js";import"./VList-Kh2ZBOoT.js";import"./dialog-transition-CqAAWcbQ.js";import"./VMenu-C-XGUZbx.js";import"./VCheckboxBtn-ByUD6M-u.js";import"./filter-DzTpDBaj.js";const Fe={class:"ma-3 overflow-auto d-none d-md-block"},Ae={class:"py-2"},Ge={style:{"max-width":"420px","white-space":"normal","overflow-wrap":"anywhere"}},Be={key:3,class:"text-center"},Ne={class:"d-md-none pa-3"},Oe={class:"d-flex flex-column w-100"},Ke={class:"d-flex justify-space-between align-center mb-1"},Le={class:"font-weight-medium"},Ie={class:"d-flex justify-space-between align-center"},Je={class:"d-flex justify-space-between align-center"},He={class:"pa-2"},Qe={class:"mt-2 text-center"},We={class:"d-flex flex-column w-100"},Xe={class:"d-flex justify-space-between align-center mb-1"},Ze={class:"font-weight-medium"},el={class:"d-flex justify-space-between align-center"},ll={class:"pa-2"},tl={class:"mb-2 d-flex justify-space-between align-start"},al={style:{"max-width":"100%","white-space":"normal","overflow-wrap":"anywhere","word-break":"break-word","text-align":"right",flex:"1"}},sl={class:"mt-2 text-center"},rl={key:3,class:"text-center"},ol={style:{"white-space":"normal","overflow-wrap":"anywhere"}},nl={__name:"ReservationForGuestAndContractor",setup(we){const f=ye({success:!1,successMessage:"",hasError:!1,errorMessage:"",isDeleteDialogVisible:!1,isDetailsDialogVisible:!1}),_=ye({fetchingReservedMeals:!0,fetchingMeals:!1,fetchingContractors:!1,reserveMeal:!1,editReservedMeal:!1,deleteReservedMeal:!1}),b=C([]),x=C(""),Q=C(null),de=C([]),ce=C([]),A=C([]),O=C([]),G=C(null),F=C(null),m=C(null),w=C(null),W=C(null),X=C(null),D=C(null),ve=[n=>n==null||n===""||/^\d+$/.test(String(n))?!0:"فقط باید عدد باشد!"],pe=oe(()=>!b.value||b.value.length===0?"":Array.isArray(b.value)?b.value.join(" - "):b.value);function Ve(){return Array.isArray(b.value)?b.value.filter(Boolean):b.value?[b.value]:[]}function B(n){f.hasError=!0,f.errorMessage=n}async function Z(){var z,r;const n=Ve();if(!n.length){B("لطفاً حداقل یک تاریخ برای رزرو انتخاب کنید.");return}for(const g of n){const[y,k,R]=String(g).split("/").map(Number);if(y*1e4+k*100+R<Q.value){B("امکان رزرو غذا فقط برای زمان حال و آینده وجود دارد.");return}}_.reserveMeal=!0;const l=(r=(z=he("userData"))==null?void 0:z.value)==null?void 0:r.id,p=D.value==="contractor"?{date:b.value,meal_id:F.value,reserve_type:"contractor",supervisor_id:l,contractor:G.value,quantity:w.value}:{date:b.value,meal_id:F.value,reserve_type:"guest",supervisor_id:l,quantity:w.value,description:W.value,serve_place:X.value};try{if(await P("/food/meal-reservation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p),onResponseError({response:g}){var y,k;if(f.hasError=!0,(y=g._data)!=null&&y.errors){const R=Object.values(g._data.errors).flat().join(" | ");f.errorMessage=R}else f.errorMessage=((k=g._data)==null?void 0:k.message)||"خطا در ایجاد"}}),f.hasError)return;f.success=!0,f.successMessage="رزرو با موفقیت انجام شد.",D.value==="contractor"?I():se(),G.value=null,F.value=null,w.value=null,W.value=null}catch(g){console.error("Error submitting reservation:",g)}finally{_.reserveMeal=!1}}function ee(n){m.value=n,f.isDeleteDialogVisible=!0}async function ke(){if(m.value){_.deleteReservedMeal=!0;try{const n=await P(`/food/meal-reservation/${m.value.id}`,{method:"DELETE",onResponseError({response:l}){var p;B(((p=l._data)==null?void 0:p.message)||"خطا در حذف رزرو")}});if(f.hasError)return;f.isDeleteDialogVisible=!1,n!=null&&n.data?D.value==="contractor"?A.value=A.value.filter(l=>l.id!==m.value.id):D.value==="guest"&&(O.value=O.value.filter(l=>l.id!==m.value.id)):(B("نمیتوان رزرو تحویل شده را حذف کرد"),D.value==="contractor"?I():D.value==="guest"&&se())}catch(n){console.error(n)}finally{_.deleteReservedMeal=!1}}}function ae(n){m.value=n,f.isDetailsDialogVisible=!0}async function I(){A.value=[],_.fetchingReservedMeals=!0;try{const n=await P("/food/meal-reservation/get-for-contractor-on-date",{method:"GET",params:{"date[]":b.value}});A.value=(n.data||[]).flat()}catch(n){console.error("Error fetching reserved meals:",n),B("خطا در دریافت رزروها")}finally{_.fetchingReservedMeals=!1}}async function se(){O.value=[],_.fetchingReservedMeals=!0;try{const n=await P("/food/meal-reservation/get-for-guest-on-date",{method:"GET",params:{"date[]":b.value}});O.value=(n.data||[]).flat()}catch(n){console.error("Error fetching reserved meals:",n),B("خطا در دریافت رزروها")}finally{_.fetchingReservedMeals=!1}}async function De(){_.fetchingContractors=!0;try{const n=await P("/contractor/get-actives",{method:"GET"});ce.value=(n==null?void 0:n.data.contractors)||[]}catch(n){console.error("Error fetching contractors:",n),B(n.message||"خطا در دریافت پیمانکاران")}finally{_.fetchingContractors=!1}}async function re(){_.fetchingMeals=!0;try{const n=await P("/food/meal/get-actives",{method:"GET"});de.value=(n==null?void 0:n.data.meals)||[]}catch(n){console.error("Error fetching meals:",n),B(n.message||"خطا در دریافت وعده‌ها")}finally{_.fetchingMeals=!1}}function le(){D.value==="contractor"?I():se()}function d(n){f.isDetailsDialogVisible=n,n||(m.value=null)}const o=oe(()=>[...A.value].sort((n,l)=>String(n.date).localeCompare(String(l.date)))),h=oe(()=>[...O.value].sort((n,l)=>String(n.date).localeCompare(String(l.date))));return Ce(async()=>{D.value="contractor",X.value="deliver",await Promise.all([re(),De()]);const n=new Date,l=new Date(n);l.setDate(l.getDate()+30);const[p,z]=[n,l].map(g=>Re.toJalaali(g.getFullYear(),g.getMonth()+1,g.getDate()));Q.value=p.jy*1e4+p.jm*100+p.jd;const r=g=>`${g.jy}/${String(g.jm).padStart(2,"0")}/${String(g.jd).padStart(2,"0")}`;b.value=[r(p)],x.value=r(z),await I()}),(n,l)=>{const p=je("PersianDatetimePicker"),z=ze;return c(),$(N,null,[e($e,null,{default:t(()=>[e(ge,{modelValue:s(f).hasError,"onUpdate:modelValue":l[0]||(l[0]=r=>s(f).hasError=r),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:t(()=>[i(u(s(f).errorMessage),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:s(f).success,"onUpdate:modelValue":l[1]||(l[1]=r=>s(f).success=r),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:t(()=>[i(u(s(f).successMessage),1)]),_:1},8,["modelValue"]),e(q,{dense:""},{default:t(()=>[e(M,{cols:"12",md:"4",class:"d-flex justify-center mb-4 mb-md-0"},{default:t(()=>[l[12]||(l[12]=a("input",{id:"custom-input",style:{display:"none"}},null,-1)),e(p,{modelValue:s(b),"onUpdate:modelValue":l[2]||(l[2]=r=>T(b)?b.value=r:null),format:"jYYYY/jMM/jDD",inline:"",multiple:"",max:s(x),"custom-input":"#custom-input",onChange:le},null,8,["modelValue","max"])]),_:1}),e(M,{cols:"12",md:"8"},{default:t(()=>[e(te,{class:"mb-4"},{default:t(()=>[l[14]||(l[14]=a("label",{class:"font-weight-medium mb-2 mt-2 d-block text-center"}," جزئیات ",-1)),e(q,{class:"mb-4 px-4"},{default:t(()=>[e(M,{cols:"12",sm:"12",md:"12"},{default:t(()=>[e(fe,{"model-value":s(pe),label:"تاریخ رزرو",variant:"outlined",readonly:"",rules:["requiredValidator"in n?n.requiredValidator:s(U)]},null,8,["model-value","rules"])]),_:1}),e(M,{cols:"12",md:"12"},{default:t(()=>[e(qe,{modelValue:s(F),"onUpdate:modelValue":l[3]||(l[3]=r=>T(F)?F.value=r:null),items:s(de),"item-title":"name","item-value":"id",label:"وعده",variant:"outlined",clearable:"",rules:["requiredValidator"in n?n.requiredValidator:s(U)]},null,8,["modelValue","items","rules"])]),_:1}),e(_e,{modelValue:s(D),"onUpdate:modelValue":l[4]||(l[4]=r=>T(D)?D.value=r:null),rules:["requiredValidator"in n?n.requiredValidator:s(U)],class:"mt-2",inline:"",onChange:le},{default:t(()=>[e(J,{label:"پیمانکار",value:"contractor"}),e(J,{label:"میهمان",value:"guest"})]),_:1},8,["modelValue","rules"]),s(D)==="guest"?(c(),V(M,{key:0,cols:"12",class:"mb-3"},{default:t(()=>[e(fe,{modelValue:s(w),"onUpdate:modelValue":l[5]||(l[5]=r=>T(w)?w.value=r:null),label:"تعداد",variant:"outlined",rules:["requiredValidator"in n?n.requiredValidator:s(U),...ve]},null,8,["modelValue","rules"]),e(fe,{modelValue:s(W),"onUpdate:modelValue":l[6]||(l[6]=r=>T(W)?W.value=r:null),label:"توضیحات",variant:"outlined",rules:["requiredValidator"in n?n.requiredValidator:s(U)]},null,8,["modelValue","rules"]),e(_e,{modelValue:s(X),"onUpdate:modelValue":l[7]||(l[7]=r=>T(X)?X.value=r:null),rules:["requiredValidator"in n?n.requiredValidator:s(U)],class:"mt-2",inline:""},{default:t(()=>[e(J,{label:"سرو در آشپزخانه",value:"serve_in_kitchen"}),e(J,{label:"تحویل",value:"deliver"})]),_:1},8,["modelValue","rules"])]),_:1})):s(D)==="contractor"?(c(),V(M,{key:1,cols:"12",sm:"12",md:"12"},{default:t(()=>[e(xe,{modelValue:s(G),"onUpdate:modelValue":l[8]||(l[8]=r=>T(G)?G.value=r:null),items:s(ce),"item-title":"fullName","item-value":"id",label:"پیمانکار",chips:"",clearable:"",variant:"outlined",rules:["requiredValidator"in n?n.requiredValidator:s(U)]},null,8,["modelValue","items","rules"]),e(fe,{modelValue:s(w),"onUpdate:modelValue":l[9]||(l[9]=r=>T(w)?w.value=r:null),label:"تعداد",variant:"outlined",rules:["requiredValidator"in n?n.requiredValidator:s(U),...ve]},null,8,["modelValue","rules"])]),_:1})):E("",!0)]),_:1}),e(q,{justify:"center",class:"mb-4"},{default:t(()=>[e(M,{cols:"auto"},{default:t(()=>[e(S,{color:"primary",loading:s(_).reserveMeal,disabled:s(_).reserveMeal,onClick:Z},{default:t(()=>[...l[13]||(l[13]=[i(" ثبت ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),a("div",Fe,[e(te,{class:"pa-4"},{default:t(()=>[l[18]||(l[18]=a("label",{class:"font-weight-medium mb-4 d-block text-center"}," رزروهای تاریخ‌های انتخاب شده ",-1)),!s(_).fetchingReservedMeals&&s(D)==="contractor"&&s(o).length>0?(c(),V(me,{key:0},{default:t(()=>[l[15]||(l[15]=a("thead",null,[a("tr",null,[a("th",null,"ردیف"),a("th",null,"وعده"),a("th",null,"کد تحویل"),a("th",null,"وضعیت"),a("th",null,"تاریخ"),a("th",null,"پیمانکار"),a("th",null,"تعداد"),a("th",null,"عملیات")])],-1)),a("tbody",null,[(c(!0),$(N,null,K(s(o),(r,g)=>{var y,k;return c(),$("tr",{key:r.id},[a("td",null,u(g+1),1),a("td",null,u((y=r.meal)==null?void 0:y.name),1),a("td",null,[e(v,{color:"success"},{default:t(()=>[i(u(r.delivery_code),1)]),_:2},1024)]),a("td",null,[e(v,{color:r.status?"success":"error",size:"small"},{default:t(()=>[i(u(r.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])]),a("td",null,[e(v,null,{default:t(()=>[i(u(r.date),1)]),_:2},1024)]),a("td",null,[e(v,null,{default:t(()=>{var R,j;return[i(u((j=(R=r.details)==null?void 0:R[0])!=null&&j.contractor?`${r.details[0].contractor.first_name} ${r.details[0].contractor.last_name}`:"—"),1)]}),_:2},1024)]),a("td",null,u((k=r.details)==null?void 0:k.reduce((R,j)=>R+(j.quantity||0),0)),1),a("td",null,[r.status?E("",!0):(c(),V(S,{key:0,color:"red",variant:"plain",size:"small",onClick:R=>ee(r)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])),e(S,{color:"primary",variant:"plain",size:"small",onClick:R=>ae(r)},{default:t(()=>[e(Y,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])}),128))])]),_:1})):!s(_).fetchingReservedMeals&&s(D)==="guest"&&s(h).length>0?(c(),V(me,{key:1},{default:t(()=>[l[16]||(l[16]=a("thead",null,[a("tr",null,[a("th",null,"ردیف"),a("th",null,"وعده"),a("th",null,"کد تحویل"),a("th",null,"وضعیت"),a("th",null,"تاریخ"),a("th",null,"رزرو شده توسط"),a("th",null,"سرو غذا"),a("th",null,"تعداد"),a("th",null,"توضیحات"),a("th",null,"عملیات")])],-1)),a("tbody",null,[(c(!0),$(N,null,K(s(h),(r,g)=>{var y,k,R;return c(),$("tr",{key:r.id},[a("td",null,u(g+1),1),a("td",null,u((y=r.meal)==null?void 0:y.name),1),a("td",null,[e(v,{color:"success"},{default:t(()=>[i(u(r.delivery_code),1)]),_:2},1024)]),a("td",null,[e(v,{color:r.status?"success":"error",size:"small"},{default:t(()=>[i(u(r.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])]),a("td",null,[e(v,null,{default:t(()=>[i(u(r.date),1)]),_:2},1024)]),a("td",null,[e(v,null,{default:t(()=>[i(u(r.created_by?`${r.created_by.first_name} ${r.created_by.last_name}`:"—"),1)]),_:2},1024)]),a("td",null,[e(v,{size:"small"},{default:t(()=>[i(u(r.serve_place==="serve_in_kitchen"?"سرو در آشپزخانه":"تحویل"),1)]),_:2},1024)]),a("td",null,u((k=r.details)==null?void 0:k.reduce((j,Me)=>j+(Me.quantity||0),0)),1),a("td",Ae,[e(Pe,{location:"top",disabled:!(((R=r.description)==null?void 0:R.length)>6)},{activator:t(({props:j})=>[a("div",Ye({ref_for:!0},j,{class:"text-truncate",style:{"max-width":"120px"}}),u(r.description||"—"),17)]),default:t(()=>[a("div",Ge,u(r.description),1)]),_:2},1032,["disabled"])]),a("td",null,[r.status?E("",!0):(c(),V(S,{key:0,color:"red",variant:"plain",size:"small",onClick:j=>ee(r)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])),e(S,{color:"primary",variant:"plain",size:"small",onClick:j=>ae(r)},{default:t(()=>[e(Y,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])}),128))])]),_:1})):s(_).fetchingReservedMeals?(c(),V(be,{key:2,type:"card"})):(c(),$("div",Be,[e(v,{color:"error"},{default:t(()=>[...l[17]||(l[17]=[i(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))]),_:1})]),a("div",Ne,[e(ne,{variant:"accordion"},{default:t(()=>[e(ue,null,{default:t(()=>[e(ie,{class:"font-weight-bold"},{default:t(()=>[...l[19]||(l[19]=[i(" رزروهای تاریخ‌های انتخاب شده ",-1)])]),_:1}),!s(_).fetchingReservedMeals&&s(D)==="contractor"&&s(o).length>0?(c(),V(H,{key:0},{default:t(()=>[e(ne,{variant:"accordion"},{default:t(()=>[(c(!0),$(N,null,K(s(o),r=>(c(),V(ue,{key:r.id,class:"mb-2"},{default:t(()=>[e(ie,null,{default:t(()=>{var g;return[a("div",Oe,[a("div",Ke,[a("span",Le,u((g=r.meal)==null?void 0:g.name),1),e(v,{size:"small"},{default:t(()=>[i(u(r.date),1)]),_:2},1024)]),a("div",Ie,[e(v,{color:"success"},{default:t(()=>[i(u(r.delivery_code),1)]),_:2},1024),e(v,{color:r.status?"success":"error",size:"small",label:""},{default:t(()=>[i(u(r.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])]),a("div",Je,[e(v,null,{default:t(()=>{var y,k;return[i(u((k=(y=r.details)==null?void 0:y[0])!=null&&k.contractor?`${r.details[0].contractor.first_name} ${r.details[0].contractor.last_name}`:"—"),1)]}),_:2},1024)])])]}),_:2},1024),e(H,null,{default:t(()=>{var g;return[a("div",He,[a("div",null,[l[20]||(l[20]=a("strong",null,"تعداد:",-1)),i(" "+u((g=r.details)==null?void 0:g.reduce((y,k)=>y+(k.quantity||0),0)),1)]),a("div",Qe,[r.status?E("",!0):(c(),V(S,{key:0,color:"red",variant:"plain",size:"small",onClick:y=>ee(r)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])),e(S,{color:"primary",variant:"plain",size:"small",onClick:y=>ae(r)},{default:t(()=>[e(Y,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):!s(_).fetchingReservedMeals&&s(D)==="guest"&&s(h).length>0?(c(),V(H,{key:1},{default:t(()=>[e(ne,{variant:"accordion"},{default:t(()=>[(c(!0),$(N,null,K(s(h),r=>(c(),V(ue,{key:r.id,class:"mb-2"},{default:t(()=>[e(ie,null,{default:t(()=>{var g;return[a("div",We,[a("div",Xe,[a("span",Ze,u((g=r.meal)==null?void 0:g.name),1),e(v,{size:"small"},{default:t(()=>[i(u(r.date),1)]),_:2},1024)]),a("div",el,[e(v,{color:"success"},{default:t(()=>[i(u(r.delivery_code),1)]),_:2},1024),e(v,{color:r.status?"success":"error",size:"small",label:""},{default:t(()=>[i(u(r.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])])])]}),_:2},1024),e(H,null,{default:t(()=>{var g;return[a("div",ll,[a("div",null,[l[21]||(l[21]=a("strong",null,"سرو غذا:",-1)),e(v,{size:"small"},{default:t(()=>[i(u(r.serve_place==="serve_in_kitchen"?"سرو در آشپزخانه":"تحویل"),1)]),_:2},1024)]),a("div",null,[l[22]||(l[22]=a("strong",null,"تعداد:",-1)),i(" "+u((g=r.details)==null?void 0:g.reduce((y,k)=>y+(k.quantity||0),0)),1)]),a("div",tl,[l[23]||(l[23]=a("strong",{class:"me-2"},"توضیحات:",-1)),a("div",al,u(r.description||"—"),1)]),a("div",sl,[r.status?E("",!0):(c(),V(S,{key:0,color:"red",variant:"plain",size:"small",onClick:y=>ee(r)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])),e(S,{color:"primary",variant:"plain",size:"small",onClick:y=>ae(r)},{default:t(()=>[e(Y,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):s(_).fetchingReservedMeals?(c(),V(be,{key:2,type:"card"})):(c(),$("div",rl,[e(v,{color:"error"},{default:t(()=>[...l[24]||(l[24]=[i(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),s(f).isDeleteDialogVisible?(c(),V(Ee,{key:0,"is-dialog-visible":s(f).isDeleteDialogVisible,"onUpdate:isDialogVisible":l[10]||(l[10]=r=>s(f).isDeleteDialogVisible=r),title:"آیا از حذف این رزرو اطمینان دارید؟",loading:s(_).deleteReservedMeal,onConfirm:ke},null,8,["is-dialog-visible","loading"])):E("",!0),s(m)?(c(),V(Te,{key:1,width:n.$vuetify.display.smAndDown?"auto":900,"model-value":s(f).isDetailsDialogVisible,"onUpdate:modelValue":d},{default:t(()=>[e(z,{onClick:l[11]||(l[11]=r=>d(!1))}),e(te,null,{default:t(()=>[e(Se,{class:"text-h6"},{default:t(()=>[...l[25]||(l[25]=[i(" جزئیات ",-1)])]),_:1}),e(Ue,null,{default:t(()=>[e(q,null,{default:t(()=>[e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[26]||(l[26]=a("strong",null,"رزرو کننده:",-1)),e(v,{color:"orange",size:"small"},{default:t(()=>[i(u(s(m).created_by?`${s(m).created_by.first_name} ${s(m).created_by.last_name}`:"—"),1)]),_:1})])]),_:1}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[27]||(l[27]=a("strong",null,"کد پرسنلی:",-1)),e(v,{color:"orange",size:"small"},{default:t(()=>[i(u(s(m).created_by?`${s(m).created_by.personnel_code}`:"—"),1)]),_:1})])]),_:1})]),_:1}),e(L,{class:"my-3"}),e(q,null,{default:t(()=>{var r,g;return[e(M,{cols:"12",sm:"6"},{default:t(()=>[l[28]||(l[28]=a("strong",null,"کد تحویل:",-1)),e(v,{color:"primary",size:"small"},{default:t(()=>[i(u(s(m).delivery_code),1)]),_:1})]),_:1}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[29]||(l[29]=a("strong",null,"وعده:",-1)),e(v,{color:"primary",size:"small"},{default:t(()=>{var y;return[i(u((y=s(m).meal)==null?void 0:y.name),1)]}),_:1})])]),_:1}),e(L,{class:"my-3"}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[30]||(l[30]=a("strong",null,"نوع رزرو:",-1)),e(v,{color:"cyan",size:"small"},{default:t(()=>[i(u({personnel:"پرسنل",contractor:"پیمانکار",guest:"مهمان"}[s(m).reserve_type]||""),1)]),_:1})])]),_:1}),(g=(r=s(m).details)==null?void 0:r[0])!=null&&g.contractor?(c(),V(M,{key:0,cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[31]||(l[31]=a("strong",null,"پیمانکار:",-1)),e(v,{color:"cyan",size:"small"},{default:t(()=>[i(u(`${s(m).details[0].contractor.first_name} ${s(m).details[0].contractor.last_name}`),1)]),_:1})])]),_:1})):E("",!0),s(m).reserve_type==="guest"?(c(),V(M,{key:1,cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[32]||(l[32]=a("strong",null,"نوع سرو:",-1)),e(v,{color:"cyan",size:"small"},{default:t(()=>[i(u({serve_in_kitchen:"سرو در آشپزخانه",deliver:"تحویل"}[s(m).serve_place]||""),1)]),_:1})])]),_:1})):E("",!0)]}),_:1}),e(L,{class:"my-3"}),e(q,null,{default:t(()=>[e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[33]||(l[33]=a("strong",null,"وضعیت:",-1)),e(v,{color:s(m).status?"success":"error",size:"small"},{default:t(()=>[i(u(s(m).status?"تحویل شده":"تحویل نشده"),1)]),_:1},8,["color"])])]),_:1}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[l[34]||(l[34]=a("strong",null,"تعداد:",-1)),e(v,{size:"small"},{default:t(()=>{var r;return[i(u((r=s(m).details)==null?void 0:r.reduce((g,y)=>g+(y.quantity||0),0)),1)]}),_:1})])]),_:1})]),_:1}),e(L,{class:"my-3"}),e(q,null,{default:t(()=>[s(m).description?(c(),V(M,{key:0,cols:"12",sm:"12"},{default:t(()=>[a("p",ol,[l[35]||(l[35]=a("strong",null,"توضیحات:",-1)),i(" "+u(s(m).description),1)])]),_:1})):E("",!0)]),_:1}),e(L,{class:"my-3"})]),_:1})]),_:1})]),_:1},8,["width","model-value"])):E("",!0)],64)}}},ul={class:"ma-3 overflow-auto d-none d-md-block"},il={key:3,class:"text-center"},dl={class:"d-md-none pa-3"},cl={class:"d-flex justify-space-between w-100 align-center"},fl={class:"pa-2"},ml={class:"mt-2 text-center"},vl={class:"d-flex justify-space-between w-100 align-center"},pl={class:"pa-2"},yl={key:3,class:"text-center"},gl={key:0},_l={key:1},bl={key:0},Vl={key:1},kl={__name:"ReservationForPersonnel",setup(we){const f=ye({success:!1,successMessage:"",hasError:!1,errorMessage:"",isDeleteDialogVisible:!1,isDetailsDialogVisible:!1}),_=ye({fetchingReservedMeals:!0,fetchingMeals:!1,reserveMeal:!1,deleteReservedMeal:!1}),b=C([]),x=C(""),Q=C(null),de=C([]),ce=C([]),A=C([]),O=C([]),G=C([]),F=C(null),m=C(null),w=C(null),W=oe(()=>!b.value||b.value.length===0?"":Array.isArray(b.value)?b.value.join(" - "):b.value);function X(){return Array.isArray(b.value)?b.value.filter(Boolean):b.value?[b.value]:[]}function D(d){f.hasError=!0,f.errorMessage=d}async function ve(){var h,n;const d=X();if(!d.length){D("لطفاً حداقل یک تاریخ برای رزرو انتخاب کنید.");return}for(const l of d){const[p,z,r]=String(l).split("/").map(Number);if(p*1e4+z*100+r<Q.value){D("امکان رزرو غذا فقط برای زمان حال و آینده وجود دارد.");return}}_.reserveMeal=!0;const o={date:b.value,meal_id:F.value,reserve_type:"personnel",supervisor_id:(n=(h=he("userData"))==null?void 0:h.value)==null?void 0:n.id,personnel:G.value};try{const l=await P("/food/meal-reservation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),onResponseError({response:y}){var k,R;if(f.hasError=!0,(k=y._data)!=null&&k.errors){const j=Object.values(y._data.errors).flat().join(" | ");f.errorMessage=j}else f.errorMessage=((R=y._data)==null?void 0:R.message)||"خطا در ایجاد"}}),p=((l==null?void 0:l.data)||[]).flatMap(y=>(y==null?void 0:y.skippedPersonnel)||[]),z=((l==null?void 0:l.data)||[]).reduce((y,k)=>y+((k==null?void 0:k.createdPersonnel)||[]).length,0),r=new Map;for(const y of p){const k=y==null?void 0:y.full_name,R=y==null?void 0:y.date;if(!k||!R)continue;const j=String(R).replaceAll("\\/","/");r.has(k)||r.set(k,new Set),r.get(k).add(j)}const g=Array.from(r.entries()).map(([y,k])=>{const R=Array.from(k).sort((j,Me)=>j.localeCompare(Me));return`برای ${y}: در: ${R.join(" و ")}`});g.length?D(z===0?`هیچ رزروی ایجاد نشد. ${g.join(" | ")}  - رزرو وجود دارد`:`برای بعضی از پرسنل رزرو انجام نشد: ${g.join(" | ")} - رزرو وجود دارد`):(f.success=!0,f.successMessage=(l==null?void 0:l.message)||"رزرو با موفقیت انجام شد."),w.value==="byYou"?Z():ee(),G.value=null,F.value=null}catch(l){console.error("Error submitting reservation:",l)}finally{_.reserveMeal=!1}}function pe(d){m.value=d,f.isDeleteDialogVisible=!0}async function Ve(){if(m.value){_.deleteReservedMeal=!0;try{const d=await P(`/food/meal-reservation/${m.value.id}`,{method:"DELETE",onResponseError({response:o}){var h;D(((h=o._data)==null?void 0:h.message)||"خطا در حذف رزرو")}});if(f.hasError)return;f.isDeleteDialogVisible=!1,d!=null&&d.data?A.value=A.value.filter(o=>o.id!==m.value.id):(D("نمیتوان رزرو تحویل شده را حذف کرد"),Z())}catch(d){console.error(d)}finally{_.deleteReservedMeal=!1}}}function B(d){m.value=d,f.isDetailsDialogVisible=!0}async function Z(){A.value=[],_.fetchingReservedMeals=!0;try{const d=await P("/food/meal-reservation/get-for-personnel-by-user-on-date",{method:"GET",params:{"date[]":b.value}});A.value=(d.data||[]).flat()}catch(d){console.error("Error fetching reserved meals:",d),D("خطا در دریافت رزروها")}finally{_.fetchingReservedMeals=!1}}async function ee(){O.value=[],_.fetchingReservedMeals=!0;try{const d=await P("/food/meal-reservation/get-for-user-by-others-on-date",{method:"GET",params:{"date[]":b.value}});O.value=(d.data||[]).flat()}catch(d){console.error("Error fetching reserved meals:",d),D("خطا در دریافت رزروها")}finally{_.fetchingReservedMeals=!1}}async function ke(){var d,o;try{const{data:h}=await P("/base/org-chart-node/user-subordinates",{method:"GET",params:{user_id:(o=(d=he("userData"))==null?void 0:d.value)==null?void 0:o.id}});de.value=(h||[]).flat()}catch(h){console.error("Unexpected error fetching users:",h),D("خطای غیرمنتظره در دریافت کاربران")}}async function ae(){_.fetchingMeals=!0;try{const d=await P("/food/meal/get-actives",{method:"GET"});ce.value=(d==null?void 0:d.data.meals)||[]}catch(d){console.error("Error fetching meals:",d),D(d.message||"خطا در دریافت وعده‌ها")}finally{_.fetchingMeals=!1}}function I(){w.value==="byYou"?Z():ee()}function se(d){f.isDetailsDialogVisible=d,d||(m.value=null)}async function De(d){try{const o=await P(`/food/meal-reservation-detail/${d}`,{method:"DELETE",onResponseError({response:h}){var n;D(((n=h._data)==null?void 0:n.message)||"خطا در حذف")}});o!=null&&o.data?m.value.details=m.value.details.filter(h=>h.id!==d):(D("نمیتوان پرسنل رزرو تحویل شده را حذف کرد"),f.isDetailsDialogVisible=!1,Z())}catch(o){console.error(o)}}const re=oe(()=>[...A.value].sort((d,o)=>String(d.date).localeCompare(String(o.date)))),le=oe(()=>[...O.value].sort((d,o)=>{var h,n;return String(((h=d.reservation)==null?void 0:h.date)||"").localeCompare(String(((n=o.reservation)==null?void 0:n.date)||""))}));return Ce(async()=>{w.value="byYou",await Promise.all([ae(),ke()]);const d=new Date,o=new Date(d);o.setDate(o.getDate()+30);const[h,n]=[d,o].map(p=>Re.toJalaali(p.getFullYear(),p.getMonth()+1,p.getDate()));Q.value=h.jy*1e4+h.jm*100+h.jd;const l=p=>`${p.jy}/${String(p.jm).padStart(2,"0")}/${String(p.jd).padStart(2,"0")}`;b.value=[l(h)],x.value=l(n),await Z()}),(d,o)=>{const h=je("PersianDatetimePicker"),n=ze;return c(),$(N,null,[e($e,null,{default:t(()=>[e(ge,{modelValue:s(f).hasError,"onUpdate:modelValue":o[0]||(o[0]=l=>s(f).hasError=l),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:t(()=>[i(u(s(f).errorMessage),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:s(f).success,"onUpdate:modelValue":o[1]||(o[1]=l=>s(f).success=l),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:t(()=>[i(u(s(f).successMessage),1)]),_:1},8,["modelValue"]),e(q,{dense:""},{default:t(()=>[e(M,{cols:"12",md:"4",class:"d-flex justify-center mb-4 mb-md-0"},{default:t(()=>[o[9]||(o[9]=a("input",{id:"custom-input",style:{display:"none"}},null,-1)),e(h,{modelValue:s(b),"onUpdate:modelValue":o[2]||(o[2]=l=>T(b)?b.value=l:null),format:"jYYYY/jMM/jDD",inline:"",multiple:"",max:s(x),"custom-input":"#custom-input",onChange:I},null,8,["modelValue","max"])]),_:1}),e(M,{cols:"12",md:"8"},{default:t(()=>[e(te,{class:"mb-4"},{default:t(()=>[o[11]||(o[11]=a("label",{class:"font-weight-medium mb-2 mt-2 d-block text-center"}," جزئیات ",-1)),e(q,{class:"mb-4 px-4"},{default:t(()=>[e(M,{cols:"12",sm:"12",md:"12"},{default:t(()=>[e(fe,{"model-value":s(W),label:"تاریخ رزرو",variant:"outlined",readonly:"",rules:["requiredValidator"in d?d.requiredValidator:s(U)]},null,8,["model-value","rules"])]),_:1}),e(M,{cols:"12",md:"12"},{default:t(()=>[e(qe,{modelValue:s(F),"onUpdate:modelValue":o[3]||(o[3]=l=>T(F)?F.value=l:null),items:s(ce),"item-title":"name","item-value":"id",label:"وعده",variant:"outlined",clearable:"",rules:["requiredValidator"in d?d.requiredValidator:s(U)]},null,8,["modelValue","items","rules"])]),_:1}),e(M,{cols:"12",class:"mb-3"},{default:t(()=>[e(xe,{modelValue:s(G),"onUpdate:modelValue":o[4]||(o[4]=l=>T(G)?G.value=l:null),items:s(de),"item-title":l=>`${l.first_name} ${l.last_name} - ${l.personnel_code}`,"item-value":"id",label:"افراد",multiple:"",chips:"",clearable:"",variant:"outlined",rules:["requiredValidator"in d?d.requiredValidator:s(U)]},null,8,["modelValue","items","item-title","rules"])]),_:1})]),_:1}),e(q,{justify:"center",class:"mb-4"},{default:t(()=>[e(M,{cols:"auto"},{default:t(()=>[e(S,{color:"primary",loading:s(_).reserveMeal,disabled:s(_).reserveMeal,onClick:ve},{default:t(()=>[...o[10]||(o[10]=[i(" ثبت ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),a("div",ul,[e(te,{class:"pa-4"},{default:t(()=>[o[15]||(o[15]=a("label",{class:"font-weight-medium mb-4 d-block text-center"}," رزروهای تاریخ‌های انتخاب شده ",-1)),e(_e,{modelValue:s(w),"onUpdate:modelValue":o[5]||(o[5]=l=>T(w)?w.value=l:null),rules:["requiredValidator"in d?d.requiredValidator:s(U)],class:"mt-2",inline:"",onChange:I},{default:t(()=>[e(J,{label:"توسط شما",value:"byYou"}),e(J,{label:"برای شما",value:"forYou"})]),_:1},8,["modelValue","rules"]),!s(_).fetchingReservedMeals&&s(w)==="byYou"&&s(re).length>0?(c(),V(me,{key:0},{default:t(()=>[o[12]||(o[12]=a("thead",null,[a("tr",null,[a("th",null,"ردیف"),a("th",null,"وعده"),a("th",null,"کد تحویل"),a("th",null,"وضعیت"),a("th",null,"تاریخ"),a("th",null,"تعداد"),a("th",null,"عملیات")])],-1)),a("tbody",null,[(c(!0),$(N,null,K(s(re),(l,p)=>{var z,r;return c(),$("tr",{key:l.id},[a("td",null,u(p+1),1),a("td",null,u((z=l.meal)==null?void 0:z.name),1),a("td",null,[e(v,{color:"success"},{default:t(()=>[i(u(l.delivery_code),1)]),_:2},1024)]),a("td",null,[e(v,{color:l.status?"success":"error",size:"small"},{default:t(()=>[i(u(l.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])]),a("td",null,[e(v,null,{default:t(()=>[i(u(l.date),1)]),_:2},1024)]),a("td",null,u((r=l.details)==null?void 0:r.reduce((g,y)=>g+(y.quantity||0),0)),1),a("td",null,[l.status?E("",!0):(c(),V(S,{key:0,color:"red",variant:"plain",size:"small",onClick:g=>pe(l)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])),e(S,{color:"primary",variant:"plain",size:"small",onClick:g=>B(l)},{default:t(()=>[e(Y,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])}),128))])]),_:1})):!s(_).fetchingReservedMeals&&s(w)==="forYou"&&s(le).length>0?(c(),V(me,{key:1},{default:t(()=>[o[13]||(o[13]=a("thead",null,[a("tr",null,[a("th",null,"ردیف"),a("th",null,"وعده"),a("th",null,"تاریخ"),a("th",null,"رزرو شده توسط"),a("th",null,"کد پرسنلی"),a("th",null,"وضعیت")])],-1)),a("tbody",null,[(c(!0),$(N,null,K(s(le),(l,p)=>(c(),$("tr",{key:p},[a("td",null,u(p+1),1),a("td",null,u(l.reservation.mealName),1),a("td",null,[e(v,null,{default:t(()=>[i(u(l.reservation.date),1)]),_:2},1024)]),a("td",null,[e(v,{color:"primary"},{default:t(()=>[i(u(l.createdBy),1)]),_:2},1024)]),a("td",null,[e(v,null,{default:t(()=>[i(u(l.personnelCode),1)]),_:2},1024)]),a("td",null,[e(v,{color:l.deliveryStatus?"success":"error",size:"small"},{default:t(()=>[i(u(l.deliveryStatus?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])])]))),128))])]),_:1})):s(_).fetchingReservedMeals?(c(),V(be,{key:2,type:"card"})):(c(),$("div",il,[e(v,{color:"error"},{default:t(()=>[...o[14]||(o[14]=[i(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))]),_:1})]),a("div",dl,[e(ne,{variant:"accordion"},{default:t(()=>[e(ue,null,{default:t(()=>[e(ie,{class:"font-weight-bold"},{default:t(()=>[...o[16]||(o[16]=[i(" رزروهای تاریخ‌های انتخاب شده ",-1)])]),_:1}),e(_e,{modelValue:s(w),"onUpdate:modelValue":o[6]||(o[6]=l=>T(w)?w.value=l:null),rules:["requiredValidator"in d?d.requiredValidator:s(U)],class:"mt-2",inline:"",onChange:I},{default:t(()=>[e(J,{label:"توسط شما",value:"byYou"}),e(J,{label:"برای شما",value:"forYou"})]),_:1},8,["modelValue","rules"]),!s(_).fetchingReservedMeals&&s(w)==="byYou"&&s(re).length>0?(c(),V(H,{key:0},{default:t(()=>[e(ne,{variant:"accordion"},{default:t(()=>[(c(!0),$(N,null,K(s(re),l=>(c(),V(ue,{key:l.id,class:"mb-2"},{default:t(()=>[e(ie,null,{default:t(()=>{var p;return[a("div",cl,[a("span",null,u((p=l.meal)==null?void 0:p.name),1),e(v,{color:l.status?"success":"error",size:"small",label:""},{default:t(()=>[i(u(l.status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])])]}),_:2},1024),e(H,null,{default:t(()=>{var p;return[a("div",fl,[a("div",null,[o[17]||(o[17]=a("strong",null,"کد تحویل:",-1)),e(v,{color:"success"},{default:t(()=>[i(u(l.delivery_code),1)]),_:2},1024)]),a("div",null,[o[18]||(o[18]=a("strong",null,"تاریخ:",-1)),e(v,null,{default:t(()=>[i(u(l.date),1)]),_:2},1024)]),a("div",null,[o[19]||(o[19]=a("strong",null,"تعداد:",-1)),i(" "+u((p=l.details)==null?void 0:p.reduce((z,r)=>z+(r.quantity||0),0)),1)]),a("div",ml,[l.status?E("",!0):(c(),V(S,{key:0,color:"red",variant:"plain",size:"small",onClick:z=>pe(l)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])),e(S,{color:"primary",variant:"plain",size:"small",onClick:z=>B(l)},{default:t(()=>[e(Y,{icon:"tabler-file-description",size:"20"})]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):!s(_).fetchingReservedMeals&&s(w)==="forYou"&&s(le).length>0?(c(),V(H,{key:1},{default:t(()=>[e(ne,{variant:"accordion"},{default:t(()=>[(c(!0),$(N,null,K(s(le),(l,p)=>(c(),V(ue,{key:p,class:"mb-2"},{default:t(()=>[e(ie,null,{default:t(()=>[a("div",vl,[a("span",null,u(l.reservation.mealName),1),e(v,{color:l.deliveryStatus?"success":"error",size:"small"},{default:t(()=>[i(u(l.deliveryStatus?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])])]),_:2},1024),e(H,null,{default:t(()=>[a("div",pl,[a("div",null,[o[20]||(o[20]=a("strong",null,"تاریخ:",-1)),e(v,null,{default:t(()=>[i(u(l.reservation.date),1)]),_:2},1024)]),a("div",null,[o[21]||(o[21]=a("strong",null,"رزرو شده توسط:",-1)),e(v,{color:"primary"},{default:t(()=>[i(u(l.createdBy),1)]),_:2},1024)]),a("div",null,[o[22]||(o[22]=a("strong",null,"کد پرسنلی:",-1)),e(v,{color:"primary"},{default:t(()=>[i(u(l.personnelCode),1)]),_:2},1024)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):s(_).fetchingReservedMeals?(c(),V(be,{key:2,type:"card"})):(c(),$("div",yl,[e(v,{color:"error"},{default:t(()=>[...o[23]||(o[23]=[i(" رزروی برای نمایش وجود ندارد ",-1)])]),_:1})]))]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),s(f).isDeleteDialogVisible?(c(),V(Ee,{key:0,"is-dialog-visible":s(f).isDeleteDialogVisible,"onUpdate:isDialogVisible":o[7]||(o[7]=l=>s(f).isDeleteDialogVisible=l),title:"آیا از حذف این رزرو اطمینان دارید؟",loading:s(_).deleteReservedMeal,onConfirm:Ve},null,8,["is-dialog-visible","loading"])):E("",!0),s(m)?(c(),V(Te,{key:1,width:d.$vuetify.display.smAndDown?"auto":900,"model-value":s(f).isDetailsDialogVisible,"onUpdate:modelValue":se},{default:t(()=>[e(n,{onClick:o[8]||(o[8]=l=>se(!1))}),e(te,null,{default:t(()=>[e(Se,{class:"text-h6"},{default:t(()=>[...o[24]||(o[24]=[i(" جزئیات ",-1)])]),_:1}),e(Ue,null,{default:t(()=>[e(q,null,{default:t(()=>[e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[o[25]||(o[25]=a("strong",null,"رزرو کننده:",-1)),e(v,{color:"orange",size:"small"},{default:t(()=>[i(u(s(m).created_by?`${s(m).created_by.first_name} ${s(m).created_by.last_name}`:"—"),1)]),_:1})])]),_:1}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[o[26]||(o[26]=a("strong",null,"کد پرسنلی:",-1)),e(v,{color:"orange",size:"small"},{default:t(()=>[i(u(s(m).created_by?`${s(m).created_by.personnel_code}`:"—"),1)]),_:1})])]),_:1})]),_:1}),e(L,{class:"my-3"}),e(q,null,{default:t(()=>[e(M,{cols:"12",sm:"6"},{default:t(()=>[o[27]||(o[27]=a("strong",null,"کد تحویل:",-1)),e(v,{color:"primary",size:"small"},{default:t(()=>[i(u(s(m).delivery_code),1)]),_:1})]),_:1}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[o[28]||(o[28]=a("strong",null,"وعده:",-1)),e(v,{color:"primary",size:"small"},{default:t(()=>{var l;return[i(u((l=s(m).meal)==null?void 0:l.name),1)]}),_:1})])]),_:1})]),_:1}),e(L,{class:"my-3"}),e(q,null,{default:t(()=>[e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[o[29]||(o[29]=a("strong",null,"وضعیت:",-1)),e(v,{color:s(m).status?"success":"error",size:"small"},{default:t(()=>[i(u(s(m).status?"تحویل شده":"تحویل نشده"),1)]),_:1},8,["color"])])]),_:1}),e(M,{cols:"12",sm:"6"},{default:t(()=>[a("p",null,[o[30]||(o[30]=a("strong",null,"تعداد:",-1)),e(v,{size:"small"},{default:t(()=>{var l;return[i(u((l=s(m).details)==null?void 0:l.reduce((p,z)=>p+(z.quantity||0),0)),1)]}),_:1})])]),_:1})]),_:1}),e(L,{class:"my-3"}),a("div",null,[e(me,{density:"comfortable"},{default:t(()=>{var l;return[a("thead",null,[a("tr",null,[o[31]||(o[31]=a("th",null,"ردیف",-1)),o[32]||(o[32]=a("th",null,"نام",-1)),o[33]||(o[33]=a("th",null,"کد پرسنلی",-1)),!s(m).status&&(((l=s(m).details)==null?void 0:l.reduce((p,z)=>p+(z.quantity||0),0))||0)>1?(c(),$("th",gl," عملیات ")):E("",!0),s(m).status?(c(),$("th",_l," وضعیت ")):E("",!0)])]),a("tbody",null,[(c(!0),$(N,null,K((s(m).details||[]).filter(p=>p.personnel),(p,z)=>{var r;return c(),$("tr",{key:p.id},[a("td",null,u(z+1),1),a("td",null,[e(v,null,{default:t(()=>[i(u(`${p.personnel.first_name} ${p.personnel.last_name}`),1)]),_:2},1024)]),a("td",null,[e(v,null,{default:t(()=>[i(u(p.personnel.personnel_code),1)]),_:2},1024)]),!s(m).status&&(((r=s(m).details)==null?void 0:r.reduce((g,y)=>g+(y.quantity||0),0))||0)>1?(c(),$("td",bl,[e(S,{color:"red",variant:"text",size:"small",onClick:g=>De(p.id)},{default:t(()=>[e(Y,{icon:"tabler-trash",size:"20"})]),_:1},8,["onClick"])])):E("",!0),s(m).status?(c(),$("td",Vl,[e(v,{color:p.delivery_status?"success":"error",size:"small"},{default:t(()=>[i(u(p.delivery_status?"تحویل شده":"تحویل نشده"),1)]),_:2},1032,["color"])])):E("",!0)])}),128))])]}),_:1})]),e(L,{class:"my-3"})]),_:1})]),_:1})]),_:1},8,["width","model-value"])):E("",!0)],64)}}},st={__name:"food-reservation",setup(we){const f=C(!0),_=C(!1);return Ce(()=>{f.value=!0,_.value=!1}),(b,x)=>(c(),V($e,null,{default:t(()=>[e(q,{dense:""},{default:t(()=>[e(M,{cols:"12"},{default:t(()=>[e(te,{class:"mb-4 pa-8 text-center"},{default:t(()=>[e(q,{align:"center",justify:"center",class:"gap-4"},{default:t(()=>[e(S,{density:"default",onClick:x[0]||(x[0]=Q=>{f.value=!0,_.value=!1})},{default:t(()=>[...x[2]||(x[2]=[i(" رزرو غذا ",-1)])]),_:1}),e(S,{density:"default",onClick:x[1]||(x[1]=Q=>{f.value=!1,_.value=!0})},{default:t(()=>[...x[3]||(x[3]=[i(" رزرو غذای مهمان/ پیمانکار ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),f.value&&!_.value?(c(),V(kl,{key:0})):E("",!0),!f.value&&_.value?(c(),V(nl,{key:1})):E("",!0)]),_:1})]),_:1}))}};export{st as default};
