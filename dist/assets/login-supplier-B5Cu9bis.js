import{r as T,m as q}from"./validators-9V7Nl4tn.js";import{bs as k,i as A,j as M,r as l,a as U,c as j,o as z,b as t,e as r,t as m,bk as N,m as o,v as g,d as s,H as v,bp as B,ah as D,F as I,b2 as L}from"./index-qdoAqBxI.js";import{_ as $}from"./AppTextField-BGFghQa6.js";import{u as O,m as G,a as H}from"./misc-mask-light-BKKFFoda.js";import{V as P}from"./VNodeRenderer-0yX0h6St.js";import{u as W}from"./useAbility-DYJfqdSQ.js";import{$ as J}from"./api-mTz3sxMY.js";import{V as y}from"./VSnackbar-BUvkqBVs.js";import{V as c}from"./VCol-DqDivgSj.js";import{V as K}from"./VCard-32saOd8Z.js";import{V as w}from"./VCardText-Cs_iaGmC.js";import{V as Q}from"./VForm-BBT2fvK0.js";import{V as x}from"./VRow-ZqcoDdCR.js";import"./form-BnOJfckE.js";import"./VTextField-Cqv0vJFQ.js";import"./VImg-iOVQGnu4.js";import"./VField-DCiDQhcY.js";import"./VOverlay-Dp4-Dwhb.js";import"./VInput-YlY2BKcU.js";import"./index-9rIf2CJL.js";/* empty css              */import"./createSimpleFunctional-DG91Y9b-.js";import"./VAvatar-C8Uto1jP.js";const X={class:"auth-logo d-flex align-center gap-x-3"},Y={class:"auth-title"},Z={class:"position-relative bg-background w-100 me-0"},ee=["src"],te={class:"text-h4 mb-1"},oe={class:"text-capitalize"},Re=Object.assign({beforeRouteEnter(R,_,n){if(k("otpExpiresAt").value>Math.floor(Date.now()/1e3))return n({name:"two-step-supplier"});n()}},{__name:"login-supplier",setup(R){const _=O(H,G),n=A(),F=M();W();const d=l({mobileNumber:void 0,other:void 0}),h=l(),p=l({mobileNumber:""}),f=l(!1),b=l(!1),V=l(n.query.isRedirectedFromUnauthorizedStatus==="true"),S=async()=>{b.value=!0;try{const a=await J("/login-supplier",{method:"POST",body:{mobileNumber:p.value.mobileNumber},onResponseError({response:i}){b.value=!1,i._data.errors?d.value=i._data.errors:(d.value.other=i._data.message,f.value=!0)}}),{otpExpiresAt:e}=a;k("otpExpiresAt").value=e,await L(()=>{F.replace({path:"/two-step-supplier",query:{mobileNumber:p.value.mobileNumber}})})}catch{}},C=()=>{var a;(a=h.value)==null||a.validate().then(({valid:e})=>{e&&S()})};return(a,e)=>{const i=U("RouterLink"),E=$;return z(),j(I,null,[t(y,{modelValue:o(V),"onUpdate:modelValue":e[0]||(e[0]=u=>N(V)?V.value=u:null),timeout:5e3,location:"center",variant:"outlined",color:"error"},{default:r(()=>e[3]||(e[3]=[m(" زمان اعتبار توکن شما 8 ساعت می‌باشد و هم‌اکنون منقضی شده‌است. لطفاً دوباره وارد شوید. ")])),_:1},8,["modelValue"]),t(y,{modelValue:o(f),"onUpdate:modelValue":e[1]||(e[1]=u=>N(f)?f.value=u:null),timeout:2e3,location:"center",variant:"outlined",color:"error"},{default:r(()=>[m(g(o(d).other),1)]),_:1},8,["modelValue"]),t(i,{to:"/"},{default:r(()=>[s("div",X,[t(o(P),{nodes:o(v).app.logo},null,8,["nodes"]),s("h1",Y,g(o(v).app.title),1)])]),_:1}),t(x,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[t(c,{md:"8",class:"d-none d-md-flex"},{default:r(()=>[s("div",Z,[e[4]||(e[4]=s("div",{class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},null,-1)),s("img",{class:"auth-footer-mask",src:o(_),alt:"auth-footer-mask",height:"280",width:"100"},null,8,ee)])]),_:1}),t(c,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:r(()=>[t(K,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:r(()=>[t(w,null,{default:r(()=>[s("h4",te,[e[5]||(e[5]=m(" خوش آمدید ")),s("span",oe,g(o(v).app.title),1),e[6]||(e[6]=m("! 👋🏻 "))]),e[7]||(e[7]=s("p",{class:"mb-0"}," جهت ورود به سامانه، شماره تلفن همراه خود را وارد کنید ",-1))]),_:1}),t(w,null,{default:r(()=>[t(o(Q),{ref_key:"refVForm",ref:h,"validate-on":"submit lazy",onSubmit:B(C,["prevent"])},{default:r(()=>[t(x,null,{default:r(()=>[t(c,{cols:"12"},{default:r(()=>[t(E,{modelValue:o(p).mobileNumber,"onUpdate:modelValue":e[2]||(e[2]=u=>o(p).mobileNumber=u),label:"شماره تلفن همراه",placeholder:"مثلاً: 09123456789",type:"number",autofocus:"",rules:["requiredValidator"in a?a.requiredValidator:o(T),"mobileNumberValidator"in a?a.mobileNumberValidator:o(q)],"error-messages":o(d).mobileNumber},null,8,["modelValue","rules","error-messages"])]),_:1}),t(c,{cols:"12"},{default:r(()=>[t(D,{block:"",type:"submit",loading:o(b),disabled:o(b)},{default:r(()=>e[8]||(e[8]=[m(" ارسال کد تأیید ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{Re as default};
