import{r as T,m as q}from"./validators-B6WRw6sG.js";import{bs as k,i as M,j as U,r as l,a as j,c as z,o as A,b as t,e as r,t as m,bk as N,m as o,v as g,d as s,H as v,bp as B,ah as D,F as I,b2 as L}from"./index-CICszNDy.js";import{_ as $}from"./AppTextField-BtCWgZbn.js";import{u as O,m as G,a as H}from"./misc-mask-light-C6ZNbebH.js";import{V as P}from"./VNodeRenderer-BMuskdEM.js";import{$ as W}from"./api-B2429s3R.js";import{V as w}from"./VSnackbar-DfwYf6bB.js";import{V as c}from"./VCol-COW2noId.js";import{V as J}from"./VCard-X2fl1T8w.js";import{V as x}from"./VCardText-iTExjpbg.js";import{V as K}from"./VForm-BBV8S5de.js";import{V as y}from"./VRow-43dtblY_.js";import"./helpers-CUpzJZ2r.js";import"./form-DP4kTFIs.js";import"./VTextField-Di-aN2e7.js";import"./VImg-TV0XvCl7.js";import"./VField-Cg_ApCzd.js";import"./VOverlay-VIOFEwcR.js";import"./VInput-BQJkaL18.js";import"./index-9rIf2CJL.js";/* empty css              */import"./createSimpleFunctional-nQRmjaiY.js";import"./VAvatar-BOZvtgvW.js";const Q={class:"auth-logo d-flex align-center gap-x-3"},X={class:"auth-title"},Y={class:"position-relative bg-background w-100 me-0"},Z=["src"],ee={class:"text-h4 mb-1"},te={class:"text-capitalize"},ye=Object.assign({beforeRouteEnter(R,_,n){if(k("otpExpiresAt").value>Math.floor(Date.now()/1e3))return n({name:"two-step-supplier"});n()}},{__name:"login-supplier",setup(R){const _=O(H,G),n=M(),F=U(),d=l({mobileNumber:void 0,other:void 0}),h=l(),p=l({mobileNumber:""}),f=l(!1),b=l(!1),V=l(n.query.isRedirectedFromUnauthorizedStatus==="true"),S=async()=>{b.value=!0;try{const a=await W("/login-supplier",{method:"POST",body:{mobileNumber:p.value.mobileNumber},onResponseError({response:i}){b.value=!1,i._data.errors?d.value=i._data.errors:(d.value.other=i._data.message,f.value=!0)}}),{otpExpiresAt:e}=a;k("otpExpiresAt").value=e,await L(()=>{F.replace({path:"/two-step-supplier",query:{mobileNumber:p.value.mobileNumber}})})}catch{}},C=()=>{var a;(a=h.value)==null||a.validate().then(({valid:e})=>{e&&S()})};return(a,e)=>{const i=j("RouterLink"),E=$;return A(),z(I,null,[t(w,{modelValue:o(V),"onUpdate:modelValue":e[0]||(e[0]=u=>N(V)?V.value=u:null),timeout:5e3,location:"center",variant:"outlined",color:"error"},{default:r(()=>e[3]||(e[3]=[m(" زمان اعتبار توکن شما 8 ساعت می‌باشد و هم‌اکنون منقضی شده‌است. لطفاً دوباره وارد شوید. ")])),_:1},8,["modelValue"]),t(w,{modelValue:o(f),"onUpdate:modelValue":e[1]||(e[1]=u=>N(f)?f.value=u:null),timeout:2e3,location:"center",variant:"outlined",color:"error"},{default:r(()=>[m(g(o(d).other),1)]),_:1},8,["modelValue"]),t(i,{to:"/"},{default:r(()=>[s("div",Q,[t(o(P),{nodes:o(v).app.logo},null,8,["nodes"]),s("h1",X,g(o(v).app.title),1)])]),_:1}),t(y,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[t(c,{md:"8",class:"d-none d-md-flex"},{default:r(()=>[s("div",Y,[e[4]||(e[4]=s("div",{class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},null,-1)),s("img",{class:"auth-footer-mask",src:o(_),alt:"auth-footer-mask",height:"280",width:"100"},null,8,Z)])]),_:1}),t(c,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:r(()=>[t(J,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:r(()=>[t(x,null,{default:r(()=>[s("h4",ee,[e[5]||(e[5]=m(" خوش آمدید ")),s("span",te,g(o(v).app.title),1),e[6]||(e[6]=m("! 👋🏻 "))]),e[7]||(e[7]=s("p",{class:"mb-0"}," جهت ورود به سامانه، شماره تلفن همراه خود را وارد کنید ",-1))]),_:1}),t(x,null,{default:r(()=>[t(o(K),{ref_key:"refVForm",ref:h,"validate-on":"submit lazy",onSubmit:B(C,["prevent"])},{default:r(()=>[t(y,null,{default:r(()=>[t(c,{cols:"12"},{default:r(()=>[t(E,{modelValue:o(p).mobileNumber,"onUpdate:modelValue":e[2]||(e[2]=u=>o(p).mobileNumber=u),label:"شماره تلفن همراه",placeholder:"مثلاً: 09123456789",type:"number",autofocus:"",rules:["requiredValidator"in a?a.requiredValidator:o(T),"mobileNumberValidator"in a?a.mobileNumberValidator:o(q)],"error-messages":o(d).mobileNumber},null,8,["modelValue","rules","error-messages"])]),_:1}),t(c,{cols:"12"},{default:r(()=>[t(D,{block:"",type:"submit",loading:o(b),disabled:o(b)},{default:r(()=>e[8]||(e[8]=[m(" ارسال کد تأیید ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{ye as default};
