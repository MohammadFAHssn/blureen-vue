import{bs as s,cI as o,cJ as u,cK as c}from"./index-D3vG3ch0.js";const n=async()=>{s("accessToken").value=null;const e=s("userData");e.value.role.includes("supplier")?await o.replace({path:"/login-supplier",query:{isRedirectedFromUnauthorizedStatus:!0}}):await o.replace({path:"/login",query:{isRedirectedFromUnauthorizedStatus:!0}}),e.value=null,s("userAbilityRules").value=null},p=u({baseUrl:"/api",fetchOptions:{headers:{Accept:"application/json"}},options:{refetch:!0,async beforeFetch({url:e,options:r}){r.skipBaseUrl&&(console.log(e),e=e.replace("/api",""),console.log(e));const a=s("accessToken").value;return a&&(r.headers={...r.headers,Authorization:`Bearer ${a}`}),{url:e,options:r}},afterFetch(e){const{data:r,response:a}=e;let t=null;try{t=c(r)}catch(l){console.error(l)}return{data:t,response:a}},onFetchError(e){e.response.status===401&&n();let r=null;try{r=c(e.data)}catch(a){console.error(a)}return{error:r}}}});export{p as u};
