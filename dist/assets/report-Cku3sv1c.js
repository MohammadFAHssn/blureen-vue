import{r as K}from"./validators-BQd4MaJQ.js";import{r as p,bJ as T,H as ae,a as le,c as z,o as h,b as l,d as f,f as A,m as I,e as o,v as E,x as w,n as a,am as R,a1 as te,F as Q,i as ne,a2 as J,bC as W,bv as j,M as ue,Y as de,bL as me,aH as be,bB as ve,h as ye}from"./index-DJtTo778.js";import{_ as ie}from"./DialogCloseBtn-DaUlyKvN.js";import{_ as Ve}from"./AreYouSureDialog-DzYTR-h_.js";import{$ as S}from"./api-BZc7V1UW.js";import{V as oe}from"./VSnackbar-BnpSLZg7.js";import{V as Ee}from"./VTable-Crt-Bnpe.js";import{V as he}from"./VSkeletonLoader-CojUZ7bD.js";import{V as L}from"./VCard-BDjwiKTp.js";import{V as X}from"./VCardText-BQjyoIts.js";import{V as Z}from"./VForm-DaY_rg8K.js";import{V as Y}from"./VRow-BiKHgzSd.js";import{V as M}from"./VCol-CvgeTsfI.js";import{V as re}from"./VSelect-BHnVPCNj.js";import{V as ee}from"./VDialog-Dro5pB3Q.js";import{V as De}from"./VAutocomplete-BIycTWT7.js";import{u as fe}from"./useAGGridTheme-CaopSueR.js";import{u as ke}from"./useApi-BDw6nypk.js";import{c as _e}from"./createUrl-DL11nlfk.js";import{V as ce}from"./VFab-jByB_cfq.js";import{V as pe}from"./VLayout-97O2NBDD.js";import"./helpers-CcX6MmOA.js";import"./index-CvOPxmL5.js";import"./useLogout-DoVtXHiN.js";import"./VOverlay-C0Z5_WIc.js";import"./createSimpleFunctional-DweeT_KK.js";/* empty css              */import"./VTextField-B_Yq1I65.js";import"./autofocus-b_cDgUUO.js";import"./VCounter-z1H4w9-I.js";import"./VField-BdS4f-OL.js";import"./VList-BCAhOZXo.js";import"./VDivider-kKo2qnor.js";import"./dialog-transition-xDWcoD4D.js";import"./VMenu-DQWoGKWD.js";import"./VCheckboxBtn-EUe7Jt6m.js";import"./filter-me7Uq9gX.js";const xe={class:"d-flex justify-end gap-3 mb-3"},we={key:2,class:"text-center"},Ce={class:"text-h5 text-center mb-2"},Re={__name:"EligibilityRules",emits:["back"],setup(D,{emit:_}){const $=_,V=p("root"),r=T({hasError:!1,errorMessage:"",isCreateDialogVisible:!1,isEditDialogVisible:!1,isDeleteDialogVisible:!1}),i=T({fetchingEligibilityRules:!0,createEligibilityRule:!1,editEligibilityRule:!1,deleteEligibilityRule:!1}),u=p([]),x=p([]),b=p(null),k=p(),g=p(null),s=p(null);function d(t){r.hasError=!0,r.errorMessage=t}function C(){V.value!=="root"?V.value="root":$("back")}async function F(){i.fetchingEligibilityRules=!0;try{const t=await S("/food/eligibility",{method:"GET"});u.value=(t==null?void 0:t.data.mealReservationEligibilityRules)||[]}catch(t){console.error("Error fetching eligibilitys:",t),d(t.message||"خطا در دریافت محدودیت‌ها")}finally{i.fetchingEligibilityRules=!1}}async function G(){var m;if(!s.value){d("لطفا زمان را انتخاب کنید");return}const t=await((m=k.value)==null?void 0:m.validate());if(!(t==null?void 0:t.valid))return;i.createEligibilityRule=!0;const c=new FormData;c.append("meal_id",g.value),c.append("time",s.value);try{await S("/food/eligibility/",{method:"POST",body:c,onResponseError({response:n}){var N,U;if(r.hasError=!0,(N=n._data)!=null&&N.errors){const H=Object.values(n._data.errors).flat().join(" | ");r.errorMessage=H}else r.errorMessage=((U=n._data)==null?void 0:U.message)||"خطا در ایجاد"}}),r.hasError||(r.isCreateDialogVisible=!1,B(),F())}catch(n){console.error(n)}finally{i.createEligibilityRule=!1}}async function q(){if(b.value){i.deleteEligibilityRule=!0;try{const t=await S(`/food/eligibility/${b.value.id}`,{method:"DELETE",onResponseError({response:e}){var c;d(((c=e._data)==null?void 0:c.message)||"خطا در حذف")}});if(r.hasError)return;r.isDeleteDialogVisible=!1,t!=null&&t.data?u.value=u.value.filter(e=>e.id!==b.value.id):d("خطا در حذف")}catch(t){console.error(t)}finally{i.deleteEligibilityRule=!1}}}function y(t){b.value=t,s.value=t.time,r.isEditDialogVisible=!0}async function v(){var m;const t=await((m=k.value)==null?void 0:m.validate());if(!(t==null?void 0:t.valid))return;i.editEligibilityRule=!0;const c=new FormData;c.append("time",s.value);try{const N=(await S(`/food/eligibility/${b.value.id}`,{method:"POST",body:c,onResponseError({response:U}){var H,se;if(r.hasError=!0,(H=U._data)!=null&&H.errors){const ge=Object.values(U._data.errors).flat().join(" | ");r.errorMessage=ge}else r.errorMessage=((se=U._data)==null?void 0:se.message)||"خطا در ویرایش"}})).data;!r.hasError&&N&&(u.value=u.value.map(U=>U.id===N.id?N:U),r.isEditDialogVisible=!1,B())}catch(n){console.error(n)}finally{i.editEligibilityRule=!1}}async function O(){i.fetchingMeals=!0;try{const t=await S("/food/meal",{method:"GET"});x.value=(t==null?void 0:t.data.meals)||[]}catch(t){console.error("Error fetching meals:",t),d(t.message||"خطا در دریافت وعده‌ها")}finally{i.fetchingMeals=!1}}function B(){g.value=null,s.value=null}function P(t){t||(r.isCreateDialogVisible=!1,r.isEditDialogVisible=!1,B())}return ae(async()=>{await Promise.all([O(),F()])}),(t,e)=>{const c=ie,m=le("PersianDatetimePicker");return h(),z(Q,null,[l(oe,{modelValue:a(r).hasError,"onUpdate:modelValue":e[0]||(e[0]=n=>a(r).hasError=n),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:o(()=>[E(w(a(r).errorMessage),1)]),_:1},8,["modelValue"]),f("div",null,[l(R,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:C},{default:o(()=>[E(w(a(V)==="root"?"گزارش":"صفحه قبل"),1)]),_:1})]),f("div",null,[f("div",xe,[l(R,{color:"primary",onClick:e[1]||(e[1]=n=>{a(r).isCreateDialogVisible=!0})},{default:o(()=>[l(te,{icon:"tabler-plus",size:"24",style:{cursor:"pointer"}})]),_:1})]),f("div",null,[!a(i).fetchingEligibilityRules&&a(u).length>0?(h(),A(Ee,{key:0},{default:o(()=>[e[10]||(e[10]=f("thead",null,[f("tr",null,[f("th",null,"ردیف"),f("th",null,"وعده"),f("th",null,"زمان"),f("th",null,"ایجاد شده توسط"),f("th",null,"آخرین ویرایش توسط"),f("th",null,"عملیات")])],-1)),f("tbody",null,[(h(!0),z(Q,null,ne(a(u),(n,N)=>(h(),z("tr",{key:n.id},[f("td",null,w(N+1),1),f("td",null,w(n.meal.name),1),f("td",null,[l(J,{color:"primary"},{default:o(()=>[E(w(n.time),1)]),_:2},1024)]),f("td",null,[l(J,null,{default:o(()=>[E(w(n.createdBy?`${n.createdBy.fullName} - ${n.createdBy.username}`:"—"),1)]),_:2},1024)]),f("td",null,[l(J,null,{default:o(()=>[E(w(n.editedBy?`${n.editedBy.fullName} - ${n.editedBy.username}`:"—"),1)]),_:2},1024)]),f("td",null,[l(te,{icon:"tabler-edit",color:"primary",size:"24",onClick:U=>y(n)},null,8,["onClick"])])]))),128))])]),_:1})):a(i).fetchingEligibilityRules?(h(),A(he,{key:1,type:"card"})):(h(),z("div",we,[l(J,{color:"error"},{default:o(()=>[...e[11]||(e[11]=[E(" محدودیتی برای نمایش وجود ندارد ",-1)])]),_:1})]))])]),l(ee,{width:t.$vuetify.display.smAndDown?"auto":900,"model-value":a(r).isCreateDialogVisible,"onUpdate:modelValue":P},{default:o(()=>[l(c,{onClick:e[2]||(e[2]=n=>P(!1))}),l(L,null,{default:o(()=>[l(X,null,{default:o(()=>[e[14]||(e[14]=f("h4",{class:"text-h5 text-center mb-2"}," افزودن محدودیت ",-1)),l(Z,{ref_key:"refVForm",ref:k,class:"mt-6","validate-on":"submit lazy",onSubmit:W(G,["prevent"])},{default:o(()=>[l(Y,null,{default:o(()=>[l(M,{cols:"12",md:"6"},{default:o(()=>[l(re,{modelValue:a(g),"onUpdate:modelValue":e[3]||(e[3]=n=>j(g)?g.value=n:null),items:a(x),"item-title":"name","item-value":"id",label:"وعده",variant:"outlined",clearable:"",rules:["requiredValidator"in t?t.requiredValidator:a(K)]},null,8,["modelValue","items","rules"])]),_:1}),l(M,{cols:"12",md:"6"},{default:o(()=>[l(m,{modelValue:a(s),"onUpdate:modelValue":e[4]||(e[4]=n=>j(s)?s.value=n:null),type:"time"},null,8,["modelValue"])]),_:1}),l(M,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[l(R,{type:"submit",disabled:a(i).createEligibilityRule,loading:a(i).createEligibilityRule},{default:o(()=>[...e[12]||(e[12]=[E(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),l(R,{color:"secondary",variant:"tonal",onClick:e[5]||(e[5]=n=>P(!1))},{default:o(()=>[...e[13]||(e[13]=[E(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"]),l(ee,{width:t.$vuetify.display.smAndDown?"auto":450,"model-value":a(r).isEditDialogVisible,"onUpdate:modelValue":P},{default:o(()=>[l(c,{onClick:e[6]||(e[6]=n=>P(!1))}),l(L,null,{default:o(()=>[l(X,null,{default:o(()=>{var n;return[f("h4",Ce," ویرایش محدودیت: "+w((n=a(b))==null?void 0:n.meal.name),1),l(Z,{ref_key:"refVForm",ref:k,class:"mt-6","validate-on":"submit lazy",onSubmit:W(v,["prevent"])},{default:o(()=>[l(Y,null,{default:o(()=>[l(M,{cols:"12",md:"12"},{default:o(()=>[l(m,{modelValue:a(s),"onUpdate:modelValue":e[7]||(e[7]=N=>j(s)?s.value=N:null),type:"time"},null,8,["modelValue"])]),_:1}),l(M,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[l(R,{type:"submit",disabled:a(i).editEligibilityRule,loading:a(i).editEligibilityRule},{default:o(()=>[...e[15]||(e[15]=[E(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),l(R,{color:"secondary",variant:"tonal",onClick:e[8]||(e[8]=N=>P(!1))},{default:o(()=>[...e[16]||(e[16]=[E(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1})]),_:1},8,["width","model-value"]),a(r).isDeleteDialogVisible?(h(),A(Ve,{key:0,"is-dialog-visible":a(r).isDeleteDialogVisible,"onUpdate:isDialogVisible":e[9]||(e[9]=n=>a(r).isDeleteDialogVisible=n),title:"آیا از حذف این محدودیت اطمینان دارید؟",loading:a(i).deleteEligibilityRule,onConfirm:q},null,8,["is-dialog-visible","loading"])):I("",!0)],64)}}},Me={__name:"ExceptionCreateDialog",props:{isDialogVisible:{type:Boolean,required:!0},loading:{type:Boolean,required:!0},meals:{type:Array,required:!0},users:{type:Array,required:!0}},emits:["submit","update:isDialogVisible"],setup(D,{emit:_}){const $=D,V=_,r=p([]),i=p(null),u=p();function x(){var g;(g=u.value)==null||g.validate().then(({valid:s})=>{s&&V("submit",{selectedPersonnels:r.value,selectedMeal:i.value})})}function b(){V("update:isDialogVisible",!1)}function k(g){V("update:isDialogVisible",g)}return(g,s)=>{const d=ie;return h(),A(ee,{width:g.$vuetify.display.smAndDown?"auto":900,"model-value":$.isDialogVisible,"onUpdate:modelValue":k},{default:o(()=>[l(d,{onClick:s[0]||(s[0]=C=>k(!1))}),l(L,null,{default:o(()=>[l(X,null,{default:o(()=>[s[5]||(s[5]=f("h4",{class:"text-h5 text-center mb-2"}," افزودن استثناء ",-1)),l(Z,{ref_key:"refVForm",ref:u,class:"mt-6","validate-on":"submit lazy",onSubmit:W(x,["prevent"])},{default:o(()=>[l(Y,null,{default:o(()=>[l(M,{cols:"12",md:"6"},{default:o(()=>[l(De,{modelValue:a(r),"onUpdate:modelValue":s[1]||(s[1]=C=>j(r)?r.value=C:null),items:D.users,"item-title":"fullName","item-value":"id",label:"افراد",multiple:"",chips:"",clearable:"",variant:"outlined",rules:["requiredValidator"in g?g.requiredValidator:a(K)]},null,8,["modelValue","items","rules"])]),_:1}),l(M,{cols:"12",md:"6"},{default:o(()=>[l(re,{modelValue:a(i),"onUpdate:modelValue":s[2]||(s[2]=C=>j(i)?i.value=C:null),items:D.meals,"item-title":"name","item-value":"id",label:"وعده",variant:"outlined",clearable:"",rules:["requiredValidator"in g?g.requiredValidator:a(K)]},null,8,["modelValue","items","rules"])]),_:1}),l(M,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[l(R,{type:"submit",disabled:D.loading,loading:D.loading},{default:o(()=>[...s[3]||(s[3]=[E(" ذخیره ",-1)])]),_:1},8,["disabled","loading"]),l(R,{color:"secondary",variant:"tonal",onClick:b},{default:o(()=>[...s[4]||(s[4]=[E(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},$e={style:{"block-size":"100%"}},Ne={__name:"Exceptions",emits:["back"],setup(D,{emit:_}){const $=_,V=p("root");function r(){V.value!=="root"?V.value="root":$("back")}const i=T({hasError:!1,errorMessage:"",isExceptionCreateDialogVisible:!1}),u=T({fetchingsExceptions:!1,createException:!1,changeStatus:!1});function x(t){i.hasError=!0,i.errorMessage=t}const b=p([]),k=p([]),g=p([]),s=p([]),d=p(null),{theme:C}=fe();function F(t){d.value=t.api,d.value.setGridOption("loading",!0)}const G=p([{headerName:"نام",field:"fullName"},{headerName:"کد پرسنلی",field:"userName"},{headerName:"وعده",field:"mealName"},{headerName:"وضعیت",field:"status",cellRenderer:"Active",cellStyle:{display:"flex","align-items":"center"},filterParams:{valueFormatter:t=>t.value===1?"فعال":"غیرفعال"}},{headerName:"عملیات",field:"actions",cellRendererSelector:t=>({component:"Actions",params:{onStatusClick:e=>{s.value=[e],O()}}})}]),q=de(()=>{var t;return(t=b.value)==null?void 0:t.map(e=>({id:e.id,fullName:e.user.fullName,userName:e.user.username,mealName:e.meal.name,status:e.status,actions:{status:!0}}))});async function y(){var t,e,c;u.fetchingsExceptions=!0,(t=d.value)==null||t.setGridOption("loading",!0);try{const m=await S("/food/exception",{method:"GET"});b.value=((e=m==null?void 0:m.data)==null?void 0:e.mealReservationExceptions)||[]}catch(m){console.error("Error fetching exceptions:",m),i.hasError=!0,i.errorMessage=m.message||"خطا در دریافت پیمانکاران"}finally{u.fetchingsExceptions=!1,(c=d.value)==null||c.setGridOption("loading",!1)}}y();async function v(t){u.createException=!0;try{await S("/food/exception",{method:"POST",body:{meal_id:t.selectedMeal,users:t.selectedPersonnels},onResponseError({response:e}){var c,m;if(i.hasError=!0,(c=e._data)!=null&&c.errors){const n=Object.values(e._data.errors).flat().join(" | ");i.errorMessage=n}else i.errorMessage=((m=e._data)==null?void 0:m.message)||"خطا در ایجاد استثناء"}}),i.isExceptionCreateDialogVisible=!1}catch(e){console.error(e)}finally{u.createException=!1,y()}}async function O(){const t=s.value[0].data.id;u.changeStatus=!0;try{await S(`/food/exception/status/${t}`,{method:"POST",onResponseError({response:c}){u.changeStatus=!1,i.hasError=!0,i.errorMessage=c._data.message||"خطا در تغییر وضعیت"}});const e=b.value.findIndex(c=>c.id===t);e!==-1&&(b.value[e].status=b.value[e].status===1?0:1)}catch(e){console.error(e)}}async function B(){var t;try{const{data:e,error:c}=await ke(_e("/base/user"));if(c.value)throw x("خطا در دریافت کاربران"),c.value;(t=e.value)!=null&&t.data&&(k.value=e.value.data.map(m=>({...m,fullName:`${m.first_name} ${m.last_name} - ${m.personnel_code}`})))}catch(e){console.error("Unexpected error fetching users:",e),x("خطای غیرمنتظره در دریافت کاربران")}}async function P(){u.fetchingMeals=!0;try{const t=await S("/food/meal",{method:"GET"});g.value=(t==null?void 0:t.data.meals)||[]}catch(t){console.error("Error fetching meals:",t),x(t.message||"خطا در دریافت وعده‌ها")}finally{u.fetchingMeals=!1}}return ae(async()=>{await Promise.all([P(),B()])}),(t,e)=>{const c=le("AgGridVue");return h(),A(pe,{class:"app-layout"},{default:o(()=>[l(oe,{modelValue:a(i).hasError,"onUpdate:modelValue":e[0]||(e[0]=m=>a(i).hasError=m),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:o(()=>[E(w(a(i).errorMessage),1)]),_:1},8,["modelValue"]),f("div",null,[l(R,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:r},{default:o(()=>[E(w(a(V)==="root"?"گزارش":"صفحه قبل"),1)]),_:1})]),f("section",$e,[l(c,{style:{"block-size":"100%","inline-size":"100%"},"column-defs":a(G),"row-data":a(q),"enable-rtl":"","row-numbers":"",pagination:"",theme:a(C),onGridReady:F},null,8,["column-defs","row-data","theme"])]),a(i).isExceptionCreateDialogVisible?(h(),A(Me,{key:0,"is-dialog-visible":a(i).isExceptionCreateDialogVisible,"onUpdate:isDialogVisible":e[1]||(e[1]=m=>a(i).isExceptionCreateDialogVisible=m),loading:a(u).createException,meals:a(g),users:a(k),onSubmit:v},null,8,["is-dialog-visible","loading","meals","users"])):I("",!0),l(me,null,{default:o(()=>[l(ce,{app:"",icon:"tabler-plus",size:"x-large",onClick:e[2]||(e[2]=m=>a(i).isExceptionCreateDialogVisible=!0)})]),_:1})]),_:1})}}},Se=ue(Ne,[["__scopeId","data-v-920192a0"]]),Ge={__name:"ReportGetDialog",props:{isDialogVisible:{type:Boolean,required:!0},loading:{type:Boolean,required:!0},meals:{type:Array,required:!0}},emits:["submit","update:isDialogVisible"],setup(D,{emit:_}){const $=D,V=_,r=T({hasError:!1,errorMessage:""}),i=p([]),u=p(null),x=p();function b(){var s;if(!Array.isArray(i.value)||!i.value[0]||!i.value[1]){r.hasError=!0,r.errorMessage="تاریخ باید به صورت بازه‌ای باشد";return}(s=x.value)==null||s.validate().then(({valid:d})=>{d&&V("submit",{date:i.value,meal:u.value})})}function k(){V("update:isDialogVisible",!1)}function g(s){V("update:isDialogVisible",s)}return(s,d)=>{const C=ie,F=le("PersianDatetimePicker");return h(),A(ee,{width:s.$vuetify.display.smAndDown?"auto":900,"model-value":$.isDialogVisible,"onUpdate:modelValue":g},{default:o(()=>[l(C,{onClick:d[0]||(d[0]=G=>g(!1))}),l(L,null,{default:o(()=>[l(X,null,{default:o(()=>[d[5]||(d[5]=f("h4",{class:"text-h5 text-center mb-2"}," دریافت گزارش ",-1)),l(Z,{ref_key:"refVForm",ref:x,class:"mt-6","validate-on":"submit lazy",onSubmit:W(b,["prevent"])},{default:o(()=>[l(Y,null,{default:o(()=>[l(M,{cols:"12",md:"6"},{default:o(()=>[l(re,{modelValue:a(u),"onUpdate:modelValue":d[1]||(d[1]=G=>j(u)?u.value=G:null),items:D.meals,"item-title":"name","item-value":"id",label:"وعده",variant:"outlined",clearable:"",rules:["requiredValidator"in s?s.requiredValidator:a(K)],disabled:D.loading},null,8,["modelValue","items","rules","disabled"])]),_:1}),l(M,{cols:"12",md:"6"},{default:o(()=>[l(be,{error:a(r).hasError,"error-messages":a(r).errorMessage,disabled:D.loading},{default:o(()=>[l(F,{modelValue:a(i),"onUpdate:modelValue":d[2]||(d[2]=G=>j(i)?i.value=G:null),range:"",format:"jYYYY/jMM/jDD",label:"بازه زمانی"},null,8,["modelValue"])]),_:1},8,["error","error-messages","disabled"])]),_:1}),l(M,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[l(R,{type:"submit",disabled:D.loading,loading:D.loading},{default:o(()=>[...d[3]||(d[3]=[E(" جستجو ",-1)])]),_:1},8,["disabled","loading"]),l(R,{color:"secondary",variant:"tonal",onClick:k},{default:o(()=>[...d[4]||(d[4]=[E(" انصراف ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},Be={style:{"block-size":"100%"}},Ue={__name:"Report",emits:["back"],setup(D,{emit:_}){const $=_,V=p("root");function r(){V.value!=="root"?V.value="root":$("back")}const i=T({hasError:!1,errorMessage:"",isReportGetDialogVisible:!1}),u=T({fetchingReports:!1,fetchingMeals:!1});function x(y){i.hasError=!0,i.errorMessage=y}const b=p([]),k=p([]),g=p(null),{theme:s}=fe();function d(y){g.value=y.api,g.value.setGridOption("loading",!1)}const C=p([{headerName:"نام",field:"fullName"},{headerName:"کد پرسنلی",field:"userName"},{headerName:"وعده",field:"mealName"},{headerName:"تاریخ",field:"date"}]),F=de(()=>{var y;return(y=b.value)==null?void 0:y.map(v=>({id:v.id,fullName:v.user.fullName,userName:v.user.username,mealName:v.meal.name,date:v.date}))});async function G(y){u.fetchingReports=!0;try{const v=await S("/food/report",{params:{"date[]":y.date,meal_id:y.meal},method:"GET"});b.value=(v==null?void 0:v.data.reports)||[]}catch(v){console.error("Error fetching reports:",v),x(v.message||"خطا در دریافت گزارش")}finally{u.fetchingReports=!1}}async function q(){u.fetchingMeals=!0;try{const y=await S("/food/meal",{method:"GET"});k.value=(y==null?void 0:y.data.meals)||[]}catch(y){console.error("Error fetching meals:",y),x(y.message||"خطا در دریافت وعده‌ها")}finally{u.fetchingMeals=!1}}return ae(async()=>{await Promise.all([q()])}),(y,v)=>{const O=le("AgGridVue");return h(),A(pe,{class:"app-layout"},{default:o(()=>[l(oe,{modelValue:a(i).hasError,"onUpdate:modelValue":v[0]||(v[0]=B=>a(i).hasError=B),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:o(()=>[E(w(a(i).errorMessage),1)]),_:1},8,["modelValue"]),f("div",null,[l(R,{variant:"text","prepend-icon":"tabler-arrow-right",class:"mb-4",onClick:r},{default:o(()=>[E(w(a(V)==="root"?"گزارش":"صفحه قبل"),1)]),_:1})]),f("section",Be,[l(O,{style:{"block-size":"100%","inline-size":"100%"},"column-defs":a(C),"row-data":a(F),"enable-rtl":"","row-numbers":"",pagination:"",theme:a(s),onGridReady:d},null,8,["column-defs","row-data","theme"])]),a(i).isReportGetDialogVisible?(h(),A(Ge,{key:0,"is-dialog-visible":a(i).isReportGetDialogVisible,"onUpdate:isDialogVisible":v[1]||(v[1]=B=>a(i).isReportGetDialogVisible=B),loading:a(u).fetchingReports,meals:a(k),onSubmit:G},null,8,["is-dialog-visible","loading","meals"])):I("",!0),l(me,null,{default:o(()=>[l(ce,{app:"",icon:"tabler-search",size:"x-large",onClick:v[2]||(v[2]=B=>a(i).isReportGetDialogVisible=!0)})]),_:1})]),_:1})}}},Ae=ue(Ue,[["__scopeId","data-v-575c9edf"]]),Fe={key:0},Pe={class:"font-weight-medium"},Dl={__name:"report",setup(D){const _=p("root"),$=[{key:"eligibilityRules",label:"محدودیت‌های زمانی",icon:"tabler-clock-hour-4"},{key:"exceptions",label:"استثنائات",icon:"tabler-user-check"},{key:"report",label:"گزارش",icon:"tabler-report-analytics"}],V={eligibilityRules:Re,exceptions:Se,report:Ae};function r(){_.value="root"}function i(u){_.value=u}return(u,x)=>(h(),z(Q,null,[a(_)==="root"?(h(),z("div",Fe,[l(Y,{class:"ma-0 pa-0"},{default:o(()=>[(h(),z(Q,null,ne($,b=>l(M,{key:b.key,cols:"6",sm:"4",md:"3",class:"text-center"},{default:o(()=>[l(L,{class:"pa-4 d-flex flex-column align-center justify-center",variant:"outlined",rounded:"xl",onClick:k=>i(b.key)},{default:o(()=>[l(ve,{variant:"tonal",color:"primary",size:"56",class:"mb-2"},{default:o(()=>[l(te,{icon:b.icon,size:"32"},null,8,["icon"])]),_:2},1024),f("span",Pe,w(b.label),1)]),_:2},1032,["onClick"])]),_:2},1024)),64))]),_:1})])):I("",!0),a(_)!=="root"?(h(),A(ye(V[a(_)]),{key:1,onBack:r},null,32)):I("",!0)],64))}};export{Dl as default};
