import{r as de}from"./validators-Di2wQwF6.js";import{an as he,a2 as Se,aw as Pe,Y as F,r as f,a3 as Ie,bu as ke,G as Ce,w as q,br as Te,a7 as Re,aV as Fe,b as t,q as ee,bd as te,a5 as Ae,a4 as $e,F as E,J as ce,as as Me,c2 as Ue,c3 as De,bL as fe,bM as Ee,c as Y,o as _,f as D,l as be,m as s,bN as Ne,h as oe,e as o,z as ze,bO as me,bP as ve,x as qe,i as He,j as Oe,bq as Ge,ax as Le,d as U,t as v,v as g,b8 as H,c4 as Qe,be as je,ah as Je,$ as Ye}from"./index-BcoJe8_c.js";import{u as Ke,V as ne}from"./form-LAA_Z-rN.js";import{a as We}from"./VTextField-BNd61hx4.js";import{f as Xe,m as Ze,V as Be}from"./VField-DYjztgJx.js";import{V as pe,m as et}from"./VInput-BPhHrDFL.js";import{f as tt}from"./VOverlay-DCpUCbXU.js";import{I as at}from"./VImg-RhIF6G-j.js";import{_ as lt}from"./AppTextField-BSkkUbx3.js";import{$ as ot}from"./api-Dk1yLkFf.js";import{u as nt}from"./useApi-BTyKjsj9.js";import{c as rt}from"./createUrl-ChAG0ABk.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ve}from"./VSnackbar-CNwtaAYh.js";import{V as T}from"./VCol-DQOBdKHW.js";import{V as O}from"./VRow-Dd2pGU4u.js";import{V as ut,a as it,b as dt,d as ct}from"./VList-M7iftyF7.js";import{V as ae}from"./VChip-BpYn06jU.js";import{V as ft}from"./VAvatar-DdBQeBf6.js";import{V as le,a as mt,b as vt}from"./VCard-G0i9dx7E.js";import{V as R}from"./VCardText-Bz0aox3h.js";import{a as xe,V as J}from"./VRadioGroup-xFwfHyW2.js";import{V as pt}from"./VDivider-rrdYVWJl.js";import{V as Vt}from"./VForm-DZw-cxLP.js";import"./transition-V3zSD0QU.js";import"./index-9rIf2CJL.js";/* empty css              */import"./createSimpleFunctional-a6Z19KBi.js";import"./VSelectionControl-CQVXKGVw.js";const xt=Se({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...et(),...Ze()},"VTextarea"),bt=he()({name:"VTextarea",directives:{Intersect:at},inheritAttrs:!1,props:xt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,y){let{attrs:w,emit:x,slots:c}=y;const d=Pe(e,"modelValue"),{isFocused:m,focus:P,blur:A}=Ke(e),$=F(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value||"").toString().length),G=F(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function N(n,i){var a,u;!e.autofocus||!n||(u=(a=i[0].target)==null?void 0:a.focus)==null||u.call(a)}const z=f(),p=f(),I=Ie(""),h=f(),L=F(()=>e.persistentPlaceholder||m.value||e.active);function k(){var n;h.value!==document.activeElement&&((n=h.value)==null||n.focus()),m.value||P()}function Q(n){k(),x("click:control",n)}function K(n){x("mousedown:control",n)}function W(n){n.stopPropagation(),k(),te(()=>{d.value="",De(e["onClick:clear"],n)})}function X(n){var a;const i=n.target;if(d.value=i.value,(a=e.modelModifiers)!=null&&a.trim){const u=[i.selectionStart,i.selectionEnd];te(()=>{i.selectionStart=u[0],i.selectionEnd=u[1]})}}const V=f(),C=f(+e.rows),b=F(()=>["plain","underlined"].includes(e.variant));ke(()=>{e.autoGrow||(C.value=+e.rows)});function r(){e.autoGrow&&te(()=>{if(!V.value||!p.value)return;const n=getComputedStyle(V.value),i=getComputedStyle(p.value.$el),a=parseFloat(n.getPropertyValue("--v-field-padding-top"))+parseFloat(n.getPropertyValue("--v-input-padding-top"))+parseFloat(n.getPropertyValue("--v-field-padding-bottom")),u=V.value.scrollHeight,M=parseFloat(n.lineHeight),Z=Math.max(parseFloat(e.rows)*M+a,parseFloat(i.getPropertyValue("--v-input-control-height"))),B=parseFloat(e.maxRows)*M+a||1/0,S=$e(u??0,Z,B);C.value=Math.floor((S-a)/M),I.value=Ae(S)})}Ce(r),q(d,r),q(()=>e.rows,r),q(()=>e.maxRows,r),q(()=>e.density,r);let l;return q(V,n=>{n?(l=new ResizeObserver(r),l.observe(V.value)):l==null||l.disconnect()}),Te(()=>{l==null||l.disconnect()}),Re(()=>{const n=!!(c.counter||e.counter||e.counterValue),i=!!(n||c.details),[a,u]=Fe(w),{modelValue:M,...Z}=pe.filterProps(e),B=Xe(e);return t(pe,ee({ref:z,modelValue:d.value,"onUpdate:modelValue":S=>d.value=S,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":b.value},e.class],style:e.style},a,Z,{centerAffix:C.value===1&&!b.value,focused:m.value}),{...c,default:S=>{let{id:j,isDisabled:re,isDirty:se,isReadonly:ge,isValid:_e}=S;return t(Be,ee({ref:p,style:{"--v-textarea-control-height":I.value},onClick:Q,onMousedown:K,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},B,{id:j.value,active:L.value||se.value,centerAffix:C.value===1&&!b.value,dirty:se.value||e.dirty,disabled:re.value,focused:m.value,error:_e.value===!1}),{...c,default:ye=>{let{props:{class:ue,...ie}}=ye;return t(E,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),ce(t("textarea",ee({ref:h,class:ue,value:d.value,onInput:X,autofocus:e.autofocus,readonly:ge.value,disabled:re.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:k,onBlur:A},ie,u),null),[[Me("intersect"),{handler:N},null,{once:!0}]]),e.autoGrow&&ce(t("textarea",{class:[ue,"v-textarea__sizer"],id:`${ie.id}-sizer`,"onUpdate:modelValue":we=>d.value=we,ref:V,readonly:!0,"aria-hidden":"true"},null),[[Ue,d.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:i?S=>{var j;return t(E,null,[(j=c.details)==null?void 0:j.call(c,S),n&&t(E,null,[t("span",null,null),t(We,{active:e.persistentCounter||m.value,value:$.value,max:G.value,disabled:e.disabled},c.counter)])])}:void 0})}),tt({},z,p,h)}}),gt=Object.assign({name:"AppTextarea",inheritAttrs:!1},{__name:"AppTextarea",setup(e){const y=F(()=>{const c=fe().id,d=Ee();return c?`app-textarea-${c}`:d}),w=F(()=>fe().label);return(x,c)=>(_(),Y("div",{class:qe(["app-textarea flex-grow-1",x.$attrs.class])},[s(w)?(_(),D(ne,{key:0,for:s(y),class:"mb-1 text-body-2",text:s(w)},null,8,["for","text"])):be("",!0),t(bt,me(ve({...x.$attrs,class:null,label:void 0,variant:"outlined",id:s(y)})),Ne({_:2},[oe(x.$slots,(d,m)=>({name:m,fn:o(P=>[ze(x.$slots,m,me(ve(P||{})))])}))]),1040)],2))}}),_t={class:"layout-page-content"},yt={class:"text-wrap mb-2"},wt={class:"text-h6"},ht={__name:"[token]",async setup(e){let y,w;const x=He(),c=Oe(),d="http://172.16.15.70:8000/api",m=f(!1),P=f(""),A=f(!1),$=f(0);let G,N;const z=f([]),p=f("cash"),I=f(""),h=f("taxInvoice"),L=f([]),k=f([]);let Q=null;const K=()=>{$.value=Math.max(0,G.tenderExpiresAt-Math.floor(Date.now()/1e3)),Q=setInterval(()=>{$.value-=1,$.value===0&&c.replace({name:"login-supplier"})},1e3)},W=(r,l)=>{if(l<=1)return"success";const n=r/(l-1),i=Math.round(255*n),a=Math.round(255*(1-n));return`#${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}00`},X=async r=>{if(!(!r.bidPrice&&!r.bidQuantity)){k.value[r.id]=!0;try{await ot(`${d}/tenderDetail/store-supplier-bids`,{method:"POST",body:{id:r.id,bid_price:r.bidPrice,bid_quantity:r.bidQuantity,bid_description:r.bidDescription||"",payment_terms:p.value,payment_terms_description:p.value==="credit"?I.value:"",invoice_type:h.value},onResponseError({response:l}){m.value=!0,P.value=l._data.message||"خطا در ارسال پیشنهاد."}}),L.value[r.id]=!0,A.value=!0}catch(l){console.error(l)}finally{k.value[r.id]=!1}}},{data:V,error:C}=([y,w]=Ge(()=>nt(rt(`${d}/tenderDetail/get-by-token?token=${x.params.token}`))),y=await y,w(),y);C.value&&(m.value=!0,P.value=C.value.message||"خطا در دریافت اطلاعات مناقصه.",setTimeout(()=>{c.replace({name:"login-supplier"})},2e3)),G=V.value.data,N={id:V.value.data.supplier.id,name:V.value.data.supplier.name},z.value=V.value.data.tenderBids||[],K();const b=F(()=>{const r=$.value,l=Math.floor(r/86400),n=Math.floor(r%86400/3600),i=Math.floor(r%3600/60),a=r%60;return{days:l,hours:n.toString().padStart(2,"0"),minutes:i.toString().padStart(2,"0"),seconds:a.toString().padStart(2,"0")}});return Le(()=>{clearInterval(Q)}),(r,l)=>{const n=lt,i=gt;return _(),Y(E,null,[t(Ve,{modelValue:s(m),"onUpdate:modelValue":l[0]||(l[0]=a=>H(m)?m.value=a:null),timeout:2e3,location:"center",variant:"flat",color:"error"},{default:o(()=>[v(g(s(P))+" ، در حال انتقال به پنل تأمین‌کننده ... ",1)]),_:1},8,["modelValue"]),t(Ve,{modelValue:s(A),"onUpdate:modelValue":l[1]||(l[1]=a=>H(A)?A.value=a:null),timeout:2e3,location:"center",variant:"flat",color:"success"},{default:o(()=>l[5]||(l[5]=[v(" ارسال شد ")])),_:1},8,["modelValue"]),U("main",_t,[U("div",null,[t(O,null,{default:o(()=>[t(T,null,{default:o(()=>[U("div",yt,[l[6]||(l[6]=v(" مدیریت محترم شرکت/فروشگاه ")),U("span",wt,g(s(N).name),1)]),l[7]||(l[7]=U("div",{class:"text-wrap text-body-1"}," لیست کالاهای مورد نیاز مجموعه کارخانجات شیشه اردکان به شرح زیر می‌باشد. ",-1)),l[8]||(l[8]=U("div",{class:"text-wrap text-body-1"}," لطفاً قیمت‌های پیشنهادی خود را ارائه دهید. ",-1))]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(ut,{style:{"background-color":"rgb(var(--v-theme-background))"}},{default:o(()=>[t(it,null,{prepend:o(()=>[t(ft,{color:"warning",variant:"tonal",rounded:"",icon:"tabler-stopwatch"})]),default:o(()=>[t(dt,{class:"font-weight-medium"},{default:o(()=>l[9]||(l[9]=[v(" مدت زمان باقی‌مانده تا پایان مناقصه: ")])),_:1}),t(ct,{class:"text-wrap text-body-1"},{default:o(()=>[s(b).days>0?(_(),D(ae,{key:0},{default:o(()=>[v(g(s(b).days)+" روز و "+g(s(b).hours)+" ساعت ",1)]),_:1})):(_(),D(ae,{key:1},{default:o(()=>[v(g(s(b).hours)+":"+g(s(b).minutes)+":"+g(s(b).seconds),1)]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(T,{cols:"12",md:"6",lg:"4"},{default:o(()=>[t(le,null,{default:o(()=>[t(R,{class:"custom-v-card-text"},{default:o(()=>[t(ne,{class:"mb-2"},{default:o(()=>l[10]||(l[10]=[v(" شرایط پرداخت ")])),_:1}),t(xe,{modelValue:s(p),"onUpdate:modelValue":l[2]||(l[2]=a=>H(p)?p.value=a:null),inline:""},{default:o(()=>[t(J,{label:"نقدی",value:"cash"}),t(J,{label:"شرایطی",value:"credit"})]),_:1},8,["modelValue"]),s(p)==="credit"?(_(),D(n,{key:0,modelValue:s(I),"onUpdate:modelValue":l[3]||(l[3]=a=>H(I)?I.value=a:null),type:"text",placeholder:"توضیحات"},null,8,["modelValue"])):be("",!0)]),_:1}),t(pt),t(R,{class:"custom-v-card-text"},{default:o(()=>[t(ne,{class:"mb-2"},{default:o(()=>l[11]||(l[11]=[v(" نوع فاکتور ")])),_:1}),t(xe,{modelValue:s(h),"onUpdate:modelValue":l[4]||(l[4]=a=>H(h)?h.value=a:null),inline:""},{default:o(()=>[t(J,{label:"فاکتور رسمی",value:"taxInvoice"}),t(J,{label:"فاکتور فروشگاهی",value:"commercialInvoice"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(Qe,{group:""},{default:o(()=>[(_(!0),Y(E,null,oe(s(z).filter(a=>!s(L)[a.id]),a=>(_(),D(T,{key:a.id,cols:"12",md:"6",lg:"4"},{default:o(()=>[t(le,null,{default:o(()=>[t(mt,null,{default:o(()=>[t(vt,{class:"custom-v-card-title"},{default:o(()=>[v(g(a.tenderProduct.product.name+(a.brand?` (${a.brand.name})`:"")),1)]),_:2},1024)]),_:2},1024),t(R,null,{default:o(()=>[v(g(a.tenderProduct.purchaseExpertDescription),1)]),_:2},1024),t(R,null,{default:o(()=>[t(le,{variant:"outlined"},{default:o(()=>[t(R,null,{default:o(()=>l[12]||(l[12]=[v(" قیمت‌های پیشنهادی از سایر تأمین‌کنندگان (ریال): ")])),_:1}),t(R,{class:"d-flex flex-wrap gap-x-4 gap-y-2"},{default:o(()=>[(_(!0),Y(E,null,oe(a.bidOfOtherSuppliers,(u,M)=>(_(),D(ae,{key:u.supplierId,variant:u.supplierId===s(N).id?"flat":"outlined",color:W(M,a.bidOfOtherSuppliers.length)},{default:o(()=>[v(g(u.bidPrice),1)]),_:2},1032,["variant","color"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(R,null,{default:o(()=>[t(Vt,{"validate-on":"submit lazy",onSubmit:je(u=>X(a),["prevent"])},{default:o(()=>[t(O,null,{default:o(()=>[t(T,{cols:"12"},{default:o(()=>[t(n,{modelValue:a.bidPrice,"onUpdate:modelValue":u=>a.bidPrice=u,label:"قیمت",type:"number","prepend-inner-icon":"tabler-coin",suffix:"ریال",rules:["requiredValidator"in r?r.requiredValidator:s(de)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),t(T,{cols:"12"},{default:o(()=>[t(n,{modelValue:a.bidQuantity,"onUpdate:modelValue":u=>a.bidQuantity=u,label:"تعداد",type:"number","prepend-inner-icon":"tabler-scale",suffix:a.tenderProduct.product.counting_unit.UntName,placeholder:`مقدار مورد نیاز: ${a.tenderProduct.quantityRequired}`,rules:["requiredValidator"in r?r.requiredValidator:s(de)]},null,8,["modelValue","onUpdate:modelValue","suffix","placeholder","rules"])]),_:2},1024),t(T,{cols:"12"},{default:o(()=>[t(i,{modelValue:a.bidDescription,"onUpdate:modelValue":u=>a.bidDescription=u,label:"توضیحات",rows:"3"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(T,{cols:"12"},{default:o(()=>[t(Je,{type:"submit",loading:s(k)[a.id]},{default:o(()=>[t(Ye,{icon:"tabler-send"}),l[13]||(l[13]=v(" ارسال "))]),_:2},1032,["loading"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])],64)}}},Bt=st(ht,[["__scopeId","data-v-97f45d40"]]);export{Bt as default};
